[0m18:28:35.684382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd83e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1180b5970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1180b54c0>]}


============================== 18:28:35.687683 | c8100504-8b4a-48e9-8753-cc5c1dc3d508 ==============================
[0m18:28:35.687683 [info ] [MainThread]: Running with dbt=1.11.4
[0m18:28:35.688005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'partial_parse': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'empty': 'None', 'profiles_dir': '/Users/hazeldonaldson/.dbt', 'no_print': 'None', 'invocation_command': 'dbt deps', 'version_check': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/logs', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'introspect': 'True', 'write_json': 'True', 'warn_error': 'None', 'debug': 'False', 'quiet': 'False'}
[0m18:28:35.749317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8100504-8b4a-48e9-8753-cc5c1dc3d508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118259220>]}
[0m18:28:35.759881 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:28:35.760340 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:28:35.766495 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.12895341, "process_in_blocks": "0", "process_kernel_time": 0.14947, "process_mem_max_rss": "109477888", "process_out_blocks": "0", "process_user_time": 0.755405}
[0m18:28:35.766939 [debug] [MainThread]: Command `dbt deps` succeeded at 18:28:35.766833 after 0.13 seconds
[0m18:28:35.767164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1180b5820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118390f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118258680>]}
[0m18:28:35.767359 [debug] [MainThread]: Flushing usage events
[0m18:28:35.883623 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:30:59.082971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ab7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053b9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053b9820>]}


============================== 18:30:59.086748 | b3a434f1-3a87-47e4-8502-a982a151edd8 ==============================
[0m18:30:59.086748 [info ] [MainThread]: Running with dbt=1.11.4
[0m18:30:59.087075 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'invocation_command': 'dbt run --select staging', 'target_path': 'None', 'partial_parse': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'empty': 'False', 'introspect': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/Users/hazeldonaldson/.dbt', 'no_print': 'None', 'debug': 'False', 'printer_width': '80', 'static_parser': 'True'}
[0m18:30:59.277048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3a434f1-3a87-47e4-8502-a982a151edd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10534e330>]}
[0m18:30:59.305689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3a434f1-3a87-47e4-8502-a982a151edd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ef3e60>]}
[0m18:30:59.307051 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:30:59.360512 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m18:30:59.361007 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:30:59.361216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b3a434f1-3a87-47e4-8502-a982a151edd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054bfa10>]}
[0m18:30:59.897603 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/staging/staging.yml:
  	test definition dictionary must have exactly one key, got [('accepted_values', None), ('arguments', {'values': ['whale', 'dolphin', 'minnow', 'non_payer']})] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m18:30:59.900070 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.85475343, "process_in_blocks": "0", "process_kernel_time": 0.183367, "process_mem_max_rss": "134529024", "process_out_blocks": "0", "process_user_time": 1.355789}
[0m18:30:59.900340 [debug] [MainThread]: Command `dbt run` failed at 18:30:59.900291 after 0.86 seconds
[0m18:30:59.900543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053b9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058c9ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105970830>]}
[0m18:30:59.900718 [debug] [MainThread]: Flushing usage events
[0m18:31:00.022384 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:32:38.290933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103188bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106911c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106911730>]}


============================== 18:32:38.294289 | d6264e41-957f-4a26-a5ef-42d6cb76b833 ==============================
[0m18:32:38.294289 [info ] [MainThread]: Running with dbt=1.11.4
[0m18:32:38.294625 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'version_check': 'True', 'warn_error': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'invocation_command': 'dbt run --select staging', 'log_path': '/Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/logs', 'profiles_dir': '/Users/hazeldonaldson/.dbt', 'static_parser': 'True', 'debug': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'partial_parse': 'True', 'write_json': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'log_format': 'default', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'printer_width': '80'}
[0m18:32:38.461226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6264e41-957f-4a26-a5ef-42d6cb76b833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a3ddf0>]}
[0m18:32:38.489796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6264e41-957f-4a26-a5ef-42d6cb76b833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10609d8e0>]}
[0m18:32:38.491065 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:32:38.542440 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m18:32:38.542951 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:32:38.543149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd6264e41-957f-4a26-a5ef-42d6cb76b833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aaf560>]}
[0m18:32:39.206815 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.marts
- models.question_kingdom
- models.product
- models.retention
- models.monetization
- models.core
- models.staging
[0m18:32:39.211624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6264e41-957f-4a26-a5ef-42d6cb76b833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ded6d0>]}
[0m18:32:39.256929 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/manifest.json
[0m18:32:39.258163 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/semantic_manifest.json
[0m18:32:39.271573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6264e41-957f-4a26-a5ef-42d6cb76b833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071ad220>]}
[0m18:32:39.271849 [info ] [MainThread]: Found 7 models, 34 data tests, 5 sources, 472 macros
[0m18:32:39.272025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6264e41-957f-4a26-a5ef-42d6cb76b833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e47170>]}
[0m18:32:39.273058 [info ] [MainThread]: 
[0m18:32:39.273236 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:32:39.273373 [info ] [MainThread]: 
[0m18:32:39.273601 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:32:39.275830 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_quest_kingdom'
[0m18:32:39.308933 [debug] [ThreadPool]: Using duckdb connection "list_quest_kingdom"
[0m18:32:39.309188 [debug] [ThreadPool]: On list_quest_kingdom: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "list_quest_kingdom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"quest_kingdom"'
    
  
  
[0m18:32:39.309344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:39.317294 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "list_quest_kingdom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"quest_kingdom"'
    
  
  
[0m18:32:39.317560 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m18:32:39.317961 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:32:39.318107 [debug] [MainThread]: Connection 'list_quest_kingdom' was properly closed.
[0m18:32:39.318247 [info ] [MainThread]: 
[0m18:32:39.318402 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m18:32:39.318636 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "/Users/hazeldonaldson/Documents/quest_kingdom_analytics/quest_kingdom_dbt/quest_kingdom.db": No such file or directory
[0m18:32:39.320421 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0681653, "process_in_blocks": "0", "process_kernel_time": 0.181784, "process_mem_max_rss": "145571840", "process_out_blocks": "0", "process_user_time": 1.537193}
[0m18:32:39.320727 [debug] [MainThread]: Command `dbt run` failed at 18:32:39.320675 after 1.07 seconds
[0m18:32:39.320928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d29c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072af800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072afc50>]}
[0m18:32:39.321108 [debug] [MainThread]: Flushing usage events
[0m18:32:39.441644 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:34:32.038873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105408f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db5850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db5610>]}


============================== 18:34:32.042386 | b0e98b7d-5763-466c-9910-91dd1ac79f8e ==============================
[0m18:34:32.042386 [info ] [MainThread]: Running with dbt=1.11.4
[0m18:34:32.042719 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'cache_selected_only': 'False', 'log_path': '/Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'version_check': 'True', 'invocation_command': 'dbt deps', 'use_colors': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'printer_width': '80', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'static_parser': 'True', 'profiles_dir': '/Users/hazeldonaldson/.dbt', 'indirect_selection': 'eager', 'target_path': 'None'}
[0m18:34:32.105292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0e98b7d-5763-466c-9910-91dd1ac79f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10231c0b0>]}
[0m18:34:32.115765 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:34:32.116395 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:34:32.117804 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.1183935, "process_in_blocks": "0", "process_kernel_time": 0.13083, "process_mem_max_rss": "109641728", "process_out_blocks": "0", "process_user_time": 0.731216}
[0m18:34:32.118080 [debug] [MainThread]: Command `dbt deps` succeeded at 18:34:32.118028 after 0.12 seconds
[0m18:34:32.118262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e58680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070174d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db5490>]}
[0m18:34:32.118432 [debug] [MainThread]: Flushing usage events
[0m18:34:32.246360 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:34:46.987601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101e96660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048d9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048d9880>]}


============================== 18:34:46.991301 | 7e31efe4-6f66-4fd2-88c5-5115eace90f2 ==============================
[0m18:34:46.991301 [info ] [MainThread]: Running with dbt=1.11.4
[0m18:34:46.991659 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select models/staging', 'printer_width': '80', 'log_path': '/Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/Users/hazeldonaldson/.dbt', 'empty': 'False', 'fail_fast': 'False', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'version_check': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'use_colors': 'True'}
[0m18:34:47.162521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e31efe4-6f66-4fd2-88c5-5115eace90f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ac20c0>]}
[0m18:34:47.191053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e31efe4-6f66-4fd2-88c5-5115eace90f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b2da30>]}
[0m18:34:47.193178 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:34:47.245857 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m18:34:47.314566 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:34:47.314832 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:34:47.314974 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:34:47.318366 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.core
- models.product
- models.monetization
- models.staging
- models.question_kingdom
- models.marts
- models.retention
[0m18:34:47.339621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e31efe4-6f66-4fd2-88c5-5115eace90f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b9aae0>]}
[0m18:34:47.389000 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/manifest.json
[0m18:34:47.390580 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/semantic_manifest.json
[0m18:34:47.408196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e31efe4-6f66-4fd2-88c5-5115eace90f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b9a300>]}
[0m18:34:47.408521 [info ] [MainThread]: Found 7 models, 34 data tests, 5 sources, 472 macros
[0m18:34:47.408700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e31efe4-6f66-4fd2-88c5-5115eace90f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a76f30>]}
[0m18:34:47.410350 [info ] [MainThread]: 
[0m18:34:47.410535 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:34:47.410672 [info ] [MainThread]: 
[0m18:34:47.410913 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:34:47.413179 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_quest_kingdom'
[0m18:34:47.443720 [debug] [ThreadPool]: Using duckdb connection "list_quest_kingdom"
[0m18:34:47.443969 [debug] [ThreadPool]: On list_quest_kingdom: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "list_quest_kingdom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"quest_kingdom"'
    
  
  
[0m18:34:47.444123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:47.451850 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "list_quest_kingdom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"quest_kingdom"'
    
  
  
[0m18:34:47.452095 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m18:34:47.452480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:47.452622 [debug] [MainThread]: Connection 'list_quest_kingdom' was properly closed.
[0m18:34:47.452760 [info ] [MainThread]: 
[0m18:34:47.452913 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m18:34:47.453140 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "/Users/hazeldonaldson/Documents/quest_kingdom_analytics/quest_kingdom_dbt/quest_kingdom.db": No such file or directory
[0m18:34:47.454500 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5066398, "process_in_blocks": "0", "process_kernel_time": 0.176442, "process_mem_max_rss": "139395072", "process_out_blocks": "0", "process_user_time": 0.980933}
[0m18:34:47.454737 [debug] [MainThread]: Command `dbt run` failed at 18:34:47.454693 after 0.51 seconds
[0m18:34:47.454913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048d98e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f47fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d37a0>]}
[0m18:34:47.455079 [debug] [MainThread]: Flushing usage events
[0m18:34:47.556424 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:38:38.035306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091dea80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10921dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098957c0>]}


============================== 18:38:38.039824 | b6567743-1d94-4242-bdfe-45e4e4cb55b6 ==============================
[0m18:38:38.039824 [info ] [MainThread]: Running with dbt=1.11.4
[0m18:38:38.040207 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'write_json': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'partial_parse': 'True', 'debug': 'False', 'profiles_dir': '/Users/hazeldonaldson/.dbt', 'printer_width': '80', 'version_check': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select models/staging', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_path': '/Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/logs', 'empty': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_experimental_parser': 'False'}
[0m18:38:38.221355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6567743-1d94-4242-bdfe-45e4e4cb55b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10999a570>]}
[0m18:38:38.251827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6567743-1d94-4242-bdfe-45e4e4cb55b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10969f860>]}
[0m18:38:38.253200 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:38:38.310037 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m18:38:38.381129 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:38:38.381439 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:38:38.381593 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:38:38.385058 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.core
- models.retention
- models.question_kingdom
- models.monetization
- models.marts
- models.staging
- models.product
[0m18:38:38.408162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6567743-1d94-4242-bdfe-45e4e4cb55b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f43d70>]}
[0m18:38:38.453744 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/manifest.json
[0m18:38:38.455559 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/semantic_manifest.json
[0m18:38:38.472534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6567743-1d94-4242-bdfe-45e4e4cb55b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d5f050>]}
[0m18:38:38.472904 [info ] [MainThread]: Found 7 models, 34 data tests, 5 sources, 472 macros
[0m18:38:38.473095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6567743-1d94-4242-bdfe-45e4e4cb55b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d0e2d0>]}
[0m18:38:38.474768 [info ] [MainThread]: 
[0m18:38:38.474952 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:38:38.475096 [info ] [MainThread]: 
[0m18:38:38.475347 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:38:38.477551 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_quest_kingdom'
[0m18:38:38.507566 [debug] [ThreadPool]: Using duckdb connection "list_quest_kingdom"
[0m18:38:38.507849 [debug] [ThreadPool]: On list_quest_kingdom: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "list_quest_kingdom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"quest_kingdom"'
    
  
  
[0m18:38:38.508018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:38.517125 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "list_quest_kingdom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"quest_kingdom"'
    
  
  
[0m18:38:38.517416 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m18:38:38.517822 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:38:38.517962 [debug] [MainThread]: Connection 'list_quest_kingdom' was properly closed.
[0m18:38:38.518100 [info ] [MainThread]: 
[0m18:38:38.518267 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m18:38:38.518499 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "/Users/hazeldonaldson/Documents/quest_kingdom_analytics/quest_kingdom_dbt/quest_kingdom.db": No such file or directory
[0m18:38:38.520011 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5273802, "process_in_blocks": "0", "process_kernel_time": 0.211895, "process_mem_max_rss": "136462336", "process_out_blocks": "0", "process_user_time": 1.026423}
[0m18:38:38.520278 [debug] [MainThread]: Command `dbt run` failed at 18:38:38.520229 after 0.53 seconds
[0m18:38:38.520473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10982dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ed8cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ed9f70>]}
[0m18:38:38.520656 [debug] [MainThread]: Flushing usage events
[0m18:38:38.650745 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:40:32.411194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bb92e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108655310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093dd760>]}


============================== 18:40:32.414894 | ee53585e-eafe-4f6f-83ec-8d93e70f09fa ==============================
[0m18:40:32.414894 [info ] [MainThread]: Running with dbt=1.11.4
[0m18:40:32.415221 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/logs', 'printer_width': '80', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'quiet': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run --select models/staging', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'version_check': 'True', 'log_format': 'default', 'warn_error': 'None', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/hazeldonaldson/.dbt'}
[0m18:40:32.586126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee53585e-eafe-4f6f-83ec-8d93e70f09fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10957a7b0>]}
[0m18:40:32.614626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee53585e-eafe-4f6f-83ec-8d93e70f09fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a1cc20>]}
[0m18:40:32.615910 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:40:32.666927 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m18:40:32.716078 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:40:32.716378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ee53585e-eafe-4f6f-83ec-8d93e70f09fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109919a00>]}
[0m18:40:33.356445 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.staging
- models.product
- models.monetization
- models.marts
- models.retention
- models.core
- models.question_kingdom
[0m18:40:33.361541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee53585e-eafe-4f6f-83ec-8d93e70f09fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098750a0>]}
[0m18:40:33.405368 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/manifest.json
[0m18:40:33.406677 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/semantic_manifest.json
[0m18:40:33.420886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee53585e-eafe-4f6f-83ec-8d93e70f09fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d276b0>]}
[0m18:40:33.421196 [info ] [MainThread]: Found 7 models, 34 data tests, 5 sources, 472 macros
[0m18:40:33.421376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee53585e-eafe-4f6f-83ec-8d93e70f09fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ba0c50>]}
[0m18:40:33.422969 [info ] [MainThread]: 
[0m18:40:33.423161 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:40:33.423303 [info ] [MainThread]: 
[0m18:40:33.423530 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:40:33.425937 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_quest_kingdom'
[0m18:40:33.455280 [debug] [ThreadPool]: Using duckdb connection "list_quest_kingdom"
[0m18:40:33.455526 [debug] [ThreadPool]: On list_quest_kingdom: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "list_quest_kingdom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"quest_kingdom"'
    
  
  
[0m18:40:33.455680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:40:33.478279 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m18:40:33.479516 [debug] [ThreadPool]: On list_quest_kingdom: Close
[0m18:40:33.479907 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_quest_kingdom, now create_quest_kingdom_main)
[0m18:40:33.480138 [debug] [ThreadPool]: Creating schema "database: "quest_kingdom"
schema: "main"
"
[0m18:40:33.483521 [debug] [ThreadPool]: Using duckdb connection "create_quest_kingdom_main"
[0m18:40:33.483705 [debug] [ThreadPool]: On create_quest_kingdom_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "create_quest_kingdom_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='quest_kingdom'
        and type='sqlite'
    
  
[0m18:40:33.483842 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:40:33.484642 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:40:33.485466 [debug] [ThreadPool]: Using duckdb connection "create_quest_kingdom_main"
[0m18:40:33.485614 [debug] [ThreadPool]: On create_quest_kingdom_main: BEGIN
[0m18:40:33.485843 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:40:33.485970 [debug] [ThreadPool]: Using duckdb connection "create_quest_kingdom_main"
[0m18:40:33.486093 [debug] [ThreadPool]: On create_quest_kingdom_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "create_quest_kingdom_main"} */

    
    
        create schema if not exists "quest_kingdom"."main"
    
[0m18:40:33.486340 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:40:33.487326 [debug] [ThreadPool]: On create_quest_kingdom_main: COMMIT
[0m18:40:33.488050 [debug] [ThreadPool]: Using duckdb connection "create_quest_kingdom_main"
[0m18:40:33.488262 [debug] [ThreadPool]: On create_quest_kingdom_main: COMMIT
[0m18:40:33.488562 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:40:33.488708 [debug] [ThreadPool]: On create_quest_kingdom_main: Close
[0m18:40:33.489397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_quest_kingdom_main, now list_quest_kingdom_main)
[0m18:40:33.492265 [debug] [ThreadPool]: Using duckdb connection "list_quest_kingdom_main"
[0m18:40:33.492492 [debug] [ThreadPool]: On list_quest_kingdom_main: BEGIN
[0m18:40:33.492632 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:40:33.492908 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:40:33.493037 [debug] [ThreadPool]: Using duckdb connection "list_quest_kingdom_main"
[0m18:40:33.493171 [debug] [ThreadPool]: On list_quest_kingdom_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "list_quest_kingdom_main"} */
select
      'quest_kingdom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'quest_kingdom'
  
[0m18:40:33.503241 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:40:33.503991 [debug] [ThreadPool]: On list_quest_kingdom_main: ROLLBACK
[0m18:40:33.504947 [debug] [ThreadPool]: Failed to rollback 'list_quest_kingdom_main'
[0m18:40:33.505101 [debug] [ThreadPool]: On list_quest_kingdom_main: Close
[0m18:40:33.505905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee53585e-eafe-4f6f-83ec-8d93e70f09fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ce2c00>]}
[0m18:40:33.506124 [debug] [MainThread]: Using duckdb connection "master"
[0m18:40:33.506255 [debug] [MainThread]: On master: BEGIN
[0m18:40:33.506372 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:40:33.506621 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:40:33.506750 [debug] [MainThread]: On master: COMMIT
[0m18:40:33.506872 [debug] [MainThread]: Using duckdb connection "master"
[0m18:40:33.506991 [debug] [MainThread]: On master: COMMIT
[0m18:40:33.507196 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:40:33.507324 [debug] [MainThread]: On master: Close
[0m18:40:33.509651 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_ad_impressions
[0m18:40:33.509899 [info ] [Thread-1 (]: 1 of 5 START sql view model main.stg_ad_impressions ............................ [RUN]
[0m18:40:33.510101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_quest_kingdom_main, now model.quest_kingdom.stg_ad_impressions)
[0m18:40:33.510261 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_ad_impressions
[0m18:40:33.513711 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_ad_impressions"
[0m18:40:33.514290 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_ad_impressions
[0m18:40:33.528838 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.stg_ad_impressions"
[0m18:40:33.529539 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_ad_impressions"
[0m18:40:33.529712 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: BEGIN
[0m18:40:33.529860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:40:33.530214 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:40:33.530365 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_ad_impressions"
[0m18:40:33.530522 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_ad_impressions"} */

  
  create view "quest_kingdom"."main"."stg_ad_impressions__dbt_tmp" as (
    with source (
    select * from "quest_kingdom"."main"."ad_impressions"
),

renamed as (
    select 
        ad_id,
        player_id,
        session_id,

        --timestamps
        ad_timestamp::timestamp as shown_at,

        --dimensions
        lower(trim(ad_type)) as ad_type,
        lower(trim(ad_network)) as ad_network,

        --booleans
        clicked,
        --metrics
        revenue_usd,
        --derived
        date_trunc('date', ad_timestamp::timestamp) as ad_date
    from source 
)

select * from renamed
  );

[0m18:40:33.533662 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_ad_impressions"} */

  
  create view "quest_kingdom"."main"."stg_ad_impressions__dbt_tmp" as (
    with source (
    select * from "quest_kingdom"."main"."ad_impressions"
),

renamed as (
    select 
        ad_id,
        player_id,
        session_id,

        --timestamps
        ad_timestamp::timestamp as shown_at,

        --dimensions
        lower(trim(ad_type)) as ad_type,
        lower(trim(ad_network)) as ad_network,

        --booleans
        clicked,
        --metrics
        revenue_usd,
        --derived
        date_trunc('date', ad_timestamp::timestamp) as ad_date
    from source 
)

select * from renamed
  );

[0m18:40:33.533875 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:40:33.534093 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: ROLLBACK
[0m18:40:33.538374 [debug] [Thread-1 (]: Failed to rollback 'model.quest_kingdom.stg_ad_impressions'
[0m18:40:33.538553 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: Close
[0m18:40:33.539673 [debug] [Thread-1 (]: Runtime Error in model stg_ad_impressions (models/staging/stg_ad_impressions.sql)
  Parser Error: syntax error at or near "select"
  
  LINE 6:     select * from "quest_kingdom"."main"."ad_impressions"
              ^
[0m18:40:33.540607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee53585e-eafe-4f6f-83ec-8d93e70f09fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a96f90>]}
[0m18:40:33.540930 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model main.stg_ad_impressions ................... [[31mERROR[0m in 0.03s]
[0m18:40:33.541204 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_ad_impressions
[0m18:40:33.541393 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_events
[0m18:40:33.541624 [debug] [Thread-4 (]: Marking all children of 'model.quest_kingdom.stg_ad_impressions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_ad_impressions (models/staging/stg_ad_impressions.sql)
  Parser Error: syntax error at or near "select"
  
  LINE 6:     select * from "quest_kingdom"."main"."ad_impressions"
              ^.
[0m18:40:33.541857 [info ] [Thread-1 (]: 2 of 5 START sql view model main.stg_events .................................... [RUN]
[0m18:40:33.542400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_ad_impressions, now model.quest_kingdom.stg_events)
[0m18:40:33.542600 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_events
[0m18:40:33.544115 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_events"
[0m18:40:33.544494 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_events
[0m18:40:33.545986 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.stg_events"
[0m18:40:33.546297 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_events"
[0m18:40:33.546455 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: BEGIN
[0m18:40:33.546595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:40:33.546930 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:40:33.547081 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_events"
[0m18:40:33.547236 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_events"} */

  
  create view "quest_kingdom"."main"."stg_events__dbt_tmp" as (
    with source (
    select * from "quest_kingdom"."main"."events"
),

renamed as (
    select 
        event_id,
        player_id,
        session_id,
        --timestamps
        event_timestamp::timestamp as event_at,

        --dimensions
        lower(trim(event_name)) as event_name,

        --json properties
        event_properties
    from source 
)

select * from renamed
  );

[0m18:40:33.547558 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_events"} */

  
  create view "quest_kingdom"."main"."stg_events__dbt_tmp" as (
    with source (
    select * from "quest_kingdom"."main"."events"
),

renamed as (
    select 
        event_id,
        player_id,
        session_id,
        --timestamps
        event_timestamp::timestamp as event_at,

        --dimensions
        lower(trim(event_name)) as event_name,

        --json properties
        event_properties
    from source 
)

select * from renamed
  );

[0m18:40:33.547711 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:40:33.547894 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: ROLLBACK
[0m18:40:33.549348 [debug] [Thread-1 (]: Failed to rollback 'model.quest_kingdom.stg_events'
[0m18:40:33.549545 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: Close
[0m18:40:33.550813 [debug] [Thread-1 (]: Runtime Error in model stg_events (models/staging/stg_events.sql)
  Parser Error: syntax error at or near "select"
  
  LINE 6:     select * from "quest_kingdom"."main"."events"
              ^
[0m18:40:33.551086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee53585e-eafe-4f6f-83ec-8d93e70f09fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a247d40>]}
[0m18:40:33.551408 [error] [Thread-1 (]: 2 of 5 ERROR creating sql view model main.stg_events ........................... [[31mERROR[0m in 0.01s]
[0m18:40:33.551762 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_events
[0m18:40:33.552014 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_iap_transactions
[0m18:40:33.552256 [debug] [Thread-4 (]: Marking all children of 'model.quest_kingdom.stg_events' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_events (models/staging/stg_events.sql)
  Parser Error: syntax error at or near "select"
  
  LINE 6:     select * from "quest_kingdom"."main"."events"
              ^.
[0m18:40:33.552493 [info ] [Thread-1 (]: 3 of 5 START sql view model main.stg_iap_transactions .......................... [RUN]
[0m18:40:33.552775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_events, now model.quest_kingdom.stg_iap_transactions)
[0m18:40:33.552942 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_iap_transactions
[0m18:40:33.554377 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_iap_transactions"
[0m18:40:33.554768 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_iap_transactions
[0m18:40:33.556394 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.stg_iap_transactions"
[0m18:40:33.556753 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_iap_transactions"
[0m18:40:33.556919 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: BEGIN
[0m18:40:33.557096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:40:33.557520 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:40:33.557689 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_iap_transactions"
[0m18:40:33.557850 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_iap_transactions"} */

  
  create view "quest_kingdom"."main"."stg_iap_transactions__dbt_tmp" as (
    with source (
    select * from "quest_kingdom"."main"."iap_transactions"
),

renamed as (
    select 
        transaction_id,
        player_id,
        session_id,

        --timestamps
        transaction_timestamp::timestamp as purchased_at,

        --dimension
        lower(trim(sku)) as sku,
        lower(trim(platform)) as platform,

        --metrics
        price_usd,
        gems_purchased,

        --derived
        date_trunc('date', transaction_timestamp::timestamp) as purchase_date
    from source 
)

select * from renamed
  );

[0m18:40:33.558209 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_iap_transactions"} */

  
  create view "quest_kingdom"."main"."stg_iap_transactions__dbt_tmp" as (
    with source (
    select * from "quest_kingdom"."main"."iap_transactions"
),

renamed as (
    select 
        transaction_id,
        player_id,
        session_id,

        --timestamps
        transaction_timestamp::timestamp as purchased_at,

        --dimension
        lower(trim(sku)) as sku,
        lower(trim(platform)) as platform,

        --metrics
        price_usd,
        gems_purchased,

        --derived
        date_trunc('date', transaction_timestamp::timestamp) as purchase_date
    from source 
)

select * from renamed
  );

[0m18:40:33.558403 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:40:33.558611 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: ROLLBACK
[0m18:40:33.560442 [debug] [Thread-1 (]: Failed to rollback 'model.quest_kingdom.stg_iap_transactions'
[0m18:40:33.560687 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: Close
[0m18:40:33.562004 [debug] [Thread-1 (]: Runtime Error in model stg_iap_transactions (models/staging/stg_iap_transactions.sql)
  Parser Error: syntax error at or near "select"
  
  LINE 6:     select * from "quest_kingdom"."main"."iap_transactions"
              ^
[0m18:40:33.562236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee53585e-eafe-4f6f-83ec-8d93e70f09fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a262750>]}
[0m18:40:33.562526 [error] [Thread-1 (]: 3 of 5 ERROR creating sql view model main.stg_iap_transactions ................. [[31mERROR[0m in 0.01s]
[0m18:40:33.562774 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_iap_transactions
[0m18:40:33.562951 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_players
[0m18:40:33.563163 [debug] [Thread-4 (]: Marking all children of 'model.quest_kingdom.stg_iap_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_iap_transactions (models/staging/stg_iap_transactions.sql)
  Parser Error: syntax error at or near "select"
  
  LINE 6:     select * from "quest_kingdom"."main"."iap_transactions"
              ^.
[0m18:40:33.563380 [info ] [Thread-1 (]: 4 of 5 START sql view model main.stg_players ................................... [RUN]
[0m18:40:33.563652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_iap_transactions, now model.quest_kingdom.stg_players)
[0m18:40:33.563817 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_players
[0m18:40:33.565383 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_players"
[0m18:40:33.566298 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_players
[0m18:40:33.567899 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.stg_players"
[0m18:40:33.570066 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:40:33.570244 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: BEGIN
[0m18:40:33.570396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:40:33.570758 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:40:33.570905 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:40:33.571063 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_players"} */

  
  create view "quest_kingdom"."main"."stg_players__dbt_tmp" as (
    with source as (
    select * from "quest_kingdom"."main"."players"
),

renamed as (
    select
        player_id,
        install_date::date as installed_at,
        --dimensions
        lower(trim(attribution_channel)) as attribution_channel,
        lower(trim(country)) as country,
        lower(trim(device_type)) as device_type,
        lower(trim(player_segment)) as player_segment,
        lower(trim(experiment_variant)) as experiment_variant,
        --booleans
        tutorial_completed,
        --metrics
        lifetime_value as lifetime_value_usd
    from source 
)

select * from renamed
  );

[0m18:40:33.571647 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:40:33.575606 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:40:33.575830 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_players"} */
alter view "quest_kingdom"."main"."stg_players__dbt_tmp" rename to "stg_players"
[0m18:40:33.610898 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:33.615656 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: COMMIT
[0m18:40:33.615855 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:40:33.616008 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: COMMIT
[0m18:40:33.617318 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:40:33.619830 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:40:33.620004 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_players"} */

      drop view if exists "quest_kingdom"."main"."stg_players__dbt_backup" cascade
    
[0m18:40:33.620463 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:40:33.621713 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: Close
[0m18:40:33.621987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee53585e-eafe-4f6f-83ec-8d93e70f09fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a289c40>]}
[0m18:40:33.622272 [info ] [Thread-1 (]: 4 of 5 OK created sql view model main.stg_players .............................. [[32mOK[0m in 0.06s]
[0m18:40:33.622606 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_players
[0m18:40:33.622790 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_sessions
[0m18:40:33.623002 [info ] [Thread-1 (]: 5 of 5 START sql view model main.stg_sessions .................................. [RUN]
[0m18:40:33.623191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_players, now model.quest_kingdom.stg_sessions)
[0m18:40:33.623349 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_sessions
[0m18:40:33.624584 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_sessions"
[0m18:40:33.624947 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_sessions
[0m18:40:33.626537 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.stg_sessions"
[0m18:40:33.626861 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_sessions"
[0m18:40:33.627023 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: BEGIN
[0m18:40:33.627168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:40:33.627521 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:40:33.627724 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_sessions"
[0m18:40:33.627944 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_sessions"} */

  
  create view "quest_kingdom"."main"."stg_sessions__dbt_tmp" as (
    with source as (
    select * from "quest_kingdom"."main"."sessions"
),

renamed as (
    select 
        session_id,
        player_id,
        --timestamps
        session_start::timestamp as session_started_at,
        session_end::timestamp as session_ended_at,

        --metrics
        session_duration_minutes,
        starting_level,
        ending_level,
        levels_gained,

        --derived metrics
        extract(hour from session_start::timestamp) as session_hour,
        extract(dow from session_start::timestamp) as session_day_of_week,
        date_trunc('date', session_start::timestamp) as session_date 
    from source
)

select * renamed
  );

[0m18:40:33.630216 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_sessions"} */

  
  create view "quest_kingdom"."main"."stg_sessions__dbt_tmp" as (
    with source as (
    select * from "quest_kingdom"."main"."sessions"
),

renamed as (
    select 
        session_id,
        player_id,
        --timestamps
        session_start::timestamp as session_started_at,
        session_end::timestamp as session_ended_at,

        --metrics
        session_duration_minutes,
        starting_level,
        ending_level,
        levels_gained,

        --derived metrics
        extract(hour from session_start::timestamp) as session_hour,
        extract(dow from session_start::timestamp) as session_day_of_week,
        date_trunc('date', session_start::timestamp) as session_date 
    from source
)

select * renamed
  );

[0m18:40:33.630397 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:40:33.630593 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: ROLLBACK
[0m18:40:33.631959 [debug] [Thread-1 (]: Failed to rollback 'model.quest_kingdom.stg_sessions'
[0m18:40:33.632119 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: Close
[0m18:40:33.633224 [debug] [Thread-1 (]: Runtime Error in model stg_sessions (models/staging/stg_sessions.sql)
  Conversion Error: extract specifier "date" not recognized
[0m18:40:33.633428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee53585e-eafe-4f6f-83ec-8d93e70f09fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fdb260>]}
[0m18:40:33.633713 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model main.stg_sessions ......................... [[31mERROR[0m in 0.01s]
[0m18:40:33.633954 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_sessions
[0m18:40:33.634186 [debug] [Thread-4 (]: Marking all children of 'model.quest_kingdom.stg_sessions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_sessions (models/staging/stg_sessions.sql)
  Conversion Error: extract specifier "date" not recognized.
[0m18:40:33.634742 [debug] [MainThread]: Using duckdb connection "master"
[0m18:40:33.634888 [debug] [MainThread]: On master: BEGIN
[0m18:40:33.635006 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:40:33.635269 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:40:33.635396 [debug] [MainThread]: On master: COMMIT
[0m18:40:33.635518 [debug] [MainThread]: Using duckdb connection "master"
[0m18:40:33.635633 [debug] [MainThread]: On master: COMMIT
[0m18:40:33.635820 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:40:33.635950 [debug] [MainThread]: On master: Close
[0m18:40:33.636106 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:40:33.636216 [debug] [MainThread]: Connection 'model.quest_kingdom.stg_sessions' was properly closed.
[0m18:40:33.636364 [info ] [MainThread]: 
[0m18:40:33.636496 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m18:40:33.636988 [debug] [MainThread]: Command end result
[0m18:40:33.651880 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/manifest.json
[0m18:40:33.653057 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/semantic_manifest.json
[0m18:40:33.655729 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/run_results.json
[0m18:40:33.655896 [info ] [MainThread]: 
[0m18:40:33.656073 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m18:40:33.656211 [info ] [MainThread]: 
[0m18:40:33.656386 [error] [MainThread]: [31mFailure in model stg_ad_impressions (models/staging/stg_ad_impressions.sql)[0m
[0m18:40:33.656552 [error] [MainThread]:   Runtime Error in model stg_ad_impressions (models/staging/stg_ad_impressions.sql)
  Parser Error: syntax error at or near "select"
  
  LINE 6:     select * from "quest_kingdom"."main"."ad_impressions"
              ^
[0m18:40:33.656677 [info ] [MainThread]: 
[0m18:40:33.656826 [info ] [MainThread]:   compiled code at target/compiled/quest_kingdom/models/staging/stg_ad_impressions.sql
[0m18:40:33.656954 [info ] [MainThread]: 
[0m18:40:33.657106 [error] [MainThread]: [31mFailure in model stg_events (models/staging/stg_events.sql)[0m
[0m18:40:33.657259 [error] [MainThread]:   Runtime Error in model stg_events (models/staging/stg_events.sql)
  Parser Error: syntax error at or near "select"
  
  LINE 6:     select * from "quest_kingdom"."main"."events"
              ^
[0m18:40:33.657377 [info ] [MainThread]: 
[0m18:40:33.657523 [info ] [MainThread]:   compiled code at target/compiled/quest_kingdom/models/staging/stg_events.sql
[0m18:40:33.657643 [info ] [MainThread]: 
[0m18:40:33.657792 [error] [MainThread]: [31mFailure in model stg_iap_transactions (models/staging/stg_iap_transactions.sql)[0m
[0m18:40:33.657945 [error] [MainThread]:   Runtime Error in model stg_iap_transactions (models/staging/stg_iap_transactions.sql)
  Parser Error: syntax error at or near "select"
  
  LINE 6:     select * from "quest_kingdom"."main"."iap_transactions"
              ^
[0m18:40:33.658064 [info ] [MainThread]: 
[0m18:40:33.658206 [info ] [MainThread]:   compiled code at target/compiled/quest_kingdom/models/staging/stg_iap_transactions.sql
[0m18:40:33.658389 [info ] [MainThread]: 
[0m18:40:33.658589 [error] [MainThread]: [31mFailure in model stg_sessions (models/staging/stg_sessions.sql)[0m
[0m18:40:33.658761 [error] [MainThread]:   Runtime Error in model stg_sessions (models/staging/stg_sessions.sql)
  Conversion Error: extract specifier "date" not recognized
[0m18:40:33.658889 [info ] [MainThread]: 
[0m18:40:33.659044 [info ] [MainThread]:   compiled code at target/compiled/quest_kingdom/models/staging/stg_sessions.sql
[0m18:40:33.659173 [info ] [MainThread]: 
[0m18:40:33.659323 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=4 SKIP=0 NO-OP=0 TOTAL=5
[0m18:40:33.660810 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2862564, "process_in_blocks": "0", "process_kernel_time": 0.192593, "process_mem_max_rss": "153698304", "process_out_blocks": "0", "process_user_time": 1.723949}
[0m18:40:33.661032 [debug] [MainThread]: Command `dbt run` failed at 18:40:33.660992 after 1.29 seconds
[0m18:40:33.661210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108973080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bb92e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aef440>]}
[0m18:40:33.661387 [debug] [MainThread]: Flushing usage events
[0m18:40:33.798353 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:50:20.750287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f9c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a65af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a65880>]}


============================== 18:50:20.755188 | cc7cff61-0951-4519-be1c-3f03c80ac37f ==============================
[0m18:50:20.755188 [info ] [MainThread]: Running with dbt=1.11.4
[0m18:50:20.755514 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'invocation_command': 'dbt run --select staging', 'fail_fast': 'False', 'partial_parse': 'True', 'write_json': 'True', 'empty': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'introspect': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'use_experimental_parser': 'False', 'warn_error': 'None', 'use_colors': 'True', 'profiles_dir': '/Users/hazeldonaldson/.dbt', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/logs', 'static_parser': 'True', 'debug': 'False'}
[0m18:50:20.938531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc7cff61-0951-4519-be1c-3f03c80ac37f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c55d30>]}
[0m18:50:20.967524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc7cff61-0951-4519-be1c-3f03c80ac37f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a20680>]}
[0m18:50:20.968934 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:50:21.020663 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m18:50:21.092830 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m18:50:21.093332 [debug] [MainThread]: Partial parsing: updated file: quest_kingdom://models/staging/stg_iap_transactions.sql
[0m18:50:21.093566 [debug] [MainThread]: Partial parsing: updated file: quest_kingdom://models/staging/stg_sessions.sql
[0m18:50:21.093960 [debug] [MainThread]: Partial parsing: updated file: quest_kingdom://models/staging/sources.yml
[0m18:50:21.094132 [debug] [MainThread]: Partial parsing: updated file: quest_kingdom://models/staging/stg_sessions.sql
[0m18:50:21.094280 [debug] [MainThread]: Partial parsing: updated file: quest_kingdom://models/staging/stg_ad_impressions.sql
[0m18:50:21.094419 [debug] [MainThread]: Partial parsing: updated file: quest_kingdom://models/staging/stg_iap_transactions.sql
[0m18:50:21.094547 [debug] [MainThread]: Partial parsing: updated file: quest_kingdom://models/staging/stg_events.sql
[0m18:50:21.407944 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.core
- models.staging
- models.marts
- models.product
- models.question_kingdom
- models.monetization
- models.retention
[0m18:50:21.412880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc7cff61-0951-4519-be1c-3f03c80ac37f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073dfa70>]}
[0m18:50:21.454558 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/manifest.json
[0m18:50:21.456106 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/semantic_manifest.json
[0m18:50:21.473675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc7cff61-0951-4519-be1c-3f03c80ac37f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107267020>]}
[0m18:50:21.473999 [info ] [MainThread]: Found 7 models, 23 data tests, 5 sources, 472 macros
[0m18:50:21.474177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc7cff61-0951-4519-be1c-3f03c80ac37f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10723c200>]}
[0m18:50:21.475289 [info ] [MainThread]: 
[0m18:50:21.475467 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:50:21.475601 [info ] [MainThread]: 
[0m18:50:21.475836 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:50:21.478202 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_quest_kingdom'
[0m18:50:21.506705 [debug] [ThreadPool]: Using duckdb connection "list_quest_kingdom"
[0m18:50:21.506953 [debug] [ThreadPool]: On list_quest_kingdom: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "list_quest_kingdom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"quest_kingdom"'
    
  
  
[0m18:50:21.507105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:21.524609 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m18:50:21.525600 [debug] [ThreadPool]: On list_quest_kingdom: Close
[0m18:50:21.525952 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_quest_kingdom, now create_quest_kingdom_main)
[0m18:50:21.526166 [debug] [ThreadPool]: Creating schema "database: "quest_kingdom"
schema: "main"
"
[0m18:50:21.529424 [debug] [ThreadPool]: Using duckdb connection "create_quest_kingdom_main"
[0m18:50:21.529592 [debug] [ThreadPool]: On create_quest_kingdom_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "create_quest_kingdom_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='quest_kingdom'
        and type='sqlite'
    
  
[0m18:50:21.529726 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:21.530444 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:50:21.531060 [debug] [ThreadPool]: Using duckdb connection "create_quest_kingdom_main"
[0m18:50:21.531196 [debug] [ThreadPool]: On create_quest_kingdom_main: BEGIN
[0m18:50:21.531534 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:50:21.531658 [debug] [ThreadPool]: Using duckdb connection "create_quest_kingdom_main"
[0m18:50:21.531778 [debug] [ThreadPool]: On create_quest_kingdom_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "create_quest_kingdom_main"} */

    
    
        create schema if not exists "quest_kingdom"."main"
    
[0m18:50:21.532283 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:50:21.532749 [debug] [ThreadPool]: On create_quest_kingdom_main: COMMIT
[0m18:50:21.532906 [debug] [ThreadPool]: Using duckdb connection "create_quest_kingdom_main"
[0m18:50:21.533037 [debug] [ThreadPool]: On create_quest_kingdom_main: COMMIT
[0m18:50:21.533270 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:50:21.533407 [debug] [ThreadPool]: On create_quest_kingdom_main: Close
[0m18:50:21.534036 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_quest_kingdom_main, now list_quest_kingdom_main)
[0m18:50:21.536696 [debug] [ThreadPool]: Using duckdb connection "list_quest_kingdom_main"
[0m18:50:21.536852 [debug] [ThreadPool]: On list_quest_kingdom_main: BEGIN
[0m18:50:21.537029 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:21.537278 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:50:21.537409 [debug] [ThreadPool]: Using duckdb connection "list_quest_kingdom_main"
[0m18:50:21.537544 [debug] [ThreadPool]: On list_quest_kingdom_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "list_quest_kingdom_main"} */
select
      'quest_kingdom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'quest_kingdom'
  
[0m18:50:21.548417 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:50:21.549138 [debug] [ThreadPool]: On list_quest_kingdom_main: ROLLBACK
[0m18:50:21.550122 [debug] [ThreadPool]: Failed to rollback 'list_quest_kingdom_main'
[0m18:50:21.550266 [debug] [ThreadPool]: On list_quest_kingdom_main: Close
[0m18:50:21.551007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc7cff61-0951-4519-be1c-3f03c80ac37f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107114650>]}
[0m18:50:21.551236 [debug] [MainThread]: Using duckdb connection "master"
[0m18:50:21.551364 [debug] [MainThread]: On master: BEGIN
[0m18:50:21.551477 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:50:21.551731 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:50:21.551861 [debug] [MainThread]: On master: COMMIT
[0m18:50:21.551984 [debug] [MainThread]: Using duckdb connection "master"
[0m18:50:21.552100 [debug] [MainThread]: On master: COMMIT
[0m18:50:21.552291 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:50:21.552415 [debug] [MainThread]: On master: Close
[0m18:50:21.553724 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_ad_impressions
[0m18:50:21.553976 [info ] [Thread-1 (]: 1 of 5 START sql view model main.stg_ad_impressions ............................ [RUN]
[0m18:50:21.554185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_quest_kingdom_main, now model.quest_kingdom.stg_ad_impressions)
[0m18:50:21.554349 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_ad_impressions
[0m18:50:21.558843 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_ad_impressions"
[0m18:50:21.559721 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_ad_impressions
[0m18:50:21.579635 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.stg_ad_impressions"
[0m18:50:21.580350 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_ad_impressions"
[0m18:50:21.580547 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: BEGIN
[0m18:50:21.580704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:50:21.581072 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:21.581225 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_ad_impressions"
[0m18:50:21.581381 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_ad_impressions"} */

  
  create view "quest_kingdom"."main"."stg_ad_impressions__dbt_tmp" as (
    select
    -- ids
    ad_id,
    player_id,
    session_id,
    
    -- timestamps
    ad_timestamp::timestamp as shown_at,
    
    -- dimensions
    lower(trim(ad_type)) as ad_type,
    lower(trim(ad_network)) as ad_network,
    
    -- booleans
    clicked,
    
    -- metrics
    revenue_usd,
    
    -- derived
    date_trunc('day', ad_timestamp::timestamp)::date as ad_date

from "quest_kingdom"."main"."ad_impressions"
  );

[0m18:50:21.582031 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:21.585250 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_ad_impressions"
[0m18:50:21.585532 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_ad_impressions"} */
alter view "quest_kingdom"."main"."stg_ad_impressions__dbt_tmp" rename to "stg_ad_impressions"
[0m18:50:21.586520 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:50:21.591277 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: COMMIT
[0m18:50:21.591480 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_ad_impressions"
[0m18:50:21.591638 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: COMMIT
[0m18:50:21.592201 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:21.594958 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_ad_impressions"
[0m18:50:21.595144 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_ad_impressions"} */

      drop view if exists "quest_kingdom"."main"."stg_ad_impressions__dbt_backup" cascade
    
[0m18:50:21.595626 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:21.596748 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: Close
[0m18:50:21.597697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc7cff61-0951-4519-be1c-3f03c80ac37f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107620650>]}
[0m18:50:21.597999 [info ] [Thread-1 (]: 1 of 5 OK created sql view model main.stg_ad_impressions ....................... [[32mOK[0m in 0.04s]
[0m18:50:21.598263 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_ad_impressions
[0m18:50:21.598447 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_events
[0m18:50:21.598676 [info ] [Thread-1 (]: 2 of 5 START sql view model main.stg_events .................................... [RUN]
[0m18:50:21.598873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_ad_impressions, now model.quest_kingdom.stg_events)
[0m18:50:21.599034 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_events
[0m18:50:21.600343 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_events"
[0m18:50:21.600756 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_events
[0m18:50:21.602546 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.stg_events"
[0m18:50:21.602975 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_events"
[0m18:50:21.603138 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: BEGIN
[0m18:50:21.603281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:50:21.603618 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:21.603768 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_events"
[0m18:50:21.603923 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_events"} */

  
  create view "quest_kingdom"."main"."stg_events__dbt_tmp" as (
    select
    -- ids
    event_id,
    player_id,
    session_id,
    
    -- timestamps
    event_timestamp::timestamp as event_at,
    
    -- dimensions
    lower(trim(event_name)) as event_name,
    
    -- json properties
    event_properties

from "quest_kingdom"."main"."events"
  );

[0m18:50:21.604455 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:21.605985 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_events"
[0m18:50:21.606159 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_events"} */
alter view "quest_kingdom"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m18:50:21.606454 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:21.607094 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: COMMIT
[0m18:50:21.607249 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_events"
[0m18:50:21.607387 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: COMMIT
[0m18:50:21.607722 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:21.608819 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_events"
[0m18:50:21.608978 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_events"} */

      drop view if exists "quest_kingdom"."main"."stg_events__dbt_backup" cascade
    
[0m18:50:21.609252 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:21.609841 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: Close
[0m18:50:21.610087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc7cff61-0951-4519-be1c-3f03c80ac37f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076d6c30>]}
[0m18:50:21.610365 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main.stg_events ............................... [[32mOK[0m in 0.01s]
[0m18:50:21.610608 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_events
[0m18:50:21.610786 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_iap_transactions
[0m18:50:21.611006 [info ] [Thread-1 (]: 3 of 5 START sql view model main.stg_iap_transactions .......................... [RUN]
[0m18:50:21.611192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_events, now model.quest_kingdom.stg_iap_transactions)
[0m18:50:21.611351 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_iap_transactions
[0m18:50:21.613517 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_iap_transactions"
[0m18:50:21.613883 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_iap_transactions
[0m18:50:21.615407 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.stg_iap_transactions"
[0m18:50:21.615861 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_iap_transactions"
[0m18:50:21.616020 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: BEGIN
[0m18:50:21.616167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:50:21.616473 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:21.616626 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_iap_transactions"
[0m18:50:21.616788 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_iap_transactions"} */

  
  create view "quest_kingdom"."main"."stg_iap_transactions__dbt_tmp" as (
    select
    -- ids
    transaction_id,
    player_id,
    session_id,
    
    -- timestamps
    transaction_timestamp::timestamp as purchased_at,
    
    -- dimensions
    lower(trim(sku)) as sku,
    lower(trim(platform)) as platform,
    
    -- metrics
    price_usd,
    gems_purchased,
    
    -- derived
    date_trunc('day', transaction_timestamp::timestamp)::date as purchase_date

from "quest_kingdom"."main"."iap_transactions"
  );

[0m18:50:21.617346 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:21.619130 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_iap_transactions"
[0m18:50:21.619576 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_iap_transactions"} */
alter view "quest_kingdom"."main"."stg_iap_transactions__dbt_tmp" rename to "stg_iap_transactions"
[0m18:50:21.620121 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:21.623595 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: COMMIT
[0m18:50:21.623790 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_iap_transactions"
[0m18:50:21.623947 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: COMMIT
[0m18:50:21.624395 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:21.625627 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_iap_transactions"
[0m18:50:21.625807 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_iap_transactions"} */

      drop view if exists "quest_kingdom"."main"."stg_iap_transactions__dbt_backup" cascade
    
[0m18:50:21.626107 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:21.626722 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: Close
[0m18:50:21.626973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc7cff61-0951-4519-be1c-3f03c80ac37f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107721910>]}
[0m18:50:21.627252 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.stg_iap_transactions ..................... [[32mOK[0m in 0.02s]
[0m18:50:21.627498 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_iap_transactions
[0m18:50:21.627675 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_players
[0m18:50:21.627897 [info ] [Thread-1 (]: 4 of 5 START sql view model main.stg_players ................................... [RUN]
[0m18:50:21.628084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_iap_transactions, now model.quest_kingdom.stg_players)
[0m18:50:21.628244 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_players
[0m18:50:21.629680 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_players"
[0m18:50:21.630209 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_players
[0m18:50:21.631803 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.stg_players"
[0m18:50:21.632112 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:50:21.632262 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: BEGIN
[0m18:50:21.632400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:50:21.632682 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:21.632829 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:50:21.632989 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_players"} */

  
  create view "quest_kingdom"."main"."stg_players__dbt_tmp" as (
    with source as (
    select * from "quest_kingdom"."main"."players"
),

renamed as (
    select
        player_id,
        install_date::date as installed_at,
        --dimensions
        lower(trim(attribution_channel)) as attribution_channel,
        lower(trim(country)) as country,
        lower(trim(device_type)) as device_type,
        lower(trim(player_segment)) as player_segment,
        lower(trim(experiment_variant)) as experiment_variant,
        --booleans
        tutorial_completed,
        --metrics
        lifetime_value as lifetime_value_usd
    from source 
)

select * from renamed
  );

[0m18:50:21.633599 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:21.635311 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:50:21.635575 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_players"} */
alter view "quest_kingdom"."main"."stg_players" rename to "stg_players__dbt_backup"
[0m18:50:21.636025 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:21.637534 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:50:21.637706 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_players"} */
alter view "quest_kingdom"."main"."stg_players__dbt_tmp" rename to "stg_players"
[0m18:50:21.638003 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:21.639719 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: COMMIT
[0m18:50:21.639894 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:50:21.640040 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: COMMIT
[0m18:50:21.640452 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:21.641553 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:50:21.641708 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_players"} */

      drop view if exists "quest_kingdom"."main"."stg_players__dbt_backup" cascade
    
[0m18:50:21.642035 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:21.642627 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: Close
[0m18:50:21.642876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc7cff61-0951-4519-be1c-3f03c80ac37f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076726f0>]}
[0m18:50:21.643159 [info ] [Thread-1 (]: 4 of 5 OK created sql view model main.stg_players .............................. [[32mOK[0m in 0.01s]
[0m18:50:21.643407 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_players
[0m18:50:21.643592 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_sessions
[0m18:50:21.643813 [info ] [Thread-1 (]: 5 of 5 START sql view model main.stg_sessions .................................. [RUN]
[0m18:50:21.644001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_players, now model.quest_kingdom.stg_sessions)
[0m18:50:21.644157 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_sessions
[0m18:50:21.645552 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_sessions"
[0m18:50:21.646205 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_sessions
[0m18:50:21.648713 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.stg_sessions"
[0m18:50:21.649023 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_sessions"
[0m18:50:21.649176 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: BEGIN
[0m18:50:21.649315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:50:21.649618 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:21.649765 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_sessions"
[0m18:50:21.649928 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_sessions"} */

  
  create view "quest_kingdom"."main"."stg_sessions__dbt_tmp" as (
    with source as (
    select * from "quest_kingdom"."main"."sessions"
),

renamed as (
    select 
        session_id,
        player_id,
        --timestamps
        session_start::timestamp as session_started_at,
        session_end::timestamp as session_ended_at,

        --metrics
        session_duration_minutes,
        starting_level,
        ending_level,
        levels_gained,

        --derived metrics
        extract(hour from session_start::timestamp) as session_hour,
        extract(dow from session_start::timestamp) as session_day_of_week,
        date_trunc('date', session_start::timestamp)::date as session_date 
    from source
)

select * renamed
  );

[0m18:50:21.654035 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_sessions"} */

  
  create view "quest_kingdom"."main"."stg_sessions__dbt_tmp" as (
    with source as (
    select * from "quest_kingdom"."main"."sessions"
),

renamed as (
    select 
        session_id,
        player_id,
        --timestamps
        session_start::timestamp as session_started_at,
        session_end::timestamp as session_ended_at,

        --metrics
        session_duration_minutes,
        starting_level,
        ending_level,
        levels_gained,

        --derived metrics
        extract(hour from session_start::timestamp) as session_hour,
        extract(dow from session_start::timestamp) as session_day_of_week,
        date_trunc('date', session_start::timestamp)::date as session_date 
    from source
)

select * renamed
  );

[0m18:50:21.654293 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:50:21.654513 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: ROLLBACK
[0m18:50:21.658777 [debug] [Thread-1 (]: Failed to rollback 'model.quest_kingdom.stg_sessions'
[0m18:50:21.658970 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: Close
[0m18:50:21.660147 [debug] [Thread-1 (]: Runtime Error in model stg_sessions (models/staging/stg_sessions.sql)
  Conversion Error: extract specifier "date" not recognized
[0m18:50:21.660373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc7cff61-0951-4519-be1c-3f03c80ac37f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107741ee0>]}
[0m18:50:21.660672 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model main.stg_sessions ......................... [[31mERROR[0m in 0.02s]
[0m18:50:21.660924 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_sessions
[0m18:50:21.661169 [debug] [Thread-4 (]: Marking all children of 'model.quest_kingdom.stg_sessions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_sessions (models/staging/stg_sessions.sql)
  Conversion Error: extract specifier "date" not recognized.
[0m18:50:21.662003 [debug] [MainThread]: Using duckdb connection "master"
[0m18:50:21.662148 [debug] [MainThread]: On master: BEGIN
[0m18:50:21.662266 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:50:21.662568 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:50:21.662695 [debug] [MainThread]: On master: COMMIT
[0m18:50:21.662816 [debug] [MainThread]: Using duckdb connection "master"
[0m18:50:21.662930 [debug] [MainThread]: On master: COMMIT
[0m18:50:21.663128 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:50:21.663253 [debug] [MainThread]: On master: Close
[0m18:50:21.663414 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:50:21.663528 [debug] [MainThread]: Connection 'model.quest_kingdom.stg_sessions' was properly closed.
[0m18:50:21.663683 [info ] [MainThread]: 
[0m18:50:21.663818 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m18:50:21.664310 [debug] [MainThread]: Command end result
[0m18:50:21.677463 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/manifest.json
[0m18:50:21.678524 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/semantic_manifest.json
[0m18:50:21.681449 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/run_results.json
[0m18:50:21.681628 [info ] [MainThread]: 
[0m18:50:21.681810 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:50:21.681959 [info ] [MainThread]: 
[0m18:50:21.682143 [error] [MainThread]: [31mFailure in model stg_sessions (models/staging/stg_sessions.sql)[0m
[0m18:50:21.682309 [error] [MainThread]:   Runtime Error in model stg_sessions (models/staging/stg_sessions.sql)
  Conversion Error: extract specifier "date" not recognized
[0m18:50:21.682432 [info ] [MainThread]: 
[0m18:50:21.682577 [info ] [MainThread]:   compiled code at target/compiled/quest_kingdom/models/staging/stg_sessions.sql
[0m18:50:21.682705 [info ] [MainThread]: 
[0m18:50:21.682847 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m18:50:21.684224 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9751828, "process_in_blocks": "0", "process_kernel_time": 0.207678, "process_mem_max_rss": "150339584", "process_out_blocks": "0", "process_user_time": 1.400978}
[0m18:50:21.684428 [debug] [MainThread]: Command `dbt run` failed at 18:50:21.684391 after 0.98 seconds
[0m18:50:21.684596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a658b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a65bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067163c0>]}
[0m18:50:21.684754 [debug] [MainThread]: Flushing usage events
[0m18:50:21.815477 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:50:58.933742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106601f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cddc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cdd9d0>]}


============================== 18:50:58.937078 | 64a175e6-a78f-44f8-8715-fa4efb7b4bd0 ==============================
[0m18:50:58.937078 [info ] [MainThread]: Running with dbt=1.11.4
[0m18:50:58.937408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/logs', 'indirect_selection': 'eager', 'introspect': 'True', 'write_json': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/hazeldonaldson/.dbt', 'debug': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'use_colors': 'True', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --select staging', 'static_parser': 'True', 'empty': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'quiet': 'False'}
[0m18:50:59.107537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64a175e6-a78f-44f8-8715-fa4efb7b4bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e7a990>]}
[0m18:50:59.136368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64a175e6-a78f-44f8-8715-fa4efb7b4bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a3dd00>]}
[0m18:50:59.137629 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:50:59.189175 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m18:50:59.255015 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:50:59.255437 [debug] [MainThread]: Partial parsing: updated file: quest_kingdom://models/staging/stg_sessions.sql
[0m18:50:59.456170 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.staging
- models.question_kingdom
- models.product
- models.core
- models.marts
- models.monetization
- models.retention
[0m18:50:59.463932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64a175e6-a78f-44f8-8715-fa4efb7b4bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107413410>]}
[0m18:50:59.544437 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/manifest.json
[0m18:50:59.545884 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/semantic_manifest.json
[0m18:50:59.558580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64a175e6-a78f-44f8-8715-fa4efb7b4bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075b0aa0>]}
[0m18:50:59.558878 [info ] [MainThread]: Found 7 models, 23 data tests, 5 sources, 472 macros
[0m18:50:59.559055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64a175e6-a78f-44f8-8715-fa4efb7b4bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10754b590>]}
[0m18:50:59.560069 [info ] [MainThread]: 
[0m18:50:59.560250 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:50:59.560385 [info ] [MainThread]: 
[0m18:50:59.560612 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:50:59.562929 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_quest_kingdom'
[0m18:50:59.591001 [debug] [ThreadPool]: Using duckdb connection "list_quest_kingdom"
[0m18:50:59.591256 [debug] [ThreadPool]: On list_quest_kingdom: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "list_quest_kingdom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"quest_kingdom"'
    
  
  
[0m18:50:59.591408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:59.609899 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m18:50:59.611119 [debug] [ThreadPool]: On list_quest_kingdom: Close
[0m18:50:59.611512 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_quest_kingdom, now create_quest_kingdom_main)
[0m18:50:59.611766 [debug] [ThreadPool]: Creating schema "database: "quest_kingdom"
schema: "main"
"
[0m18:50:59.615162 [debug] [ThreadPool]: Using duckdb connection "create_quest_kingdom_main"
[0m18:50:59.615355 [debug] [ThreadPool]: On create_quest_kingdom_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "create_quest_kingdom_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='quest_kingdom'
        and type='sqlite'
    
  
[0m18:50:59.615495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:59.616282 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:50:59.617110 [debug] [ThreadPool]: Using duckdb connection "create_quest_kingdom_main"
[0m18:50:59.617265 [debug] [ThreadPool]: On create_quest_kingdom_main: BEGIN
[0m18:50:59.617506 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:50:59.617639 [debug] [ThreadPool]: Using duckdb connection "create_quest_kingdom_main"
[0m18:50:59.617766 [debug] [ThreadPool]: On create_quest_kingdom_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "create_quest_kingdom_main"} */

    
    
        create schema if not exists "quest_kingdom"."main"
    
[0m18:50:59.618184 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:50:59.618570 [debug] [ThreadPool]: On create_quest_kingdom_main: COMMIT
[0m18:50:59.618707 [debug] [ThreadPool]: Using duckdb connection "create_quest_kingdom_main"
[0m18:50:59.618827 [debug] [ThreadPool]: On create_quest_kingdom_main: COMMIT
[0m18:50:59.619034 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:50:59.619257 [debug] [ThreadPool]: On create_quest_kingdom_main: Close
[0m18:50:59.619995 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_quest_kingdom_main, now list_quest_kingdom_main)
[0m18:50:59.622785 [debug] [ThreadPool]: Using duckdb connection "list_quest_kingdom_main"
[0m18:50:59.622951 [debug] [ThreadPool]: On list_quest_kingdom_main: BEGIN
[0m18:50:59.623138 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:59.623416 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:50:59.623552 [debug] [ThreadPool]: Using duckdb connection "list_quest_kingdom_main"
[0m18:50:59.623688 [debug] [ThreadPool]: On list_quest_kingdom_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "list_quest_kingdom_main"} */
select
      'quest_kingdom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'quest_kingdom'
  
[0m18:50:59.634960 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:50:59.635857 [debug] [ThreadPool]: On list_quest_kingdom_main: ROLLBACK
[0m18:50:59.636875 [debug] [ThreadPool]: Failed to rollback 'list_quest_kingdom_main'
[0m18:50:59.637029 [debug] [ThreadPool]: On list_quest_kingdom_main: Close
[0m18:50:59.637862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64a175e6-a78f-44f8-8715-fa4efb7b4bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107587a70>]}
[0m18:50:59.638140 [debug] [MainThread]: Using duckdb connection "master"
[0m18:50:59.638293 [debug] [MainThread]: On master: BEGIN
[0m18:50:59.638425 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:50:59.638739 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:50:59.638877 [debug] [MainThread]: On master: COMMIT
[0m18:50:59.639005 [debug] [MainThread]: Using duckdb connection "master"
[0m18:50:59.639121 [debug] [MainThread]: On master: COMMIT
[0m18:50:59.639326 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:50:59.639455 [debug] [MainThread]: On master: Close
[0m18:50:59.640833 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_ad_impressions
[0m18:50:59.641077 [info ] [Thread-1 (]: 1 of 5 START sql view model main.stg_ad_impressions ............................ [RUN]
[0m18:50:59.641282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_quest_kingdom_main, now model.quest_kingdom.stg_ad_impressions)
[0m18:50:59.641444 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_ad_impressions
[0m18:50:59.645045 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_ad_impressions"
[0m18:50:59.646044 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_ad_impressions
[0m18:50:59.661546 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.stg_ad_impressions"
[0m18:50:59.662113 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_ad_impressions"
[0m18:50:59.662292 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: BEGIN
[0m18:50:59.662444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:50:59.662802 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:59.662949 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_ad_impressions"
[0m18:50:59.663105 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_ad_impressions"} */

  
  create view "quest_kingdom"."main"."stg_ad_impressions__dbt_tmp" as (
    select
    -- ids
    ad_id,
    player_id,
    session_id,
    
    -- timestamps
    ad_timestamp::timestamp as shown_at,
    
    -- dimensions
    lower(trim(ad_type)) as ad_type,
    lower(trim(ad_network)) as ad_network,
    
    -- booleans
    clicked,
    
    -- metrics
    revenue_usd,
    
    -- derived
    date_trunc('day', ad_timestamp::timestamp)::date as ad_date

from "quest_kingdom"."main"."ad_impressions"
  );

[0m18:50:59.663808 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:50:59.667394 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_ad_impressions"
[0m18:50:59.667751 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_ad_impressions"} */
alter view "quest_kingdom"."main"."stg_ad_impressions" rename to "stg_ad_impressions__dbt_backup"
[0m18:50:59.668636 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:50:59.673517 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_ad_impressions"
[0m18:50:59.673739 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_ad_impressions"} */
alter view "quest_kingdom"."main"."stg_ad_impressions__dbt_tmp" rename to "stg_ad_impressions"
[0m18:50:59.674145 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:59.680586 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: COMMIT
[0m18:50:59.680937 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_ad_impressions"
[0m18:50:59.681104 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: COMMIT
[0m18:50:59.681945 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:50:59.684772 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_ad_impressions"
[0m18:50:59.684982 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_ad_impressions"} */

      drop view if exists "quest_kingdom"."main"."stg_ad_impressions__dbt_backup" cascade
    
[0m18:50:59.685628 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:59.686966 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: Close
[0m18:50:59.687980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64a175e6-a78f-44f8-8715-fa4efb7b4bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107907f20>]}
[0m18:50:59.688313 [info ] [Thread-1 (]: 1 of 5 OK created sql view model main.stg_ad_impressions ....................... [[32mOK[0m in 0.05s]
[0m18:50:59.688590 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_ad_impressions
[0m18:50:59.688783 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_events
[0m18:50:59.689021 [info ] [Thread-1 (]: 2 of 5 START sql view model main.stg_events .................................... [RUN]
[0m18:50:59.689225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_ad_impressions, now model.quest_kingdom.stg_events)
[0m18:50:59.689388 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_events
[0m18:50:59.690788 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_events"
[0m18:50:59.691270 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_events
[0m18:50:59.692834 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.stg_events"
[0m18:50:59.693164 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_events"
[0m18:50:59.693325 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: BEGIN
[0m18:50:59.693473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:50:59.693848 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:59.693997 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_events"
[0m18:50:59.694153 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_events"} */

  
  create view "quest_kingdom"."main"."stg_events__dbt_tmp" as (
    select
    -- ids
    event_id,
    player_id,
    session_id,
    
    -- timestamps
    event_timestamp::timestamp as event_at,
    
    -- dimensions
    lower(trim(event_name)) as event_name,
    
    -- json properties
    event_properties

from "quest_kingdom"."main"."events"
  );

[0m18:50:59.694575 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:59.696415 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_events"
[0m18:50:59.696621 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_events"} */
alter view "quest_kingdom"."main"."stg_events" rename to "stg_events__dbt_backup"
[0m18:50:59.697002 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:59.698411 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_events"
[0m18:50:59.698578 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_events"} */
alter view "quest_kingdom"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m18:50:59.698869 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:59.699577 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: COMMIT
[0m18:50:59.699745 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_events"
[0m18:50:59.699894 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: COMMIT
[0m18:50:59.700311 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:59.701442 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_events"
[0m18:50:59.701609 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_events"} */

      drop view if exists "quest_kingdom"."main"."stg_events__dbt_backup" cascade
    
[0m18:50:59.701995 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:59.702773 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: Close
[0m18:50:59.703192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64a175e6-a78f-44f8-8715-fa4efb7b4bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107879e80>]}
[0m18:50:59.703732 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main.stg_events ............................... [[32mOK[0m in 0.01s]
[0m18:50:59.704249 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_events
[0m18:50:59.704655 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_iap_transactions
[0m18:50:59.704980 [info ] [Thread-1 (]: 3 of 5 START sql view model main.stg_iap_transactions .......................... [RUN]
[0m18:50:59.705383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_events, now model.quest_kingdom.stg_iap_transactions)
[0m18:50:59.705609 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_iap_transactions
[0m18:50:59.707118 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_iap_transactions"
[0m18:50:59.707484 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_iap_transactions
[0m18:50:59.709104 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.stg_iap_transactions"
[0m18:50:59.709550 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_iap_transactions"
[0m18:50:59.709708 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: BEGIN
[0m18:50:59.709853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:50:59.710212 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:59.710502 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_iap_transactions"
[0m18:50:59.710697 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_iap_transactions"} */

  
  create view "quest_kingdom"."main"."stg_iap_transactions__dbt_tmp" as (
    select
    -- ids
    transaction_id,
    player_id,
    session_id,
    
    -- timestamps
    transaction_timestamp::timestamp as purchased_at,
    
    -- dimensions
    lower(trim(sku)) as sku,
    lower(trim(platform)) as platform,
    
    -- metrics
    price_usd,
    gems_purchased,
    
    -- derived
    date_trunc('day', transaction_timestamp::timestamp)::date as purchase_date

from "quest_kingdom"."main"."iap_transactions"
  );

[0m18:50:59.711199 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:59.712778 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_iap_transactions"
[0m18:50:59.712957 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_iap_transactions"} */
alter view "quest_kingdom"."main"."stg_iap_transactions" rename to "stg_iap_transactions__dbt_backup"
[0m18:50:59.713268 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:59.715624 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_iap_transactions"
[0m18:50:59.715806 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_iap_transactions"} */
alter view "quest_kingdom"."main"."stg_iap_transactions__dbt_tmp" rename to "stg_iap_transactions"
[0m18:50:59.716115 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:59.716826 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: COMMIT
[0m18:50:59.716999 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_iap_transactions"
[0m18:50:59.717148 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: COMMIT
[0m18:50:59.717524 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:59.718586 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_iap_transactions"
[0m18:50:59.718749 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_iap_transactions"} */

      drop view if exists "quest_kingdom"."main"."stg_iap_transactions__dbt_backup" cascade
    
[0m18:50:59.719072 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:59.719863 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: Close
[0m18:50:59.720402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64a175e6-a78f-44f8-8715-fa4efb7b4bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10793a8d0>]}
[0m18:50:59.720795 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.stg_iap_transactions ..................... [[32mOK[0m in 0.02s]
[0m18:50:59.721056 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_iap_transactions
[0m18:50:59.721235 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_players
[0m18:50:59.721452 [info ] [Thread-1 (]: 4 of 5 START sql view model main.stg_players ................................... [RUN]
[0m18:50:59.721686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_iap_transactions, now model.quest_kingdom.stg_players)
[0m18:50:59.721873 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_players
[0m18:50:59.723381 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_players"
[0m18:50:59.723787 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_players
[0m18:50:59.725357 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.stg_players"
[0m18:50:59.725948 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:50:59.726123 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: BEGIN
[0m18:50:59.726270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:50:59.726632 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:59.726851 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:50:59.727018 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_players"} */

  
  create view "quest_kingdom"."main"."stg_players__dbt_tmp" as (
    with source as (
    select * from "quest_kingdom"."main"."players"
),

renamed as (
    select
        player_id,
        install_date::date as installed_at,
        --dimensions
        lower(trim(attribution_channel)) as attribution_channel,
        lower(trim(country)) as country,
        lower(trim(device_type)) as device_type,
        lower(trim(player_segment)) as player_segment,
        lower(trim(experiment_variant)) as experiment_variant,
        --booleans
        tutorial_completed,
        --metrics
        lifetime_value as lifetime_value_usd
    from source 
)

select * from renamed
  );

[0m18:50:59.727704 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:50:59.729457 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:50:59.729647 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_players"} */
alter view "quest_kingdom"."main"."stg_players" rename to "stg_players__dbt_backup"
[0m18:50:59.729984 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:59.731387 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:50:59.731559 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_players"} */
alter view "quest_kingdom"."main"."stg_players__dbt_tmp" rename to "stg_players"
[0m18:50:59.731851 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:59.732554 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: COMMIT
[0m18:50:59.732718 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:50:59.732863 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: COMMIT
[0m18:50:59.733252 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:59.734325 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:50:59.734480 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_players"} */

      drop view if exists "quest_kingdom"."main"."stg_players__dbt_backup" cascade
    
[0m18:50:59.734807 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:59.735396 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: Close
[0m18:50:59.735650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64a175e6-a78f-44f8-8715-fa4efb7b4bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079007a0>]}
[0m18:50:59.736016 [info ] [Thread-1 (]: 4 of 5 OK created sql view model main.stg_players .............................. [[32mOK[0m in 0.01s]
[0m18:50:59.736309 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_players
[0m18:50:59.736501 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_sessions
[0m18:50:59.736812 [info ] [Thread-1 (]: 5 of 5 START sql view model main.stg_sessions .................................. [RUN]
[0m18:50:59.737081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_players, now model.quest_kingdom.stg_sessions)
[0m18:50:59.737307 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_sessions
[0m18:50:59.738882 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_sessions"
[0m18:50:59.739526 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_sessions
[0m18:50:59.741146 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.stg_sessions"
[0m18:50:59.741481 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_sessions"
[0m18:50:59.741644 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: BEGIN
[0m18:50:59.741788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:50:59.742137 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:50:59.742321 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_sessions"
[0m18:50:59.742485 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_sessions"} */

  
  create view "quest_kingdom"."main"."stg_sessions__dbt_tmp" as (
    with source as (
    select * from "quest_kingdom"."main"."sessions"
),

renamed as (
    select 
        session_id,
        player_id,
        --timestamps
        session_start::timestamp as session_started_at,
        session_end::timestamp as session_ended_at,

        --metrics
        session_duration_minutes,
        starting_level,
        ending_level,
        levels_gained,

        --derived metrics
        extract(hour from session_start::timestamp) as session_hour,
        extract(dow from session_start::timestamp) as session_day_of_week,
        date_trunc('day', session_start::timestamp)::date as session_date 
    from source
)

select * renamed
  );

[0m18:50:59.745683 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_sessions"} */

  
  create view "quest_kingdom"."main"."stg_sessions__dbt_tmp" as (
    with source as (
    select * from "quest_kingdom"."main"."sessions"
),

renamed as (
    select 
        session_id,
        player_id,
        --timestamps
        session_start::timestamp as session_started_at,
        session_end::timestamp as session_ended_at,

        --metrics
        session_duration_minutes,
        starting_level,
        ending_level,
        levels_gained,

        --derived metrics
        extract(hour from session_start::timestamp) as session_hour,
        extract(dow from session_start::timestamp) as session_day_of_week,
        date_trunc('day', session_start::timestamp)::date as session_date 
    from source
)

select * renamed
  );

[0m18:50:59.745898 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:50:59.746116 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: ROLLBACK
[0m18:50:59.750437 [debug] [Thread-1 (]: Failed to rollback 'model.quest_kingdom.stg_sessions'
[0m18:50:59.750623 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: Close
[0m18:50:59.751815 [debug] [Thread-1 (]: Runtime Error in model stg_sessions (models/staging/stg_sessions.sql)
  Binder Error: * expression without FROM clause!
[0m18:50:59.752044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64a175e6-a78f-44f8-8715-fa4efb7b4bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107699970>]}
[0m18:50:59.752357 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model main.stg_sessions ......................... [[31mERROR[0m in 0.01s]
[0m18:50:59.752902 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_sessions
[0m18:50:59.753370 [debug] [Thread-4 (]: Marking all children of 'model.quest_kingdom.stg_sessions' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_sessions (models/staging/stg_sessions.sql)
  Binder Error: * expression without FROM clause!.
[0m18:50:59.754522 [debug] [MainThread]: Using duckdb connection "master"
[0m18:50:59.754703 [debug] [MainThread]: On master: BEGIN
[0m18:50:59.754834 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:50:59.755204 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:50:59.755358 [debug] [MainThread]: On master: COMMIT
[0m18:50:59.755489 [debug] [MainThread]: Using duckdb connection "master"
[0m18:50:59.755610 [debug] [MainThread]: On master: COMMIT
[0m18:50:59.755826 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:50:59.755959 [debug] [MainThread]: On master: Close
[0m18:50:59.756131 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:50:59.756252 [debug] [MainThread]: Connection 'model.quest_kingdom.stg_sessions' was properly closed.
[0m18:50:59.756414 [info ] [MainThread]: 
[0m18:50:59.756561 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m18:50:59.757061 [debug] [MainThread]: Command end result
[0m18:50:59.771165 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/manifest.json
[0m18:50:59.772290 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/semantic_manifest.json
[0m18:50:59.775287 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/run_results.json
[0m18:50:59.775463 [info ] [MainThread]: 
[0m18:50:59.775649 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:50:59.775796 [info ] [MainThread]: 
[0m18:50:59.775972 [error] [MainThread]: [31mFailure in model stg_sessions (models/staging/stg_sessions.sql)[0m
[0m18:50:59.776132 [error] [MainThread]:   Runtime Error in model stg_sessions (models/staging/stg_sessions.sql)
  Binder Error: * expression without FROM clause!
[0m18:50:59.776251 [info ] [MainThread]: 
[0m18:50:59.776395 [info ] [MainThread]:   compiled code at target/compiled/quest_kingdom/models/staging/stg_sessions.sql
[0m18:50:59.776522 [info ] [MainThread]: 
[0m18:50:59.776805 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m18:50:59.779113 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.88421965, "process_in_blocks": "0", "process_kernel_time": 0.18468, "process_mem_max_rss": "150028288", "process_out_blocks": "0", "process_user_time": 1.316104}
[0m18:50:59.779402 [debug] [MainThread]: Command `dbt run` failed at 18:50:59.779359 after 0.88 seconds
[0m18:50:59.779601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078d3170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cddac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cddaf0>]}
[0m18:50:59.779778 [debug] [MainThread]: Flushing usage events
[0m18:50:59.905615 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:51:38.857762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043df6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c79940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c79400>]}


============================== 18:51:38.861607 | 7f539c1b-eadf-4316-b5ff-1e729e815bc3 ==============================
[0m18:51:38.861607 [info ] [MainThread]: Running with dbt=1.11.4
[0m18:51:38.861958 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/hazeldonaldson/.dbt', 'quiet': 'False', 'fail_fast': 'False', 'log_path': '/Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/logs', 'invocation_command': 'dbt run --select staging', 'write_json': 'True', 'introspect': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'log_format': 'default', 'warn_error': 'None', 'printer_width': '80', 'target_path': 'None', 'static_parser': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_cache_events': 'False', 'empty': 'False'}
[0m18:51:39.025455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f539c1b-eadf-4316-b5ff-1e729e815bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e16870>]}
[0m18:51:39.054160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f539c1b-eadf-4316-b5ff-1e729e815bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b387a0>]}
[0m18:51:39.055475 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:51:39.109377 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m18:51:39.175240 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:51:39.175655 [debug] [MainThread]: Partial parsing: updated file: quest_kingdom://models/staging/stg_sessions.sql
[0m18:51:39.370517 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.core
- models.staging
- models.monetization
- models.question_kingdom
- models.marts
- models.product
- models.retention
[0m18:51:39.377765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f539c1b-eadf-4316-b5ff-1e729e815bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055536e0>]}
[0m18:51:39.458391 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/manifest.json
[0m18:51:39.459669 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/semantic_manifest.json
[0m18:51:39.472778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f539c1b-eadf-4316-b5ff-1e729e815bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054b5d30>]}
[0m18:51:39.473086 [info ] [MainThread]: Found 7 models, 23 data tests, 5 sources, 472 macros
[0m18:51:39.473263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f539c1b-eadf-4316-b5ff-1e729e815bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055524e0>]}
[0m18:51:39.474267 [info ] [MainThread]: 
[0m18:51:39.474446 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:51:39.474583 [info ] [MainThread]: 
[0m18:51:39.474811 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:51:39.477060 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_quest_kingdom'
[0m18:51:39.505940 [debug] [ThreadPool]: Using duckdb connection "list_quest_kingdom"
[0m18:51:39.506191 [debug] [ThreadPool]: On list_quest_kingdom: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "list_quest_kingdom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"quest_kingdom"'
    
  
  
[0m18:51:39.506342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:51:39.524744 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m18:51:39.525786 [debug] [ThreadPool]: On list_quest_kingdom: Close
[0m18:51:39.526159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_quest_kingdom, now create_quest_kingdom_main)
[0m18:51:39.526418 [debug] [ThreadPool]: Creating schema "database: "quest_kingdom"
schema: "main"
"
[0m18:51:39.530731 [debug] [ThreadPool]: Using duckdb connection "create_quest_kingdom_main"
[0m18:51:39.530959 [debug] [ThreadPool]: On create_quest_kingdom_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "create_quest_kingdom_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='quest_kingdom'
        and type='sqlite'
    
  
[0m18:51:39.531103 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:51:39.532038 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:51:39.532748 [debug] [ThreadPool]: Using duckdb connection "create_quest_kingdom_main"
[0m18:51:39.532903 [debug] [ThreadPool]: On create_quest_kingdom_main: BEGIN
[0m18:51:39.533145 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:51:39.533277 [debug] [ThreadPool]: Using duckdb connection "create_quest_kingdom_main"
[0m18:51:39.533405 [debug] [ThreadPool]: On create_quest_kingdom_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "create_quest_kingdom_main"} */

    
    
        create schema if not exists "quest_kingdom"."main"
    
[0m18:51:39.533889 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:51:39.534289 [debug] [ThreadPool]: On create_quest_kingdom_main: COMMIT
[0m18:51:39.534426 [debug] [ThreadPool]: Using duckdb connection "create_quest_kingdom_main"
[0m18:51:39.534546 [debug] [ThreadPool]: On create_quest_kingdom_main: COMMIT
[0m18:51:39.534747 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:51:39.534879 [debug] [ThreadPool]: On create_quest_kingdom_main: Close
[0m18:51:39.535565 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_quest_kingdom_main, now list_quest_kingdom_main)
[0m18:51:39.538517 [debug] [ThreadPool]: Using duckdb connection "list_quest_kingdom_main"
[0m18:51:39.538698 [debug] [ThreadPool]: On list_quest_kingdom_main: BEGIN
[0m18:51:39.538887 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:51:39.539170 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:51:39.539299 [debug] [ThreadPool]: Using duckdb connection "list_quest_kingdom_main"
[0m18:51:39.539431 [debug] [ThreadPool]: On list_quest_kingdom_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "list_quest_kingdom_main"} */
select
      'quest_kingdom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'quest_kingdom'
  
[0m18:51:39.550785 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:51:39.551679 [debug] [ThreadPool]: On list_quest_kingdom_main: ROLLBACK
[0m18:51:39.552633 [debug] [ThreadPool]: Failed to rollback 'list_quest_kingdom_main'
[0m18:51:39.552800 [debug] [ThreadPool]: On list_quest_kingdom_main: Close
[0m18:51:39.553712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f539c1b-eadf-4316-b5ff-1e729e815bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10547ff50>]}
[0m18:51:39.553949 [debug] [MainThread]: Using duckdb connection "master"
[0m18:51:39.554082 [debug] [MainThread]: On master: BEGIN
[0m18:51:39.554206 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:51:39.554504 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:51:39.554636 [debug] [MainThread]: On master: COMMIT
[0m18:51:39.554762 [debug] [MainThread]: Using duckdb connection "master"
[0m18:51:39.554880 [debug] [MainThread]: On master: COMMIT
[0m18:51:39.555171 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:51:39.555304 [debug] [MainThread]: On master: Close
[0m18:51:39.556666 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_ad_impressions
[0m18:51:39.556922 [info ] [Thread-1 (]: 1 of 5 START sql view model main.stg_ad_impressions ............................ [RUN]
[0m18:51:39.557137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_quest_kingdom_main, now model.quest_kingdom.stg_ad_impressions)
[0m18:51:39.557303 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_ad_impressions
[0m18:51:39.560941 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_ad_impressions"
[0m18:51:39.561925 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_ad_impressions
[0m18:51:39.577856 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.stg_ad_impressions"
[0m18:51:39.578316 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_ad_impressions"
[0m18:51:39.578488 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: BEGIN
[0m18:51:39.578638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:51:39.579010 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:51:39.579165 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_ad_impressions"
[0m18:51:39.579323 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_ad_impressions"} */

  
  create view "quest_kingdom"."main"."stg_ad_impressions__dbt_tmp" as (
    select
    -- ids
    ad_id,
    player_id,
    session_id,
    
    -- timestamps
    ad_timestamp::timestamp as shown_at,
    
    -- dimensions
    lower(trim(ad_type)) as ad_type,
    lower(trim(ad_network)) as ad_network,
    
    -- booleans
    clicked,
    
    -- metrics
    revenue_usd,
    
    -- derived
    date_trunc('day', ad_timestamp::timestamp)::date as ad_date

from "quest_kingdom"."main"."ad_impressions"
  );

[0m18:51:39.580032 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:51:39.583424 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_ad_impressions"
[0m18:51:39.587083 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_ad_impressions"} */
alter view "quest_kingdom"."main"."stg_ad_impressions" rename to "stg_ad_impressions__dbt_backup"
[0m18:51:39.588044 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:51:39.589552 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_ad_impressions"
[0m18:51:39.589720 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_ad_impressions"} */
alter view "quest_kingdom"."main"."stg_ad_impressions__dbt_tmp" rename to "stg_ad_impressions"
[0m18:51:39.590016 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:51:39.595509 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: COMMIT
[0m18:51:39.595706 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_ad_impressions"
[0m18:51:39.595865 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: COMMIT
[0m18:51:39.596632 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:51:39.599946 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_ad_impressions"
[0m18:51:39.600133 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_ad_impressions"} */

      drop view if exists "quest_kingdom"."main"."stg_ad_impressions__dbt_backup" cascade
    
[0m18:51:39.600715 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:51:39.601891 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: Close
[0m18:51:39.602868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f539c1b-eadf-4316-b5ff-1e729e815bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ef3380>]}
[0m18:51:39.603183 [info ] [Thread-1 (]: 1 of 5 OK created sql view model main.stg_ad_impressions ....................... [[32mOK[0m in 0.05s]
[0m18:51:39.603556 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_ad_impressions
[0m18:51:39.603752 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_events
[0m18:51:39.603998 [info ] [Thread-1 (]: 2 of 5 START sql view model main.stg_events .................................... [RUN]
[0m18:51:39.604213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_ad_impressions, now model.quest_kingdom.stg_events)
[0m18:51:39.604376 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_events
[0m18:51:39.605790 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_events"
[0m18:51:39.606310 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_events
[0m18:51:39.607843 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.stg_events"
[0m18:51:39.608141 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_events"
[0m18:51:39.608289 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: BEGIN
[0m18:51:39.608428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:51:39.608829 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:51:39.608980 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_events"
[0m18:51:39.609136 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_events"} */

  
  create view "quest_kingdom"."main"."stg_events__dbt_tmp" as (
    select
    -- ids
    event_id,
    player_id,
    session_id,
    
    -- timestamps
    event_timestamp::timestamp as event_at,
    
    -- dimensions
    lower(trim(event_name)) as event_name,
    
    -- json properties
    event_properties

from "quest_kingdom"."main"."events"
  );

[0m18:51:39.609538 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:51:39.611104 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_events"
[0m18:51:39.611323 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_events"} */
alter view "quest_kingdom"."main"."stg_events" rename to "stg_events__dbt_backup"
[0m18:51:39.611671 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:51:39.613063 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_events"
[0m18:51:39.613231 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_events"} */
alter view "quest_kingdom"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m18:51:39.613509 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:51:39.614201 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: COMMIT
[0m18:51:39.614354 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_events"
[0m18:51:39.614494 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: COMMIT
[0m18:51:39.614846 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:51:39.615909 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_events"
[0m18:51:39.616068 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_events"} */

      drop view if exists "quest_kingdom"."main"."stg_events__dbt_backup" cascade
    
[0m18:51:39.616384 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:51:39.616966 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: Close
[0m18:51:39.617212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f539c1b-eadf-4316-b5ff-1e729e815bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057f1f10>]}
[0m18:51:39.617486 [info ] [Thread-1 (]: 2 of 5 OK created sql view model main.stg_events ............................... [[32mOK[0m in 0.01s]
[0m18:51:39.617726 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_events
[0m18:51:39.617905 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_iap_transactions
[0m18:51:39.618118 [info ] [Thread-1 (]: 3 of 5 START sql view model main.stg_iap_transactions .......................... [RUN]
[0m18:51:39.618300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_events, now model.quest_kingdom.stg_iap_transactions)
[0m18:51:39.618460 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_iap_transactions
[0m18:51:39.619776 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_iap_transactions"
[0m18:51:39.620151 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_iap_transactions
[0m18:51:39.621874 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.stg_iap_transactions"
[0m18:51:39.622447 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_iap_transactions"
[0m18:51:39.622636 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: BEGIN
[0m18:51:39.622790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:51:39.623142 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:51:39.623299 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_iap_transactions"
[0m18:51:39.623455 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_iap_transactions"} */

  
  create view "quest_kingdom"."main"."stg_iap_transactions__dbt_tmp" as (
    select
    -- ids
    transaction_id,
    player_id,
    session_id,
    
    -- timestamps
    transaction_timestamp::timestamp as purchased_at,
    
    -- dimensions
    lower(trim(sku)) as sku,
    lower(trim(platform)) as platform,
    
    -- metrics
    price_usd,
    gems_purchased,
    
    -- derived
    date_trunc('day', transaction_timestamp::timestamp)::date as purchase_date

from "quest_kingdom"."main"."iap_transactions"
  );

[0m18:51:39.623915 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:51:39.625449 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_iap_transactions"
[0m18:51:39.625621 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_iap_transactions"} */
alter view "quest_kingdom"."main"."stg_iap_transactions" rename to "stg_iap_transactions__dbt_backup"
[0m18:51:39.625926 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:51:39.627290 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_iap_transactions"
[0m18:51:39.627452 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_iap_transactions"} */
alter view "quest_kingdom"."main"."stg_iap_transactions__dbt_tmp" rename to "stg_iap_transactions"
[0m18:51:39.627723 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:51:39.628402 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: COMMIT
[0m18:51:39.628557 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_iap_transactions"
[0m18:51:39.628696 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: COMMIT
[0m18:51:39.629082 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:51:39.631007 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_iap_transactions"
[0m18:51:39.631165 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_iap_transactions"} */

      drop view if exists "quest_kingdom"."main"."stg_iap_transactions__dbt_backup" cascade
    
[0m18:51:39.631499 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:51:39.632076 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: Close
[0m18:51:39.632326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f539c1b-eadf-4316-b5ff-1e729e815bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058f5e20>]}
[0m18:51:39.632701 [info ] [Thread-1 (]: 3 of 5 OK created sql view model main.stg_iap_transactions ..................... [[32mOK[0m in 0.01s]
[0m18:51:39.632976 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_iap_transactions
[0m18:51:39.633164 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_players
[0m18:51:39.633396 [info ] [Thread-1 (]: 4 of 5 START sql view model main.stg_players ................................... [RUN]
[0m18:51:39.633610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_iap_transactions, now model.quest_kingdom.stg_players)
[0m18:51:39.633774 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_players
[0m18:51:39.635114 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_players"
[0m18:51:39.635460 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_players
[0m18:51:39.637076 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.stg_players"
[0m18:51:39.637812 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:51:39.638036 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: BEGIN
[0m18:51:39.638192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:51:39.638546 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:51:39.638743 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:51:39.638928 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_players"} */

  
  create view "quest_kingdom"."main"."stg_players__dbt_tmp" as (
    with source as (
    select * from "quest_kingdom"."main"."players"
),

renamed as (
    select
        player_id,
        install_date::date as installed_at,
        --dimensions
        lower(trim(attribution_channel)) as attribution_channel,
        lower(trim(country)) as country,
        lower(trim(device_type)) as device_type,
        lower(trim(player_segment)) as player_segment,
        lower(trim(experiment_variant)) as experiment_variant,
        --booleans
        tutorial_completed,
        --metrics
        lifetime_value as lifetime_value_usd
    from source 
)

select * from renamed
  );

[0m18:51:39.639604 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:51:39.641148 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:51:39.641312 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_players"} */
alter view "quest_kingdom"."main"."stg_players" rename to "stg_players__dbt_backup"
[0m18:51:39.641616 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:51:39.642909 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:51:39.643066 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_players"} */
alter view "quest_kingdom"."main"."stg_players__dbt_tmp" rename to "stg_players"
[0m18:51:39.643350 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:51:39.644023 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: COMMIT
[0m18:51:39.644177 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:51:39.644315 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: COMMIT
[0m18:51:39.644698 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:51:39.645736 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:51:39.645932 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_players"} */

      drop view if exists "quest_kingdom"."main"."stg_players__dbt_backup" cascade
    
[0m18:51:39.646257 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:51:39.646818 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: Close
[0m18:51:39.647060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f539c1b-eadf-4316-b5ff-1e729e815bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058f6030>]}
[0m18:51:39.647338 [info ] [Thread-1 (]: 4 of 5 OK created sql view model main.stg_players .............................. [[32mOK[0m in 0.01s]
[0m18:51:39.647578 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_players
[0m18:51:39.647754 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_sessions
[0m18:51:39.647969 [info ] [Thread-1 (]: 5 of 5 START sql view model main.stg_sessions .................................. [RUN]
[0m18:51:39.648152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_players, now model.quest_kingdom.stg_sessions)
[0m18:51:39.648307 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_sessions
[0m18:51:39.649660 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_sessions"
[0m18:51:39.650268 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_sessions
[0m18:51:39.651744 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.stg_sessions"
[0m18:51:39.652034 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_sessions"
[0m18:51:39.652181 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: BEGIN
[0m18:51:39.652317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:51:39.652595 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:51:39.652738 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_sessions"
[0m18:51:39.652898 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_sessions"} */

  
  create view "quest_kingdom"."main"."stg_sessions__dbt_tmp" as (
    with source as (
    select * from "quest_kingdom"."main"."sessions"
),

renamed as (
    select 
        session_id,
        player_id,
        --timestamps
        session_start::timestamp as session_started_at,
        session_end::timestamp as session_ended_at,

        --metrics
        session_duration_minutes,
        starting_level,
        ending_level,
        levels_gained,

        --derived metrics
        extract(hour from session_start::timestamp) as session_hour,
        extract(dow from session_start::timestamp) as session_day_of_week,
        date_trunc('day', session_start::timestamp)::date as session_date 
    from source
)

select * from renamed
  );

[0m18:51:39.653517 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:51:39.655413 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_sessions"
[0m18:51:39.655615 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_sessions"} */
alter view "quest_kingdom"."main"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m18:51:39.656000 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:51:39.656634 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: COMMIT
[0m18:51:39.656786 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_sessions"
[0m18:51:39.656922 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: COMMIT
[0m18:51:39.657329 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:51:39.658420 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_sessions"
[0m18:51:39.658580 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_sessions"} */

      drop view if exists "quest_kingdom"."main"."stg_sessions__dbt_backup" cascade
    
[0m18:51:39.658845 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:51:39.659438 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: Close
[0m18:51:39.659686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f539c1b-eadf-4316-b5ff-1e729e815bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058cac60>]}
[0m18:51:39.659968 [info ] [Thread-1 (]: 5 of 5 OK created sql view model main.stg_sessions ............................. [[32mOK[0m in 0.01s]
[0m18:51:39.660209 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_sessions
[0m18:51:39.660747 [debug] [MainThread]: Using duckdb connection "master"
[0m18:51:39.660916 [debug] [MainThread]: On master: BEGIN
[0m18:51:39.661048 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:51:39.661309 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:51:39.661441 [debug] [MainThread]: On master: COMMIT
[0m18:51:39.661571 [debug] [MainThread]: Using duckdb connection "master"
[0m18:51:39.661687 [debug] [MainThread]: On master: COMMIT
[0m18:51:39.661883 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:51:39.662009 [debug] [MainThread]: On master: Close
[0m18:51:39.662173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:51:39.662290 [debug] [MainThread]: Connection 'model.quest_kingdom.stg_sessions' was properly closed.
[0m18:51:39.662452 [info ] [MainThread]: 
[0m18:51:39.662599 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m18:51:39.663082 [debug] [MainThread]: Command end result
[0m18:51:39.676402 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/manifest.json
[0m18:51:39.677394 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/semantic_manifest.json
[0m18:51:39.680330 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/run_results.json
[0m18:51:39.680477 [info ] [MainThread]: 
[0m18:51:39.680643 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:51:39.680774 [info ] [MainThread]: 
[0m18:51:39.680919 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m18:51:39.682292 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8678769, "process_in_blocks": "0", "process_kernel_time": 0.182497, "process_mem_max_rss": "148733952", "process_out_blocks": "0", "process_user_time": 1.307263}
[0m18:51:39.682501 [debug] [MainThread]: Command `dbt run` succeeded at 18:51:39.682463 after 0.87 seconds
[0m18:51:39.682667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f27590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f24710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043df6e0>]}
[0m18:51:39.682824 [debug] [MainThread]: Flushing usage events
[0m18:51:39.820149 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:52:23.095080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105394bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c2b5a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c2b55e0>]}


============================== 18:52:23.098683 | f128a8b1-73ad-45c1-ba1c-1e817ddfffc7 ==============================
[0m18:52:23.098683 [info ] [MainThread]: Running with dbt=1.11.4
[0m18:52:23.099014 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'version_check': 'True', 'write_json': 'True', 'introspect': 'True', 'log_path': '/Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/logs', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt test --select staging', 'cache_selected_only': 'False', 'empty': 'None', 'log_cache_events': 'False', 'target_path': 'None', 'printer_width': '80', 'profiles_dir': '/Users/hazeldonaldson/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'log_format': 'default', 'quiet': 'False', 'partial_parse': 'True', 'no_print': 'None', 'use_colors': 'True', 'indirect_selection': 'eager', 'static_parser': 'True'}
[0m18:52:23.265796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f128a8b1-73ad-45c1-ba1c-1e817ddfffc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a196e10>]}
[0m18:52:23.294330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f128a8b1-73ad-45c1-ba1c-1e817ddfffc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a196e10>]}
[0m18:52:23.295875 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:52:23.358177 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m18:52:23.432472 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:52:23.432719 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:52:23.432855 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:52:23.435938 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.core
- models.monetization
- models.product
- models.retention
- models.staging
- models.marts
- models.question_kingdom
[0m18:52:23.455582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f128a8b1-73ad-45c1-ba1c-1e817ddfffc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d288d10>]}
[0m18:52:23.497450 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/manifest.json
[0m18:52:23.498720 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/semantic_manifest.json
[0m18:52:23.517559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f128a8b1-73ad-45c1-ba1c-1e817ddfffc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c776480>]}
[0m18:52:23.517857 [info ] [MainThread]: Found 7 models, 23 data tests, 5 sources, 472 macros
[0m18:52:23.518030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f128a8b1-73ad-45c1-ba1c-1e817ddfffc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c5fadb0>]}
[0m18:52:23.519376 [info ] [MainThread]: 
[0m18:52:23.519579 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:52:23.519730 [info ] [MainThread]: 
[0m18:52:23.519985 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:52:23.522466 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_quest_kingdom_main'
[0m18:52:23.550843 [debug] [ThreadPool]: Using duckdb connection "list_quest_kingdom_main"
[0m18:52:23.551074 [debug] [ThreadPool]: On list_quest_kingdom_main: BEGIN
[0m18:52:23.551217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:23.563270 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m18:52:23.563522 [debug] [ThreadPool]: Using duckdb connection "list_quest_kingdom_main"
[0m18:52:23.563679 [debug] [ThreadPool]: On list_quest_kingdom_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "list_quest_kingdom_main"} */
select
      'quest_kingdom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'quest_kingdom'
  
[0m18:52:23.579384 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m18:52:23.580311 [debug] [ThreadPool]: On list_quest_kingdom_main: ROLLBACK
[0m18:52:23.581307 [debug] [ThreadPool]: Failed to rollback 'list_quest_kingdom_main'
[0m18:52:23.581480 [debug] [ThreadPool]: On list_quest_kingdom_main: Close
[0m18:52:23.582412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f128a8b1-73ad-45c1-ba1c-1e817ddfffc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c751e80>]}
[0m18:52:23.582642 [debug] [MainThread]: Using duckdb connection "master"
[0m18:52:23.582774 [debug] [MainThread]: On master: BEGIN
[0m18:52:23.582893 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:52:23.583163 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:52:23.583297 [debug] [MainThread]: On master: COMMIT
[0m18:52:23.583422 [debug] [MainThread]: Using duckdb connection "master"
[0m18:52:23.583535 [debug] [MainThread]: On master: COMMIT
[0m18:52:23.583726 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:52:23.583851 [debug] [MainThread]: On master: Close
[0m18:52:23.585394 [debug] [Thread-1 (]: Began running node test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36
[0m18:52:23.585590 [info ] [Thread-1 (]: 1 of 23 START test accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated  [RUN]
[0m18:52:23.585789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_quest_kingdom_main, now test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36)
[0m18:52:23.585956 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36
[0m18:52:23.594470 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36"
[0m18:52:23.595207 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36
[0m18:52:23.603976 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36"
[0m18:52:23.604464 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36"
[0m18:52:23.604645 [debug] [Thread-1 (]: On test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36: BEGIN
[0m18:52:23.604799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:23.605161 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.605323 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36"
[0m18:52:23.605485 [debug] [Thread-1 (]: On test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        event_name as value_field,
        count(*) as n_records

    from "quest_kingdom"."main"."stg_events"
    group by event_name

)

select *
from all_values
where value_field not in (
    'tutorial_completed','level_completed','boss_defeated'
)



  
  
      
    ) dbt_internal_test
[0m18:52:23.610048 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:52:23.612082 [debug] [Thread-1 (]: On test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36: ROLLBACK
[0m18:52:23.612561 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36'
[0m18:52:23.612737 [debug] [Thread-1 (]: On test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36: Close
[0m18:52:23.613014 [info ] [Thread-1 (]: 1 of 23 PASS accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated  [[32mPASS[0m in 0.03s]
[0m18:52:23.613265 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36
[0m18:52:23.613443 [debug] [Thread-1 (]: Began running node test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd
[0m18:52:23.613635 [info ] [Thread-1 (]: 2 of 23 START test accepted_values_stg_players_device_type__ios__android ....... [RUN]
[0m18:52:23.613821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36, now test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd)
[0m18:52:23.613984 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd
[0m18:52:23.616451 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd"
[0m18:52:23.616823 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd
[0m18:52:23.617945 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd"
[0m18:52:23.618260 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd"
[0m18:52:23.618420 [debug] [Thread-1 (]: On test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd: BEGIN
[0m18:52:23.618562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:23.618903 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.619059 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd"
[0m18:52:23.619223 [debug] [Thread-1 (]: On test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        device_type as value_field,
        count(*) as n_records

    from "quest_kingdom"."main"."stg_players"
    group by device_type

)

select *
from all_values
where value_field not in (
    'ios','android'
)



  
  
      
    ) dbt_internal_test
[0m18:52:23.620756 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:23.621777 [debug] [Thread-1 (]: On test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd: ROLLBACK
[0m18:52:23.622320 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd'
[0m18:52:23.622494 [debug] [Thread-1 (]: On test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd: Close
[0m18:52:23.622817 [info ] [Thread-1 (]: 2 of 23 PASS accepted_values_stg_players_device_type__ios__android ............. [[32mPASS[0m in 0.01s]
[0m18:52:23.623085 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd
[0m18:52:23.623267 [debug] [Thread-1 (]: Began running node test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a
[0m18:52:23.623454 [info ] [Thread-1 (]: 3 of 23 START test accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer  [RUN]
[0m18:52:23.623641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd, now test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a)
[0m18:52:23.623802 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a
[0m18:52:23.626874 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a"
[0m18:52:23.627277 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a
[0m18:52:23.629223 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a"
[0m18:52:23.629643 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a"
[0m18:52:23.629823 [debug] [Thread-1 (]: On test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a: BEGIN
[0m18:52:23.629979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:23.630381 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.630588 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a"
[0m18:52:23.630779 [debug] [Thread-1 (]: On test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        player_segment as value_field,
        count(*) as n_records

    from "quest_kingdom"."main"."stg_players"
    group by player_segment

)

select *
from all_values
where value_field not in (
    'whale','dolphin','minnow','non_payer'
)



  
  
      
    ) dbt_internal_test
[0m18:52:23.632060 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:23.632819 [debug] [Thread-1 (]: On test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a: ROLLBACK
[0m18:52:23.633294 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a'
[0m18:52:23.633452 [debug] [Thread-1 (]: On test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a: Close
[0m18:52:23.633721 [info ] [Thread-1 (]: 3 of 23 PASS accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer  [[32mPASS[0m in 0.01s]
[0m18:52:23.633971 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a
[0m18:52:23.634146 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c
[0m18:52:23.634316 [info ] [Thread-1 (]: 4 of 23 START test not_null_stg_ad_impressions_ad_id ........................... [RUN]
[0m18:52:23.634496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a, now test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c)
[0m18:52:23.634652 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c
[0m18:52:23.637903 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c"
[0m18:52:23.638624 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c
[0m18:52:23.639972 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c"
[0m18:52:23.640428 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c"
[0m18:52:23.640618 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c: BEGIN
[0m18:52:23.640771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:23.641136 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.641293 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c"
[0m18:52:23.641451 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ad_id
from "quest_kingdom"."main"."stg_ad_impressions"
where ad_id is null



  
  
      
    ) dbt_internal_test
[0m18:52:23.642078 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.642832 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c: ROLLBACK
[0m18:52:23.643283 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c'
[0m18:52:23.643434 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c: Close
[0m18:52:23.643683 [info ] [Thread-1 (]: 4 of 23 PASS not_null_stg_ad_impressions_ad_id ................................. [[32mPASS[0m in 0.01s]
[0m18:52:23.643924 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c
[0m18:52:23.644099 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19
[0m18:52:23.644293 [info ] [Thread-1 (]: 5 of 23 START test not_null_stg_ad_impressions_player_id ....................... [RUN]
[0m18:52:23.644516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c, now test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19)
[0m18:52:23.644692 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19
[0m18:52:23.646614 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19"
[0m18:52:23.646988 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19
[0m18:52:23.648087 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19"
[0m18:52:23.648388 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19"
[0m18:52:23.648542 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19: BEGIN
[0m18:52:23.648679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:23.648978 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.649126 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19"
[0m18:52:23.649274 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select player_id
from "quest_kingdom"."main"."stg_ad_impressions"
where player_id is null



  
  
      
    ) dbt_internal_test
[0m18:52:23.649831 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.650578 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19: ROLLBACK
[0m18:52:23.651045 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19'
[0m18:52:23.651203 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19: Close
[0m18:52:23.651449 [info ] [Thread-1 (]: 5 of 23 PASS not_null_stg_ad_impressions_player_id ............................. [[32mPASS[0m in 0.01s]
[0m18:52:23.651685 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19
[0m18:52:23.651860 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_events_event_id.715b3f7012
[0m18:52:23.652039 [info ] [Thread-1 (]: 6 of 23 START test not_null_stg_events_event_id ................................ [RUN]
[0m18:52:23.652223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19, now test.quest_kingdom.not_null_stg_events_event_id.715b3f7012)
[0m18:52:23.652384 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_events_event_id.715b3f7012
[0m18:52:23.654424 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_events_event_id.715b3f7012"
[0m18:52:23.655188 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_events_event_id.715b3f7012
[0m18:52:23.656682 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.not_null_stg_events_event_id.715b3f7012"
[0m18:52:23.657166 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_events_event_id.715b3f7012"
[0m18:52:23.657336 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_events_event_id.715b3f7012: BEGIN
[0m18:52:23.657478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:23.657825 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.657977 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_events_event_id.715b3f7012"
[0m18:52:23.658184 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_events_event_id.715b3f7012: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.not_null_stg_events_event_id.715b3f7012"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "quest_kingdom"."main"."stg_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m18:52:23.658826 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.659596 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_events_event_id.715b3f7012: ROLLBACK
[0m18:52:23.660048 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.not_null_stg_events_event_id.715b3f7012'
[0m18:52:23.660199 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_events_event_id.715b3f7012: Close
[0m18:52:23.660455 [info ] [Thread-1 (]: 6 of 23 PASS not_null_stg_events_event_id ...................................... [[32mPASS[0m in 0.01s]
[0m18:52:23.660690 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_events_event_id.715b3f7012
[0m18:52:23.660863 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3
[0m18:52:23.661049 [info ] [Thread-1 (]: 7 of 23 START test not_null_stg_events_event_name .............................. [RUN]
[0m18:52:23.661251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_events_event_id.715b3f7012, now test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3)
[0m18:52:23.661409 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3
[0m18:52:23.663379 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3"
[0m18:52:23.663776 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3
[0m18:52:23.664884 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3"
[0m18:52:23.665191 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3"
[0m18:52:23.665349 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3: BEGIN
[0m18:52:23.665490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:23.665799 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.665944 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3"
[0m18:52:23.666096 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_name
from "quest_kingdom"."main"."stg_events"
where event_name is null



  
  
      
    ) dbt_internal_test
[0m18:52:23.666996 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:23.667747 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3: ROLLBACK
[0m18:52:23.668197 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3'
[0m18:52:23.668357 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3: Close
[0m18:52:23.668661 [info ] [Thread-1 (]: 7 of 23 PASS not_null_stg_events_event_name .................................... [[32mPASS[0m in 0.01s]
[0m18:52:23.668912 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3
[0m18:52:23.669087 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5
[0m18:52:23.669269 [info ] [Thread-1 (]: 8 of 23 START test not_null_stg_events_player_id ............................... [RUN]
[0m18:52:23.669448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3, now test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5)
[0m18:52:23.669608 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5
[0m18:52:23.671854 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5"
[0m18:52:23.672404 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5
[0m18:52:23.673657 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5"
[0m18:52:23.674029 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5"
[0m18:52:23.674195 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5: BEGIN
[0m18:52:23.674336 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:23.674698 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.674848 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5"
[0m18:52:23.675007 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select player_id
from "quest_kingdom"."main"."stg_events"
where player_id is null



  
  
      
    ) dbt_internal_test
[0m18:52:23.675570 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.676368 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5: ROLLBACK
[0m18:52:23.676820 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5'
[0m18:52:23.676963 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5: Close
[0m18:52:23.677232 [info ] [Thread-1 (]: 8 of 23 PASS not_null_stg_events_player_id ..................................... [[32mPASS[0m in 0.01s]
[0m18:52:23.677478 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5
[0m18:52:23.677652 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d
[0m18:52:23.677808 [info ] [Thread-1 (]: 9 of 23 START test not_null_stg_iap_transactions_player_id ..................... [RUN]
[0m18:52:23.678061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5, now test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d)
[0m18:52:23.678237 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d
[0m18:52:23.681228 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d"
[0m18:52:23.681637 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d
[0m18:52:23.715828 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d"
[0m18:52:23.716490 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d"
[0m18:52:23.716690 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d: BEGIN
[0m18:52:23.716845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:23.717200 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.717361 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d"
[0m18:52:23.717519 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select player_id
from "quest_kingdom"."main"."stg_iap_transactions"
where player_id is null



  
  
      
    ) dbt_internal_test
[0m18:52:23.718162 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.718889 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d: ROLLBACK
[0m18:52:23.719330 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d'
[0m18:52:23.719476 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d: Close
[0m18:52:23.719722 [info ] [Thread-1 (]: 9 of 23 PASS not_null_stg_iap_transactions_player_id ........................... [[32mPASS[0m in 0.04s]
[0m18:52:23.719956 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d
[0m18:52:23.720127 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079
[0m18:52:23.720301 [info ] [Thread-1 (]: 10 of 23 START test not_null_stg_iap_transactions_price_usd .................... [RUN]
[0m18:52:23.720472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d, now test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079)
[0m18:52:23.720623 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079
[0m18:52:23.722697 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079"
[0m18:52:23.723117 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079
[0m18:52:23.724225 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079"
[0m18:52:23.724550 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079"
[0m18:52:23.724709 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079: BEGIN
[0m18:52:23.724854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:23.725182 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.725334 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079"
[0m18:52:23.725491 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price_usd
from "quest_kingdom"."main"."stg_iap_transactions"
where price_usd is null



  
  
      
    ) dbt_internal_test
[0m18:52:23.726079 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.726835 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079: ROLLBACK
[0m18:52:23.727300 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079'
[0m18:52:23.727480 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079: Close
[0m18:52:23.727842 [info ] [Thread-1 (]: 10 of 23 PASS not_null_stg_iap_transactions_price_usd .......................... [[32mPASS[0m in 0.01s]
[0m18:52:23.728107 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079
[0m18:52:23.728369 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645
[0m18:52:23.728574 [info ] [Thread-1 (]: 11 of 23 START test not_null_stg_iap_transactions_transaction_id ............... [RUN]
[0m18:52:23.728787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079, now test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645)
[0m18:52:23.728959 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645
[0m18:52:23.730983 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645"
[0m18:52:23.731376 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645
[0m18:52:23.732469 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645"
[0m18:52:23.732775 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645"
[0m18:52:23.732924 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645: BEGIN
[0m18:52:23.733063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:23.733409 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.733556 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645"
[0m18:52:23.733712 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "quest_kingdom"."main"."stg_iap_transactions"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m18:52:23.734410 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:23.735154 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645: ROLLBACK
[0m18:52:23.735623 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645'
[0m18:52:23.735778 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645: Close
[0m18:52:23.736027 [info ] [Thread-1 (]: 11 of 23 PASS not_null_stg_iap_transactions_transaction_id ..................... [[32mPASS[0m in 0.01s]
[0m18:52:23.736267 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645
[0m18:52:23.736438 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb
[0m18:52:23.736621 [info ] [Thread-1 (]: 12 of 23 START test not_null_stg_players_installed_at .......................... [RUN]
[0m18:52:23.736827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645, now test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb)
[0m18:52:23.736989 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb
[0m18:52:23.739547 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb"
[0m18:52:23.740051 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb
[0m18:52:23.741422 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb"
[0m18:52:23.741860 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb"
[0m18:52:23.742020 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb: BEGIN
[0m18:52:23.742164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:23.742530 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.742679 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb"
[0m18:52:23.742830 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select installed_at
from "quest_kingdom"."main"."stg_players"
where installed_at is null



  
  
      
    ) dbt_internal_test
[0m18:52:23.743737 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:23.744578 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb: ROLLBACK
[0m18:52:23.745084 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb'
[0m18:52:23.745254 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb: Close
[0m18:52:23.745544 [info ] [Thread-1 (]: 12 of 23 PASS not_null_stg_players_installed_at ................................ [[32mPASS[0m in 0.01s]
[0m18:52:23.745794 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb
[0m18:52:23.745970 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b
[0m18:52:23.746158 [info ] [Thread-1 (]: 13 of 23 START test not_null_stg_players_player_id ............................. [RUN]
[0m18:52:23.746342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb, now test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b)
[0m18:52:23.746497 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b
[0m18:52:23.748662 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b"
[0m18:52:23.749101 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b
[0m18:52:23.750288 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b"
[0m18:52:23.750649 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b"
[0m18:52:23.750810 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b: BEGIN
[0m18:52:23.750954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:23.751359 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.751518 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b"
[0m18:52:23.751673 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select player_id
from "quest_kingdom"."main"."stg_players"
where player_id is null



  
  
      
    ) dbt_internal_test
[0m18:52:23.752684 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:23.753509 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b: ROLLBACK
[0m18:52:23.754071 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b'
[0m18:52:23.754261 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b: Close
[0m18:52:23.754586 [info ] [Thread-1 (]: 13 of 23 PASS not_null_stg_players_player_id ................................... [[32mPASS[0m in 0.01s]
[0m18:52:23.755142 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b
[0m18:52:23.755417 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29
[0m18:52:23.755655 [info ] [Thread-1 (]: 14 of 23 START test not_null_stg_sessions_player_id ............................ [RUN]
[0m18:52:23.755894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b, now test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29)
[0m18:52:23.756065 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29
[0m18:52:23.758262 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29"
[0m18:52:23.758734 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29
[0m18:52:23.761128 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29"
[0m18:52:23.761639 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29"
[0m18:52:23.761853 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29: BEGIN
[0m18:52:23.762022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:23.762408 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.762565 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29"
[0m18:52:23.762725 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select player_id
from "quest_kingdom"."main"."stg_sessions"
where player_id is null



  
  
      
    ) dbt_internal_test
[0m18:52:23.763615 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:23.764459 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29: ROLLBACK
[0m18:52:23.764953 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29'
[0m18:52:23.765120 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29: Close
[0m18:52:23.765819 [info ] [Thread-1 (]: 14 of 23 PASS not_null_stg_sessions_player_id .................................. [[32mPASS[0m in 0.01s]
[0m18:52:23.766228 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29
[0m18:52:23.767022 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d
[0m18:52:23.767305 [info ] [Thread-1 (]: 15 of 23 START test not_null_stg_sessions_session_id ........................... [RUN]
[0m18:52:23.767582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29, now test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d)
[0m18:52:23.767789 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d
[0m18:52:23.770155 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d"
[0m18:52:23.770628 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d
[0m18:52:23.772988 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d"
[0m18:52:23.773589 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d"
[0m18:52:23.773769 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m18:52:23.773927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:23.774304 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.774458 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d"
[0m18:52:23.774616 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_id
from "quest_kingdom"."main"."stg_sessions"
where session_id is null



  
  
      
    ) dbt_internal_test
[0m18:52:23.775480 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:23.776327 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m18:52:23.776828 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d'
[0m18:52:23.777001 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d: Close
[0m18:52:23.777300 [info ] [Thread-1 (]: 15 of 23 PASS not_null_stg_sessions_session_id ................................. [[32mPASS[0m in 0.01s]
[0m18:52:23.777556 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d
[0m18:52:23.777733 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09
[0m18:52:23.777923 [info ] [Thread-1 (]: 16 of 23 START test not_null_stg_sessions_session_started_at ................... [RUN]
[0m18:52:23.778109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d, now test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09)
[0m18:52:23.778266 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09
[0m18:52:23.780479 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09"
[0m18:52:23.780974 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09
[0m18:52:23.782202 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09"
[0m18:52:23.782550 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09"
[0m18:52:23.782712 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09: BEGIN
[0m18:52:23.782852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:23.783211 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.783361 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09"
[0m18:52:23.783517 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_started_at
from "quest_kingdom"."main"."stg_sessions"
where session_started_at is null



  
  
      
    ) dbt_internal_test
[0m18:52:23.784452 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:23.785274 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09: ROLLBACK
[0m18:52:23.785756 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09'
[0m18:52:23.785914 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09: Close
[0m18:52:23.786180 [info ] [Thread-1 (]: 16 of 23 PASS not_null_stg_sessions_session_started_at ......................... [[32mPASS[0m in 0.01s]
[0m18:52:23.786423 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09
[0m18:52:23.786605 [debug] [Thread-1 (]: Began running node test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963
[0m18:52:23.786789 [info ] [Thread-1 (]: 17 of 23 START test relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_  [RUN]
[0m18:52:23.786969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09, now test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963)
[0m18:52:23.787129 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963
[0m18:52:23.791604 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963"
[0m18:52:23.792175 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963
[0m18:52:23.793485 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963"
[0m18:52:23.793892 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963"
[0m18:52:23.794062 [debug] [Thread-1 (]: On test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963: BEGIN
[0m18:52:23.794214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:23.794574 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.794727 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963"
[0m18:52:23.794894 [debug] [Thread-1 (]: On test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select player_id as from_field
    from "quest_kingdom"."main"."stg_iap_transactions"
    where player_id is not null
),

parent as (
    select player_id as to_field
    from "quest_kingdom"."main"."stg_players"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m18:52:23.800090 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:52:23.800940 [debug] [Thread-1 (]: On test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963: ROLLBACK
[0m18:52:23.801407 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963'
[0m18:52:23.801574 [debug] [Thread-1 (]: On test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963: Close
[0m18:52:23.801850 [info ] [Thread-1 (]: 17 of 23 PASS relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_  [[32mPASS[0m in 0.01s]
[0m18:52:23.802097 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963
[0m18:52:23.802276 [debug] [Thread-1 (]: Began running node test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee
[0m18:52:23.802462 [info ] [Thread-1 (]: 18 of 23 START test relationships_stg_sessions_player_id__player_id__ref_stg_players_  [RUN]
[0m18:52:23.802644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963, now test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee)
[0m18:52:23.802805 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee
[0m18:52:23.805642 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee"
[0m18:52:23.806128 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee
[0m18:52:23.807359 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee"
[0m18:52:23.807728 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee"
[0m18:52:23.807916 [debug] [Thread-1 (]: On test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee: BEGIN
[0m18:52:23.808070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:23.808508 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.808660 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee"
[0m18:52:23.808826 [debug] [Thread-1 (]: On test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select player_id as from_field
    from "quest_kingdom"."main"."stg_sessions"
    where player_id is not null
),

parent as (
    select player_id as to_field
    from "quest_kingdom"."main"."stg_players"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m18:52:23.811647 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:52:23.812473 [debug] [Thread-1 (]: On test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee: ROLLBACK
[0m18:52:23.812956 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee'
[0m18:52:23.813131 [debug] [Thread-1 (]: On test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee: Close
[0m18:52:23.813544 [info ] [Thread-1 (]: 18 of 23 PASS relationships_stg_sessions_player_id__player_id__ref_stg_players_  [[32mPASS[0m in 0.01s]
[0m18:52:23.813817 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee
[0m18:52:23.813994 [debug] [Thread-1 (]: Began running node test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef
[0m18:52:23.814183 [info ] [Thread-1 (]: 19 of 23 START test unique_stg_ad_impressions_ad_id ............................ [RUN]
[0m18:52:23.814396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee, now test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef)
[0m18:52:23.814564 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef
[0m18:52:23.817610 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef"
[0m18:52:23.818001 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef
[0m18:52:23.820136 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef"
[0m18:52:23.820636 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef"
[0m18:52:23.820821 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef: BEGIN
[0m18:52:23.821018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:23.821512 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.821715 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef"
[0m18:52:23.821887 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    ad_id as unique_field,
    count(*) as n_records

from "quest_kingdom"."main"."stg_ad_impressions"
where ad_id is not null
group by ad_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:52:23.826823 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:52:23.827708 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef: ROLLBACK
[0m18:52:23.828181 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef'
[0m18:52:23.828338 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef: Close
[0m18:52:23.828610 [info ] [Thread-1 (]: 19 of 23 PASS unique_stg_ad_impressions_ad_id .................................. [[32mPASS[0m in 0.01s]
[0m18:52:23.828853 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef
[0m18:52:23.829028 [debug] [Thread-1 (]: Began running node test.quest_kingdom.unique_stg_events_event_id.66ebb17438
[0m18:52:23.829228 [info ] [Thread-1 (]: 20 of 23 START test unique_stg_events_event_id ................................. [RUN]
[0m18:52:23.829453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef, now test.quest_kingdom.unique_stg_events_event_id.66ebb17438)
[0m18:52:23.829624 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.unique_stg_events_event_id.66ebb17438
[0m18:52:23.831688 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.unique_stg_events_event_id.66ebb17438"
[0m18:52:23.832094 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.unique_stg_events_event_id.66ebb17438
[0m18:52:23.833273 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.unique_stg_events_event_id.66ebb17438"
[0m18:52:23.833638 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.unique_stg_events_event_id.66ebb17438"
[0m18:52:23.833802 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_events_event_id.66ebb17438: BEGIN
[0m18:52:23.833944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:23.834286 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.834433 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.unique_stg_events_event_id.66ebb17438"
[0m18:52:23.834591 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_events_event_id.66ebb17438: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.unique_stg_events_event_id.66ebb17438"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "quest_kingdom"."main"."stg_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:52:23.836934 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:52:23.837811 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_events_event_id.66ebb17438: ROLLBACK
[0m18:52:23.838545 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.unique_stg_events_event_id.66ebb17438'
[0m18:52:23.838783 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_events_event_id.66ebb17438: Close
[0m18:52:23.839110 [info ] [Thread-1 (]: 20 of 23 PASS unique_stg_events_event_id ....................................... [[32mPASS[0m in 0.01s]
[0m18:52:23.839371 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.unique_stg_events_event_id.66ebb17438
[0m18:52:23.839549 [debug] [Thread-1 (]: Began running node test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069
[0m18:52:23.839731 [info ] [Thread-1 (]: 21 of 23 START test unique_stg_iap_transactions_transaction_id ................. [RUN]
[0m18:52:23.839915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.unique_stg_events_event_id.66ebb17438, now test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069)
[0m18:52:23.840071 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069
[0m18:52:23.842141 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069"
[0m18:52:23.842572 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069
[0m18:52:23.843678 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069"
[0m18:52:23.843984 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069"
[0m18:52:23.844138 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069: BEGIN
[0m18:52:23.844279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:23.844617 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.844762 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069"
[0m18:52:23.844919 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "quest_kingdom"."main"."stg_iap_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:52:23.846552 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:52:23.847515 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069: ROLLBACK
[0m18:52:23.848001 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069'
[0m18:52:23.848161 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069: Close
[0m18:52:23.848449 [info ] [Thread-1 (]: 21 of 23 PASS unique_stg_iap_transactions_transaction_id ....................... [[32mPASS[0m in 0.01s]
[0m18:52:23.848702 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069
[0m18:52:23.848881 [debug] [Thread-1 (]: Began running node test.quest_kingdom.unique_stg_players_player_id.a3d551d71d
[0m18:52:23.849068 [info ] [Thread-1 (]: 22 of 23 START test unique_stg_players_player_id ............................... [RUN]
[0m18:52:23.849259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069, now test.quest_kingdom.unique_stg_players_player_id.a3d551d71d)
[0m18:52:23.849417 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.unique_stg_players_player_id.a3d551d71d
[0m18:52:23.851448 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.unique_stg_players_player_id.a3d551d71d"
[0m18:52:23.851859 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.unique_stg_players_player_id.a3d551d71d
[0m18:52:23.852986 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.unique_stg_players_player_id.a3d551d71d"
[0m18:52:23.853313 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.unique_stg_players_player_id.a3d551d71d"
[0m18:52:23.853471 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_players_player_id.a3d551d71d: BEGIN
[0m18:52:23.853619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:23.853997 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.854189 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.unique_stg_players_player_id.a3d551d71d"
[0m18:52:23.854387 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_players_player_id.a3d551d71d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.unique_stg_players_player_id.a3d551d71d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    player_id as unique_field,
    count(*) as n_records

from "quest_kingdom"."main"."stg_players"
where player_id is not null
group by player_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:52:23.856402 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:52:23.857408 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_players_player_id.a3d551d71d: ROLLBACK
[0m18:52:23.857874 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.unique_stg_players_player_id.a3d551d71d'
[0m18:52:23.858026 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_players_player_id.a3d551d71d: Close
[0m18:52:23.858292 [info ] [Thread-1 (]: 22 of 23 PASS unique_stg_players_player_id ..................................... [[32mPASS[0m in 0.01s]
[0m18:52:23.858534 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.unique_stg_players_player_id.a3d551d71d
[0m18:52:23.858706 [debug] [Thread-1 (]: Began running node test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03
[0m18:52:23.858903 [info ] [Thread-1 (]: 23 of 23 START test unique_stg_sessions_session_id ............................. [RUN]
[0m18:52:23.859115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.unique_stg_players_player_id.a3d551d71d, now test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03)
[0m18:52:23.859276 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03
[0m18:52:23.861322 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03"
[0m18:52:23.861744 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03
[0m18:52:23.862941 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03"
[0m18:52:23.863278 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03"
[0m18:52:23.863442 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m18:52:23.863593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:52:23.863958 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:52:23.864109 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03"
[0m18:52:23.864369 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "quest_kingdom"."main"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:52:23.869215 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:52:23.870122 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m18:52:23.870597 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03'
[0m18:52:23.870752 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03: Close
[0m18:52:23.871109 [info ] [Thread-1 (]: 23 of 23 PASS unique_stg_sessions_session_id ................................... [[32mPASS[0m in 0.01s]
[0m18:52:23.871458 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03
[0m18:52:23.872206 [debug] [MainThread]: Using duckdb connection "master"
[0m18:52:23.872371 [debug] [MainThread]: On master: BEGIN
[0m18:52:23.872497 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:52:23.872827 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:52:23.872958 [debug] [MainThread]: On master: COMMIT
[0m18:52:23.873083 [debug] [MainThread]: Using duckdb connection "master"
[0m18:52:23.873200 [debug] [MainThread]: On master: COMMIT
[0m18:52:23.873394 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:52:23.873520 [debug] [MainThread]: On master: Close
[0m18:52:23.873682 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:52:23.873799 [debug] [MainThread]: Connection 'test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03' was properly closed.
[0m18:52:23.873938 [info ] [MainThread]: 
[0m18:52:23.874081 [info ] [MainThread]: Finished running 23 data tests in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m18:52:23.875410 [debug] [MainThread]: Command end result
[0m18:52:23.889397 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/manifest.json
[0m18:52:23.890472 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/semantic_manifest.json
[0m18:52:23.893931 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/run_results.json
[0m18:52:23.894102 [info ] [MainThread]: 
[0m18:52:23.894278 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:52:23.894421 [info ] [MainThread]: 
[0m18:52:23.894566 [info ] [MainThread]: Done. PASS=23 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=23
[0m18:52:23.895963 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.83965135, "process_in_blocks": "0", "process_kernel_time": 0.207982, "process_mem_max_rss": "155631616", "process_out_blocks": "0", "process_user_time": 1.286883}
[0m18:52:23.896192 [debug] [MainThread]: Command `dbt test` succeeded at 18:52:23.896153 after 0.84 seconds
[0m18:52:23.896363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c357560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d663ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11daadb80>]}
[0m18:52:23.896527 [debug] [MainThread]: Flushing usage events
[0m18:52:24.008663 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:52:31.893119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105209850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb5cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb5a90>]}


============================== 18:52:31.896119 | 27cf6eb4-6a37-4d90-8082-ff4a7cfcd879 ==============================
[0m18:52:31.896119 [info ] [MainThread]: Running with dbt=1.11.4
[0m18:52:31.896428 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'write_json': 'True', 'invocation_command': 'dbt docs generate', 'empty': 'None', 'profiles_dir': '/Users/hazeldonaldson/.dbt', 'static_parser': 'True', 'printer_width': '80', 'log_path': '/Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/logs', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'quiet': 'False', 'log_format': 'default', 'warn_error': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'introspect': 'True', 'log_cache_events': 'False'}
[0m18:52:32.002192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27cf6eb4-6a37-4d90-8082-ff4a7cfcd879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee01d0>]}
[0m18:52:32.030103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27cf6eb4-6a37-4d90-8082-ff4a7cfcd879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105294e60>]}
[0m18:52:32.032200 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:52:32.080953 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m18:52:32.144134 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:52:32.144388 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:52:32.144534 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:52:32.147630 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.product
- models.monetization
- models.retention
- models.staging
- models.marts
- models.core
- models.question_kingdom
[0m18:52:32.167131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27cf6eb4-6a37-4d90-8082-ff4a7cfcd879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e8f710>]}
[0m18:52:32.180233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27cf6eb4-6a37-4d90-8082-ff4a7cfcd879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e4fdd0>]}
[0m18:52:32.180522 [info ] [MainThread]: Found 7 models, 23 data tests, 5 sources, 472 macros
[0m18:52:32.180695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27cf6eb4-6a37-4d90-8082-ff4a7cfcd879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc2f90>]}
[0m18:52:32.181987 [info ] [MainThread]: 
[0m18:52:32.182175 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:52:32.182316 [info ] [MainThread]: 
[0m18:52:32.182552 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:52:32.184765 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_quest_kingdom_main'
[0m18:52:32.210313 [debug] [ThreadPool]: Using duckdb connection "list_quest_kingdom_main"
[0m18:52:32.210545 [debug] [ThreadPool]: On list_quest_kingdom_main: BEGIN
[0m18:52:32.210686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:32.218820 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:52:32.219026 [debug] [ThreadPool]: Using duckdb connection "list_quest_kingdom_main"
[0m18:52:32.219177 [debug] [ThreadPool]: On list_quest_kingdom_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "list_quest_kingdom_main"} */
select
      'quest_kingdom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'quest_kingdom'
  
[0m18:52:32.226706 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m18:52:32.227539 [debug] [ThreadPool]: On list_quest_kingdom_main: ROLLBACK
[0m18:52:32.228531 [debug] [ThreadPool]: Failed to rollback 'list_quest_kingdom_main'
[0m18:52:32.228701 [debug] [ThreadPool]: On list_quest_kingdom_main: Close
[0m18:52:32.229575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27cf6eb4-6a37-4d90-8082-ff4a7cfcd879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e1e900>]}
[0m18:52:32.230897 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_ad_impressions
[0m18:52:32.231100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_quest_kingdom_main, now model.quest_kingdom.stg_ad_impressions)
[0m18:52:32.231260 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_ad_impressions
[0m18:52:32.234942 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_ad_impressions"
[0m18:52:32.235328 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_ad_impressions
[0m18:52:32.235633 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_ad_impressions
[0m18:52:32.235801 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_events
[0m18:52:32.235984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_ad_impressions, now model.quest_kingdom.stg_events)
[0m18:52:32.236149 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_events
[0m18:52:32.238188 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_events"
[0m18:52:32.238625 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_events
[0m18:52:32.238960 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_events
[0m18:52:32.239138 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_iap_transactions
[0m18:52:32.239381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_events, now model.quest_kingdom.stg_iap_transactions)
[0m18:52:32.239572 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_iap_transactions
[0m18:52:32.240866 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_iap_transactions"
[0m18:52:32.241175 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_iap_transactions
[0m18:52:32.241454 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_iap_transactions
[0m18:52:32.241616 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_players
[0m18:52:32.241790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_iap_transactions, now model.quest_kingdom.stg_players)
[0m18:52:32.241960 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_players
[0m18:52:32.243189 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_players"
[0m18:52:32.243479 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_players
[0m18:52:32.243746 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_players
[0m18:52:32.243906 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_sessions
[0m18:52:32.244074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_players, now model.quest_kingdom.stg_sessions)
[0m18:52:32.244249 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_sessions
[0m18:52:32.245478 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_sessions"
[0m18:52:32.245775 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_sessions
[0m18:52:32.246046 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_sessions
[0m18:52:32.246212 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c
[0m18:52:32.246389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_sessions, now test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c)
[0m18:52:32.246575 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c
[0m18:52:32.251793 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c"
[0m18:52:32.252114 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c
[0m18:52:32.252404 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c
[0m18:52:32.252576 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19
[0m18:52:32.252742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c, now test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19)
[0m18:52:32.252892 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19
[0m18:52:32.254686 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19"
[0m18:52:32.254987 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19
[0m18:52:32.255263 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19
[0m18:52:32.255425 [debug] [Thread-1 (]: Began running node test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef
[0m18:52:32.255592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19, now test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef)
[0m18:52:32.255740 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef
[0m18:52:32.258513 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef"
[0m18:52:32.258805 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef
[0m18:52:32.259081 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef
[0m18:52:32.259248 [debug] [Thread-1 (]: Began running node test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36
[0m18:52:32.259415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef, now test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36)
[0m18:52:32.259569 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36
[0m18:52:32.264138 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36"
[0m18:52:32.264531 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36
[0m18:52:32.264839 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36
[0m18:52:32.265007 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_events_event_id.715b3f7012
[0m18:52:32.265192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36, now test.quest_kingdom.not_null_stg_events_event_id.715b3f7012)
[0m18:52:32.265380 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_events_event_id.715b3f7012
[0m18:52:32.267125 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_events_event_id.715b3f7012"
[0m18:52:32.267406 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_events_event_id.715b3f7012
[0m18:52:32.267677 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_events_event_id.715b3f7012
[0m18:52:32.267834 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3
[0m18:52:32.267997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_events_event_id.715b3f7012, now test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3)
[0m18:52:32.268141 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3
[0m18:52:32.269821 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3"
[0m18:52:32.270102 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3
[0m18:52:32.270371 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3
[0m18:52:32.270530 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5
[0m18:52:32.270691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3, now test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5)
[0m18:52:32.270836 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5
[0m18:52:32.273358 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5"
[0m18:52:32.273648 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5
[0m18:52:32.273912 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5
[0m18:52:32.274071 [debug] [Thread-1 (]: Began running node test.quest_kingdom.unique_stg_events_event_id.66ebb17438
[0m18:52:32.274232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5, now test.quest_kingdom.unique_stg_events_event_id.66ebb17438)
[0m18:52:32.274378 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.unique_stg_events_event_id.66ebb17438
[0m18:52:32.276022 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.unique_stg_events_event_id.66ebb17438"
[0m18:52:32.276277 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.unique_stg_events_event_id.66ebb17438
[0m18:52:32.276530 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.unique_stg_events_event_id.66ebb17438
[0m18:52:32.276683 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d
[0m18:52:32.276848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.unique_stg_events_event_id.66ebb17438, now test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d)
[0m18:52:32.277017 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d
[0m18:52:32.278703 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d"
[0m18:52:32.278983 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d
[0m18:52:32.279240 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d
[0m18:52:32.279396 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079
[0m18:52:32.279558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d, now test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079)
[0m18:52:32.279701 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079
[0m18:52:32.281420 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079"
[0m18:52:32.281689 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079
[0m18:52:32.281947 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079
[0m18:52:32.282105 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645
[0m18:52:32.282261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079, now test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645)
[0m18:52:32.282404 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645
[0m18:52:32.284170 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645"
[0m18:52:32.284447 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645
[0m18:52:32.284718 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645
[0m18:52:32.284880 [debug] [Thread-1 (]: Began running node test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069
[0m18:52:32.285041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645, now test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069)
[0m18:52:32.285186 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069
[0m18:52:32.286894 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069"
[0m18:52:32.287179 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069
[0m18:52:32.287437 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069
[0m18:52:32.287627 [debug] [Thread-1 (]: Began running node test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd
[0m18:52:32.287825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069, now test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd)
[0m18:52:32.287981 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd
[0m18:52:32.290189 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd"
[0m18:52:32.290481 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd
[0m18:52:32.290754 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd
[0m18:52:32.290915 [debug] [Thread-1 (]: Began running node test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a
[0m18:52:32.291074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd, now test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a)
[0m18:52:32.291225 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a
[0m18:52:32.294082 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a"
[0m18:52:32.294508 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a
[0m18:52:32.294801 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a
[0m18:52:32.294965 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb
[0m18:52:32.295138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a, now test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb)
[0m18:52:32.295287 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb
[0m18:52:32.297249 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb"
[0m18:52:32.297557 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb
[0m18:52:32.297821 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb
[0m18:52:32.297981 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b
[0m18:52:32.298134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb, now test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b)
[0m18:52:32.298304 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b
[0m18:52:32.300133 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b"
[0m18:52:32.300464 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b
[0m18:52:32.300744 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b
[0m18:52:32.300913 [debug] [Thread-1 (]: Began running node test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963
[0m18:52:32.301086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b, now test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963)
[0m18:52:32.301235 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963
[0m18:52:32.306081 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963"
[0m18:52:32.306495 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963
[0m18:52:32.306804 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963
[0m18:52:32.306974 [debug] [Thread-1 (]: Began running node test.quest_kingdom.unique_stg_players_player_id.a3d551d71d
[0m18:52:32.307157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963, now test.quest_kingdom.unique_stg_players_player_id.a3d551d71d)
[0m18:52:32.307314 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.unique_stg_players_player_id.a3d551d71d
[0m18:52:32.309334 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.unique_stg_players_player_id.a3d551d71d"
[0m18:52:32.309725 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.unique_stg_players_player_id.a3d551d71d
[0m18:52:32.310011 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.unique_stg_players_player_id.a3d551d71d
[0m18:52:32.310179 [debug] [Thread-1 (]: Began running node model.quest_kingdom.dim_players
[0m18:52:32.310357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.unique_stg_players_player_id.a3d551d71d, now model.quest_kingdom.dim_players)
[0m18:52:32.312918 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.dim_players
[0m18:52:32.314967 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.dim_players"
[0m18:52:32.315502 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.dim_players
[0m18:52:32.315809 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.dim_players
[0m18:52:32.315978 [debug] [Thread-1 (]: Began running node model.quest_kingdom.fct_sessions
[0m18:52:32.316158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.dim_players, now model.quest_kingdom.fct_sessions)
[0m18:52:32.316312 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.fct_sessions
[0m18:52:32.317889 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.fct_sessions"
[0m18:52:32.318190 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.fct_sessions
[0m18:52:32.318458 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.fct_sessions
[0m18:52:32.318617 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29
[0m18:52:32.318806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.fct_sessions, now test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29)
[0m18:52:32.318947 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29
[0m18:52:32.320773 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29"
[0m18:52:32.321119 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29
[0m18:52:32.321395 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29
[0m18:52:32.321556 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d
[0m18:52:32.321722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29, now test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d)
[0m18:52:32.321870 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d
[0m18:52:32.323605 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d"
[0m18:52:32.323888 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d
[0m18:52:32.324163 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d
[0m18:52:32.324322 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09
[0m18:52:32.324485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d, now test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09)
[0m18:52:32.324631 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09
[0m18:52:32.326353 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09"
[0m18:52:32.326629 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09
[0m18:52:32.326888 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09
[0m18:52:32.327048 [debug] [Thread-1 (]: Began running node test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee
[0m18:52:32.327208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09, now test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee)
[0m18:52:32.327356 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee
[0m18:52:32.329535 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee"
[0m18:52:32.329830 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee
[0m18:52:32.330104 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee
[0m18:52:32.330262 [debug] [Thread-1 (]: Began running node test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03
[0m18:52:32.330419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee, now test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03)
[0m18:52:32.330561 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03
[0m18:52:32.332259 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03"
[0m18:52:32.332529 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03
[0m18:52:32.332790 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03
[0m18:52:32.333273 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:52:32.333443 [debug] [MainThread]: Connection 'test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03' was properly closed.
[0m18:52:32.335034 [debug] [MainThread]: Command end result
[0m18:52:32.406489 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/manifest.json
[0m18:52:32.407448 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/semantic_manifest.json
[0m18:52:32.410830 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/run_results.json
[0m18:52:32.412932 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m18:52:32.413097 [info ] [MainThread]: Building catalog
[0m18:52:32.417776 [debug] [ThreadPool]: Acquiring new duckdb connection 'quest_kingdom.information_schema'
[0m18:52:32.421215 [debug] [ThreadPool]: Using duckdb connection "quest_kingdom.information_schema"
[0m18:52:32.421494 [debug] [ThreadPool]: On quest_kingdom.information_schema: BEGIN
[0m18:52:32.421635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:32.422037 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:52:32.422172 [debug] [ThreadPool]: Using duckdb connection "quest_kingdom.information_schema"
[0m18:52:32.422327 [debug] [ThreadPool]: On quest_kingdom.information_schema: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "quest_kingdom.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'quest_kingdom'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'quest_kingdom'
    )
    select
        'quest_kingdom' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        NULL as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m18:52:32.427364 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m18:52:32.429874 [debug] [ThreadPool]: On quest_kingdom.information_schema: ROLLBACK
[0m18:52:32.430351 [debug] [ThreadPool]: Failed to rollback 'quest_kingdom.information_schema'
[0m18:52:32.430497 [debug] [ThreadPool]: On quest_kingdom.information_schema: Close
[0m18:52:32.437232 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/catalog.json
[0m18:52:32.450197 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/manifest.json
[0m18:52:32.451135 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/semantic_manifest.json
[0m18:52:32.451290 [info ] [MainThread]: Catalog written to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/catalog.json
[0m18:52:32.452328 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.59714544, "process_in_blocks": "0", "process_kernel_time": 0.155708, "process_mem_max_rss": "149274624", "process_out_blocks": "0", "process_user_time": 1.155317}
[0m18:52:32.452569 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:52:32.452529 after 0.60 seconds
[0m18:52:32.452713 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:52:32.452828 [debug] [MainThread]: Connection 'quest_kingdom.information_schema' was properly closed.
[0m18:52:32.452972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106867110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b74d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e1baa0>]}
[0m18:52:32.453144 [debug] [MainThread]: Flushing usage events
[0m18:52:32.552028 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:52:40.526146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10827fcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ddeab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109001850>]}


============================== 18:52:40.529098 | 89e5a51e-99b4-4b50-a099-7e5ac916b949 ==============================
[0m18:52:40.529098 [info ] [MainThread]: Running with dbt=1.11.4
[0m18:52:40.529404 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'no_print': 'None', 'warn_error': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_format': 'default', 'printer_width': '80', 'profiles_dir': '/Users/hazeldonaldson/.dbt', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'log_path': '/Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/logs', 'partial_parse': 'True', 'invocation_command': 'dbt docs serve', 'use_colors': 'True', 'version_check': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'static_parser': 'True'}
[0m18:52:40.635392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89e5a51e-99b4-4b50-a099-7e5ac916b949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109109c10>]}
[0m18:52:40.664394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89e5a51e-99b4-4b50-a099-7e5ac916b949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085bf0b0>]}
[0m18:53:06.310667 [error] [MainThread]: Encountered an error:

[0m18:53:06.317195 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/miniconda3/envs/dbt-duckdb/lib/python3.12/site-packages/dbt/cli/requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/dbt-duckdb/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/dbt-duckdb/lib/python3.12/site-packages/dbt/cli/requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/dbt-duckdb/lib/python3.12/site-packages/dbt/cli/requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/dbt-duckdb/lib/python3.12/site-packages/dbt/cli/requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/dbt-duckdb/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/opt/miniconda3/envs/dbt-duckdb/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/opt/miniconda3/envs/dbt-duckdb/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/miniconda3/envs/dbt-duckdb/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m18:53:06.321498 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 25.829668, "process_in_blocks": "0", "process_kernel_time": 0.120546, "process_mem_max_rss": "127221760", "process_out_blocks": "0", "process_user_time": 0.815987}
[0m18:53:06.322433 [debug] [MainThread]: Command `dbt docs serve` failed at 18:53:06.322316 after 25.83 seconds
[0m18:53:06.323384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109001af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109088380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109070680>]}
[0m18:53:06.323815 [debug] [MainThread]: Flushing usage events
[0m18:53:06.461032 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:55:38.481958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dfef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066b5be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066b59d0>]}


============================== 18:55:38.485763 | 8891146b-f07d-43e8-8ed1-e4a69a42163a ==============================
[0m18:55:38.485763 [info ] [MainThread]: Running with dbt=1.11.4
[0m18:55:38.486078 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'warn_error': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'target_path': 'None', 'profiles_dir': '/Users/hazeldonaldson/.dbt', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'no_print': 'None', 'version_check': 'True', 'log_path': '/Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/logs', 'log_format': 'default', 'cache_selected_only': 'False', 'static_parser': 'True', 'use_colors': 'True'}
[0m18:55:38.658468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8891146b-f07d-43e8-8ed1-e4a69a42163a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067dde20>]}
[0m18:55:38.686563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8891146b-f07d-43e8-8ed1-e4a69a42163a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dff860>]}
[0m18:55:38.687862 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:55:38.739841 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m18:55:38.805988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:55:38.806231 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:55:38.806366 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:55:38.809600 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.question_kingdom
- models.core
- models.marts
- models.product
- models.retention
- models.staging
- models.monetization
[0m18:55:38.829931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8891146b-f07d-43e8-8ed1-e4a69a42163a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a536b0>]}
[0m18:55:38.872333 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/manifest.json
[0m18:55:38.873647 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/semantic_manifest.json
[0m18:55:38.886811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8891146b-f07d-43e8-8ed1-e4a69a42163a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110068440>]}
[0m18:55:38.887100 [info ] [MainThread]: Found 7 models, 23 data tests, 5 sources, 472 macros
[0m18:55:38.887270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8891146b-f07d-43e8-8ed1-e4a69a42163a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110051af0>]}
[0m18:55:38.888385 [info ] [MainThread]: 
[0m18:55:38.888555 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:55:38.888690 [info ] [MainThread]: 
[0m18:55:38.888930 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:55:38.891138 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_quest_kingdom'
[0m18:55:38.921797 [debug] [ThreadPool]: Using duckdb connection "list_quest_kingdom"
[0m18:55:38.922046 [debug] [ThreadPool]: On list_quest_kingdom: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "list_quest_kingdom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"quest_kingdom"'
    
  
  
[0m18:55:38.922195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:38.939845 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m18:55:38.940840 [debug] [ThreadPool]: On list_quest_kingdom: Close
[0m18:55:38.941187 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_quest_kingdom, now create_quest_kingdom_main)
[0m18:55:38.941466 [debug] [ThreadPool]: Creating schema "database: "quest_kingdom"
schema: "main"
"
[0m18:55:38.944912 [debug] [ThreadPool]: Using duckdb connection "create_quest_kingdom_main"
[0m18:55:38.945153 [debug] [ThreadPool]: On create_quest_kingdom_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "create_quest_kingdom_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='quest_kingdom'
        and type='sqlite'
    
  
[0m18:55:38.945409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:55:38.946347 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:55:38.946998 [debug] [ThreadPool]: Using duckdb connection "create_quest_kingdom_main"
[0m18:55:38.947134 [debug] [ThreadPool]: On create_quest_kingdom_main: BEGIN
[0m18:55:38.947345 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:55:38.947469 [debug] [ThreadPool]: Using duckdb connection "create_quest_kingdom_main"
[0m18:55:38.947591 [debug] [ThreadPool]: On create_quest_kingdom_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "create_quest_kingdom_main"} */

    
    
        create schema if not exists "quest_kingdom"."main"
    
[0m18:55:38.948055 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:55:38.948428 [debug] [ThreadPool]: On create_quest_kingdom_main: COMMIT
[0m18:55:38.948563 [debug] [ThreadPool]: Using duckdb connection "create_quest_kingdom_main"
[0m18:55:38.948679 [debug] [ThreadPool]: On create_quest_kingdom_main: COMMIT
[0m18:55:38.948870 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:55:38.948997 [debug] [ThreadPool]: On create_quest_kingdom_main: Close
[0m18:55:38.949657 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_quest_kingdom_main, now list_quest_kingdom_main)
[0m18:55:38.953103 [debug] [ThreadPool]: Using duckdb connection "list_quest_kingdom_main"
[0m18:55:38.953266 [debug] [ThreadPool]: On list_quest_kingdom_main: BEGIN
[0m18:55:38.953389 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:55:38.953645 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:55:38.953776 [debug] [ThreadPool]: Using duckdb connection "list_quest_kingdom_main"
[0m18:55:38.953909 [debug] [ThreadPool]: On list_quest_kingdom_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "list_quest_kingdom_main"} */
select
      'quest_kingdom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'quest_kingdom'
  
[0m18:55:38.965054 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:55:38.965912 [debug] [ThreadPool]: On list_quest_kingdom_main: ROLLBACK
[0m18:55:38.966926 [debug] [ThreadPool]: Failed to rollback 'list_quest_kingdom_main'
[0m18:55:38.967089 [debug] [ThreadPool]: On list_quest_kingdom_main: Close
[0m18:55:38.968062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8891146b-f07d-43e8-8ed1-e4a69a42163a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106792ba0>]}
[0m18:55:38.968310 [debug] [MainThread]: Using duckdb connection "master"
[0m18:55:38.968448 [debug] [MainThread]: On master: BEGIN
[0m18:55:38.968569 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:55:38.968845 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:55:38.968975 [debug] [MainThread]: On master: COMMIT
[0m18:55:38.969099 [debug] [MainThread]: Using duckdb connection "master"
[0m18:55:38.969216 [debug] [MainThread]: On master: COMMIT
[0m18:55:38.969406 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:55:38.969532 [debug] [MainThread]: On master: Close
[0m18:55:38.970869 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_ad_impressions
[0m18:55:38.971118 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_ad_impressions ............................ [RUN]
[0m18:55:38.971325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_quest_kingdom_main, now model.quest_kingdom.stg_ad_impressions)
[0m18:55:38.971488 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_ad_impressions
[0m18:55:38.975037 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_ad_impressions"
[0m18:55:38.975958 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_ad_impressions
[0m18:55:38.989976 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.stg_ad_impressions"
[0m18:55:38.990739 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_ad_impressions"
[0m18:55:38.990902 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: BEGIN
[0m18:55:38.991045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:38.991457 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:55:38.991648 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_ad_impressions"
[0m18:55:38.991820 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_ad_impressions"} */

  
  create view "quest_kingdom"."main"."stg_ad_impressions__dbt_tmp" as (
    select
    -- ids
    ad_id,
    player_id,
    session_id,
    
    -- timestamps
    ad_timestamp::timestamp as shown_at,
    
    -- dimensions
    lower(trim(ad_type)) as ad_type,
    lower(trim(ad_network)) as ad_network,
    
    -- booleans
    clicked,
    
    -- metrics
    revenue_usd,
    
    -- derived
    date_trunc('day', ad_timestamp::timestamp)::date as ad_date

from "quest_kingdom"."main"."ad_impressions"
  );

[0m18:55:38.992591 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:55:38.996156 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_ad_impressions"
[0m18:55:38.996438 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_ad_impressions"} */
alter view "quest_kingdom"."main"."stg_ad_impressions" rename to "stg_ad_impressions__dbt_backup"
[0m18:55:38.997477 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:55:38.999155 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_ad_impressions"
[0m18:55:38.999355 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_ad_impressions"} */
alter view "quest_kingdom"."main"."stg_ad_impressions__dbt_tmp" rename to "stg_ad_impressions"
[0m18:55:38.999726 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:55:39.005395 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: COMMIT
[0m18:55:39.005592 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_ad_impressions"
[0m18:55:39.005745 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: COMMIT
[0m18:55:39.006326 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:55:39.009048 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_ad_impressions"
[0m18:55:39.009244 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_ad_impressions"} */

      drop view if exists "quest_kingdom"."main"."stg_ad_impressions__dbt_backup" cascade
    
[0m18:55:39.009860 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:55:39.010972 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: Close
[0m18:55:39.011876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8891146b-f07d-43e8-8ed1-e4a69a42163a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b270e0>]}
[0m18:55:39.012181 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.stg_ad_impressions ....................... [[32mOK[0m in 0.04s]
[0m18:55:39.012441 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_ad_impressions
[0m18:55:39.012627 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_events
[0m18:55:39.012853 [info ] [Thread-1 (]: 2 of 7 START sql view model main.stg_events .................................... [RUN]
[0m18:55:39.013050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_ad_impressions, now model.quest_kingdom.stg_events)
[0m18:55:39.013205 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_events
[0m18:55:39.014534 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_events"
[0m18:55:39.014853 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_events
[0m18:55:39.016348 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.stg_events"
[0m18:55:39.016869 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_events"
[0m18:55:39.017043 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: BEGIN
[0m18:55:39.017194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:39.017506 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:55:39.017656 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_events"
[0m18:55:39.017806 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_events"} */

  
  create view "quest_kingdom"."main"."stg_events__dbt_tmp" as (
    select
    -- ids
    event_id,
    player_id,
    session_id,
    
    -- timestamps
    event_timestamp::timestamp as event_at,
    
    -- dimensions
    lower(trim(event_name)) as event_name,
    
    -- json properties
    event_properties

from "quest_kingdom"."main"."events"
  );

[0m18:55:39.018258 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:55:39.020535 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_events"
[0m18:55:39.020708 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_events"} */
alter view "quest_kingdom"."main"."stg_events" rename to "stg_events__dbt_backup"
[0m18:55:39.021030 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:55:39.022315 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_events"
[0m18:55:39.022465 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_events"} */
alter view "quest_kingdom"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m18:55:39.022728 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:55:39.023431 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: COMMIT
[0m18:55:39.023578 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_events"
[0m18:55:39.023715 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: COMMIT
[0m18:55:39.024058 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:55:39.025216 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_events"
[0m18:55:39.025430 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_events"} */

      drop view if exists "quest_kingdom"."main"."stg_events__dbt_backup" cascade
    
[0m18:55:39.025902 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:55:39.026593 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: Close
[0m18:55:39.027036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8891146b-f07d-43e8-8ed1-e4a69a42163a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107006b0>]}
[0m18:55:39.027612 [info ] [Thread-1 (]: 2 of 7 OK created sql view model main.stg_events ............................... [[32mOK[0m in 0.01s]
[0m18:55:39.027932 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_events
[0m18:55:39.028138 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_iap_transactions
[0m18:55:39.028390 [info ] [Thread-1 (]: 3 of 7 START sql view model main.stg_iap_transactions .......................... [RUN]
[0m18:55:39.028631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_events, now model.quest_kingdom.stg_iap_transactions)
[0m18:55:39.028801 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_iap_transactions
[0m18:55:39.030223 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_iap_transactions"
[0m18:55:39.030607 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_iap_transactions
[0m18:55:39.032111 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.stg_iap_transactions"
[0m18:55:39.032417 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_iap_transactions"
[0m18:55:39.032573 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: BEGIN
[0m18:55:39.032711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:39.033053 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:55:39.033200 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_iap_transactions"
[0m18:55:39.033359 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_iap_transactions"} */

  
  create view "quest_kingdom"."main"."stg_iap_transactions__dbt_tmp" as (
    select
    -- ids
    transaction_id,
    player_id,
    session_id,
    
    -- timestamps
    transaction_timestamp::timestamp as purchased_at,
    
    -- dimensions
    lower(trim(sku)) as sku,
    lower(trim(platform)) as platform,
    
    -- metrics
    price_usd,
    gems_purchased,
    
    -- derived
    date_trunc('day', transaction_timestamp::timestamp)::date as purchase_date

from "quest_kingdom"."main"."iap_transactions"
  );

[0m18:55:39.033835 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:55:39.035318 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_iap_transactions"
[0m18:55:39.035482 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_iap_transactions"} */
alter view "quest_kingdom"."main"."stg_iap_transactions" rename to "stg_iap_transactions__dbt_backup"
[0m18:55:39.035783 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:55:39.037053 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_iap_transactions"
[0m18:55:39.037209 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_iap_transactions"} */
alter view "quest_kingdom"."main"."stg_iap_transactions__dbt_tmp" rename to "stg_iap_transactions"
[0m18:55:39.037483 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:55:39.038136 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: COMMIT
[0m18:55:39.038290 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_iap_transactions"
[0m18:55:39.038429 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: COMMIT
[0m18:55:39.038812 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:55:39.039873 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_iap_transactions"
[0m18:55:39.040033 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_iap_transactions"} */

      drop view if exists "quest_kingdom"."main"."stg_iap_transactions__dbt_backup" cascade
    
[0m18:55:39.040361 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:55:39.040923 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: Close
[0m18:55:39.041159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8891146b-f07d-43e8-8ed1-e4a69a42163a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103e60f0>]}
[0m18:55:39.041540 [info ] [Thread-1 (]: 3 of 7 OK created sql view model main.stg_iap_transactions ..................... [[32mOK[0m in 0.01s]
[0m18:55:39.041796 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_iap_transactions
[0m18:55:39.041980 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_players
[0m18:55:39.042207 [info ] [Thread-1 (]: 4 of 7 START sql view model main.stg_players ................................... [RUN]
[0m18:55:39.042448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_iap_transactions, now model.quest_kingdom.stg_players)
[0m18:55:39.042626 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_players
[0m18:55:39.044421 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_players"
[0m18:55:39.045081 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_players
[0m18:55:39.046713 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.stg_players"
[0m18:55:39.047036 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:55:39.047192 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: BEGIN
[0m18:55:39.047331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:39.047728 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:55:39.047908 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:55:39.048079 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_players"} */

  
  create view "quest_kingdom"."main"."stg_players__dbt_tmp" as (
    with source as (
    select * from "quest_kingdom"."main"."players"
),

renamed as (
    select
        player_id,
        install_date::date as installed_at,
        --dimensions
        lower(trim(attribution_channel)) as attribution_channel,
        lower(trim(country)) as country,
        lower(trim(device_type)) as device_type,
        lower(trim(player_segment)) as player_segment,
        lower(trim(experiment_variant)) as experiment_variant,
        --booleans
        tutorial_completed,
        --metrics
        lifetime_value as lifetime_value_usd
    from source 
)

select * from renamed
  );

[0m18:55:39.048677 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:55:39.051093 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:55:39.051266 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_players"} */
alter view "quest_kingdom"."main"."stg_players" rename to "stg_players__dbt_backup"
[0m18:55:39.051583 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:55:39.083513 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:55:39.083754 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_players"} */
alter view "quest_kingdom"."main"."stg_players__dbt_tmp" rename to "stg_players"
[0m18:55:39.084160 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:55:39.084871 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: COMMIT
[0m18:55:39.085027 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:55:39.085167 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: COMMIT
[0m18:55:39.085579 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:55:39.086632 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:55:39.086780 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_players"} */

      drop view if exists "quest_kingdom"."main"."stg_players__dbt_backup" cascade
    
[0m18:55:39.087141 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:55:39.087693 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: Close
[0m18:55:39.087930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8891146b-f07d-43e8-8ed1-e4a69a42163a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110744950>]}
[0m18:55:39.088195 [info ] [Thread-1 (]: 4 of 7 OK created sql view model main.stg_players .............................. [[32mOK[0m in 0.05s]
[0m18:55:39.088430 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_players
[0m18:55:39.088596 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_sessions
[0m18:55:39.088801 [info ] [Thread-1 (]: 5 of 7 START sql view model main.stg_sessions .................................. [RUN]
[0m18:55:39.088978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_players, now model.quest_kingdom.stg_sessions)
[0m18:55:39.089130 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_sessions
[0m18:55:39.090456 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_sessions"
[0m18:55:39.090819 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_sessions
[0m18:55:39.092462 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.stg_sessions"
[0m18:55:39.092831 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_sessions"
[0m18:55:39.092997 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: BEGIN
[0m18:55:39.093145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:39.093458 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:55:39.093611 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_sessions"
[0m18:55:39.093777 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_sessions"} */

  
  create view "quest_kingdom"."main"."stg_sessions__dbt_tmp" as (
    with source as (
    select * from "quest_kingdom"."main"."sessions"
),

renamed as (
    select 
        session_id,
        player_id,
        --timestamps
        session_start::timestamp as session_started_at,
        session_end::timestamp as session_ended_at,

        --metrics
        session_duration_minutes,
        starting_level,
        ending_level,
        levels_gained,

        --derived metrics
        extract(hour from session_start::timestamp) as session_hour,
        extract(dow from session_start::timestamp) as session_day_of_week,
        date_trunc('day', session_start::timestamp)::date as session_date 
    from source
)

select * from renamed
  );

[0m18:55:39.094346 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:55:39.095880 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_sessions"
[0m18:55:39.096090 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_sessions"} */
alter view "quest_kingdom"."main"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m18:55:39.096473 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:55:39.098394 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_sessions"
[0m18:55:39.098624 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_sessions"} */
alter view "quest_kingdom"."main"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m18:55:39.099064 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:55:39.099823 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: COMMIT
[0m18:55:39.100001 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_sessions"
[0m18:55:39.102750 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: COMMIT
[0m18:55:39.103275 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:55:39.104439 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_sessions"
[0m18:55:39.104598 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_sessions"} */

      drop view if exists "quest_kingdom"."main"."stg_sessions__dbt_backup" cascade
    
[0m18:55:39.104957 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:55:39.105552 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: Close
[0m18:55:39.105796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8891146b-f07d-43e8-8ed1-e4a69a42163a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110437d70>]}
[0m18:55:39.106070 [info ] [Thread-1 (]: 5 of 7 OK created sql view model main.stg_sessions ............................. [[32mOK[0m in 0.02s]
[0m18:55:39.106311 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_sessions
[0m18:55:39.106641 [debug] [Thread-1 (]: Began running node model.quest_kingdom.dim_players
[0m18:55:39.106904 [info ] [Thread-1 (]: 6 of 7 START sql table model main.dim_players .................................. [RUN]
[0m18:55:39.107124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_sessions, now model.quest_kingdom.dim_players)
[0m18:55:39.107296 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.dim_players
[0m18:55:39.109321 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.dim_players"
[0m18:55:39.110110 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.dim_players
[0m18:55:39.119443 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.dim_players"
[0m18:55:39.120023 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.dim_players"
[0m18:55:39.120200 [debug] [Thread-1 (]: On model.quest_kingdom.dim_players: BEGIN
[0m18:55:39.120350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:39.120704 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:55:39.120855 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.dim_players"
[0m18:55:39.121086 [debug] [Thread-1 (]: On model.quest_kingdom.dim_players: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.dim_players"} */

  
    
    

    create  table
      "quest_kingdom"."main"."dim_players__dbt_tmp"
  
    as (
      

with players as (
    select * from "quest_kingdom"."main"."stg_players"
),

sessions as (
    select * from "quest_kingdom"."main"."stg_sessions"
),

transactions as (
    select * from "quest_kingdom"."main"."stg_iap_transactions"
),

ads as (
    select * from "quest_kingdom"."main"."stg_ad_impressions"
),

--aggregate session metrics per player
player_sessions as (
    select 
        player_id,
        count(*) as total_sessions,
        min(session_started_at) as first_session_at,
        max(session_started_at) as last_session_at,
        sum(session_duration_minutes) as total_play_time_minutes,
        avg(session_duration_minutes) as avg_session_duration_minutes,
        max(ending_level) as max_level_reached
    from sessions 
    group by player_id
),

--aggregated IAP metrics per player
player_iap as (
    select
        player_id,
        count(*) as total_purchases,
        sum(price_usd) as total_iap_revenue,
        min(purchased_at) as first_purchase_at,
        avg(price_usd) as avg_purchase_value
    from transactions
    group by player_id 
),

--aggregate ad metrics per player
player_ads as (
    select 
        player_id,
        count(*) as total_ad_impressions,
        sum(revenue_usd) as total_ad_revenue,
        sum(case when clicked then 1 else 0 end) as total_ad_clicks
    from ads
    group by player_id 
),

--combining everything
final (
    select 
        p.player_id,
        p.installed_at,
        p.attribution_channel,
        p.country,
        p.device_type,
        p.player_segment,
        p.experiment_variant,
        p.tutorial_completed,

        --session metrics
        coalesce(ps.total_sessions, 0) as total_sessions,
        ps.first_session_at,
        ps.last_session_at,
        coalesce(ps.total_play_time_minutes, 0) as total_play_time_minutes,
        ps.avg_session_duration_minutes,
        coalesce(ps.max_level_reached, 0) as max_level_reached,

        --monetization metrics
        coalesce(pi.total_purchases, 0) as total_purchases,
        coalesce(pi.total_iap_revenue, 0) as total_iap_revenue,
        pi.first_purchase_at,
        pi.avg_purchase_value,
        coalesce(pa.total_ad_impressions, 0) as total_ad_impressions,
        coalesce(pa.total_ad_revenue, 0) as total_ad_revenue,
        coalesce(pc.total_ad_clicks, 0) as total_ad_clicks,

        --derived total revenue
        coalesce(pi.total_iap_revenue, 0) + coalesce(pc.total_ad_revenue, 0) as total_revenue,
        --derived day metrics
        datediff('day', p.installed_at, current_date) as days_since_install,
        case
            when ps.last_session_at is not null 
            then datediff('day', ps.last_session_at, current_date)
            else null 
        end as days_since_last_session,
        case
            when pi.first_purchase_at is not null
            then datediff('day', p.installed_at, pi.first_purchase_at)
            else null 
        end days_to_first_purchase,

        --derived flags
        coalesce(ps.total_sessions, 0) > 0 as is_activated,
        coalesce(pi.total_purchases, 0) > 0 as is_payer,
        coalesce(pa.total_ad_impressions, 0) > 0 as has_seen_ads
    from players p 
    left join player_sessions ps on p.player_id = ps.player_id
    left join player_iap pi on p.player_id = pi.player_id
    left join player_ads pa on p.player_id = pa.player_id 
)

select * from final
    );
  
  
[0m18:55:39.124074 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.dim_players"} */

  
    
    

    create  table
      "quest_kingdom"."main"."dim_players__dbt_tmp"
  
    as (
      

with players as (
    select * from "quest_kingdom"."main"."stg_players"
),

sessions as (
    select * from "quest_kingdom"."main"."stg_sessions"
),

transactions as (
    select * from "quest_kingdom"."main"."stg_iap_transactions"
),

ads as (
    select * from "quest_kingdom"."main"."stg_ad_impressions"
),

--aggregate session metrics per player
player_sessions as (
    select 
        player_id,
        count(*) as total_sessions,
        min(session_started_at) as first_session_at,
        max(session_started_at) as last_session_at,
        sum(session_duration_minutes) as total_play_time_minutes,
        avg(session_duration_minutes) as avg_session_duration_minutes,
        max(ending_level) as max_level_reached
    from sessions 
    group by player_id
),

--aggregated IAP metrics per player
player_iap as (
    select
        player_id,
        count(*) as total_purchases,
        sum(price_usd) as total_iap_revenue,
        min(purchased_at) as first_purchase_at,
        avg(price_usd) as avg_purchase_value
    from transactions
    group by player_id 
),

--aggregate ad metrics per player
player_ads as (
    select 
        player_id,
        count(*) as total_ad_impressions,
        sum(revenue_usd) as total_ad_revenue,
        sum(case when clicked then 1 else 0 end) as total_ad_clicks
    from ads
    group by player_id 
),

--combining everything
final (
    select 
        p.player_id,
        p.installed_at,
        p.attribution_channel,
        p.country,
        p.device_type,
        p.player_segment,
        p.experiment_variant,
        p.tutorial_completed,

        --session metrics
        coalesce(ps.total_sessions, 0) as total_sessions,
        ps.first_session_at,
        ps.last_session_at,
        coalesce(ps.total_play_time_minutes, 0) as total_play_time_minutes,
        ps.avg_session_duration_minutes,
        coalesce(ps.max_level_reached, 0) as max_level_reached,

        --monetization metrics
        coalesce(pi.total_purchases, 0) as total_purchases,
        coalesce(pi.total_iap_revenue, 0) as total_iap_revenue,
        pi.first_purchase_at,
        pi.avg_purchase_value,
        coalesce(pa.total_ad_impressions, 0) as total_ad_impressions,
        coalesce(pa.total_ad_revenue, 0) as total_ad_revenue,
        coalesce(pc.total_ad_clicks, 0) as total_ad_clicks,

        --derived total revenue
        coalesce(pi.total_iap_revenue, 0) + coalesce(pc.total_ad_revenue, 0) as total_revenue,
        --derived day metrics
        datediff('day', p.installed_at, current_date) as days_since_install,
        case
            when ps.last_session_at is not null 
            then datediff('day', ps.last_session_at, current_date)
            else null 
        end as days_since_last_session,
        case
            when pi.first_purchase_at is not null
            then datediff('day', p.installed_at, pi.first_purchase_at)
            else null 
        end days_to_first_purchase,

        --derived flags
        coalesce(ps.total_sessions, 0) > 0 as is_activated,
        coalesce(pi.total_purchases, 0) > 0 as is_payer,
        coalesce(pa.total_ad_impressions, 0) > 0 as has_seen_ads
    from players p 
    left join player_sessions ps on p.player_id = ps.player_id
    left join player_iap pi on p.player_id = pi.player_id
    left join player_ads pa on p.player_id = pa.player_id 
)

select * from final
    );
  
  
[0m18:55:39.124344 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:55:39.124543 [debug] [Thread-1 (]: On model.quest_kingdom.dim_players: ROLLBACK
[0m18:55:39.129093 [debug] [Thread-1 (]: Failed to rollback 'model.quest_kingdom.dim_players'
[0m18:55:39.129316 [debug] [Thread-1 (]: On model.quest_kingdom.dim_players: Close
[0m18:55:39.130461 [debug] [Thread-1 (]: Runtime Error in model dim_players (models/marts/core/dim_players.sql)
  Parser Error: syntax error at or near "select"
  
  LINE 68:     select 
               ^
[0m18:55:39.130682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8891146b-f07d-43e8-8ed1-e4a69a42163a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110700da0>]}
[0m18:55:39.130975 [error] [Thread-1 (]: 6 of 7 ERROR creating sql table model main.dim_players ......................... [[31mERROR[0m in 0.02s]
[0m18:55:39.131226 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.dim_players
[0m18:55:39.131402 [debug] [Thread-1 (]: Began running node model.quest_kingdom.fct_sessions
[0m18:55:39.131628 [debug] [Thread-4 (]: Marking all children of 'model.quest_kingdom.dim_players' to be skipped because of status 'error'.  Reason: Runtime Error in model dim_players (models/marts/core/dim_players.sql)
  Parser Error: syntax error at or near "select"
  
  LINE 68:     select 
               ^.
[0m18:55:39.131840 [info ] [Thread-1 (]: 7 of 7 START sql table model main.fct_sessions ................................. [RUN]
[0m18:55:39.132388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.dim_players, now model.quest_kingdom.fct_sessions)
[0m18:55:39.132555 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.fct_sessions
[0m18:55:39.135170 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.fct_sessions"
[0m18:55:39.135563 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.fct_sessions
[0m18:55:39.137065 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.fct_sessions"
[0m18:55:39.137451 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.fct_sessions"
[0m18:55:39.137606 [debug] [Thread-1 (]: On model.quest_kingdom.fct_sessions: BEGIN
[0m18:55:39.137747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:39.138093 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:55:39.138241 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.fct_sessions"
[0m18:55:39.138424 [debug] [Thread-1 (]: On model.quest_kingdom.fct_sessions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.fct_sessions"} */

  
    
    

    create  table
      "quest_kingdom"."main"."fct_sessions__dbt_tmp"
  
    as (
      

with sessions as (
    select * from "quest_kingdom"."main"."stg_sessions"
),

players as (
    select * from "quest_kingdom"."main"."stg_players"
),

final as (
    select 
        s.session_id,
        s.player_id,
        s.session_started_at,
        s.session_ended_at,
        s.session_duration_minutes,
        s.starting_level,
        s.ending_level,
        s.levels_gained,
        s.session_hour,
        s.session_day_of_week,
        s.session_date,

        --player context
        p.installed_at,
        p.attribution_channel,
        p.country,
        p.device_type,
        p.player_segment,
        p.experiment_variant,
        p.tutorial_completed,

        --derived metrics
        datediff('day', p.installed_at, s.session_started_at) as days_since_install,
        --session quality flags
        s.session_duration_minutes >= 5 as is_quality_session,
        s.levels_gained > 0 as has_progression,

        --time of day flags
        case 
            when s.session_hour between 0 and 5 then 'night'
            when s.session_hour between 6 and 11 then 'morning'
            when s.session_hour between 12 and 17 then 'afternoon'
            when s.session_hour between 18 and 23 then 'evening'
        end as time_of_day,

        --weekend flag
        s.session_day_of_week in (0, 6) as is_weekend
    from sessions s 
    left join players p on s.player_id = p.player_id 
)

select * from final
    );
  
  
[0m18:55:39.194272 [debug] [Thread-1 (]: SQL status: OK in 0.056 seconds
[0m18:55:39.196246 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.fct_sessions"
[0m18:55:39.196443 [debug] [Thread-1 (]: On model.quest_kingdom.fct_sessions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.fct_sessions"} */
alter table "quest_kingdom"."main"."fct_sessions__dbt_tmp" rename to "fct_sessions"
[0m18:55:39.196894 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:55:39.199432 [debug] [Thread-1 (]: On model.quest_kingdom.fct_sessions: COMMIT
[0m18:55:39.199620 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.fct_sessions"
[0m18:55:39.199770 [debug] [Thread-1 (]: On model.quest_kingdom.fct_sessions: COMMIT
[0m18:55:39.214962 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m18:55:39.216321 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.fct_sessions"
[0m18:55:39.216485 [debug] [Thread-1 (]: On model.quest_kingdom.fct_sessions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.fct_sessions"} */

      drop table if exists "quest_kingdom"."main"."fct_sessions__dbt_backup" cascade
    
[0m18:55:39.216808 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:55:39.217475 [debug] [Thread-1 (]: On model.quest_kingdom.fct_sessions: Close
[0m18:55:39.217742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8891146b-f07d-43e8-8ed1-e4a69a42163a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11008b470>]}
[0m18:55:39.218015 [info ] [Thread-1 (]: 7 of 7 OK created sql table model main.fct_sessions ............................ [[32mOK[0m in 0.09s]
[0m18:55:39.218255 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.fct_sessions
[0m18:55:39.218781 [debug] [MainThread]: Using duckdb connection "master"
[0m18:55:39.218915 [debug] [MainThread]: On master: BEGIN
[0m18:55:39.219033 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:55:39.219279 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:55:39.219402 [debug] [MainThread]: On master: COMMIT
[0m18:55:39.219520 [debug] [MainThread]: Using duckdb connection "master"
[0m18:55:39.219632 [debug] [MainThread]: On master: COMMIT
[0m18:55:39.219823 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:55:39.219940 [debug] [MainThread]: On master: Close
[0m18:55:39.220087 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:55:39.220200 [debug] [MainThread]: Connection 'model.quest_kingdom.fct_sessions' was properly closed.
[0m18:55:39.220356 [info ] [MainThread]: 
[0m18:55:39.220496 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m18:55:39.221072 [debug] [MainThread]: Command end result
[0m18:55:39.234728 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/manifest.json
[0m18:55:39.235813 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/semantic_manifest.json
[0m18:55:39.239013 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/run_results.json
[0m18:55:39.239179 [info ] [MainThread]: 
[0m18:55:39.239349 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:55:39.239489 [info ] [MainThread]: 
[0m18:55:39.239662 [error] [MainThread]: [31mFailure in model dim_players (models/marts/core/dim_players.sql)[0m
[0m18:55:39.239826 [error] [MainThread]:   Runtime Error in model dim_players (models/marts/core/dim_players.sql)
  Parser Error: syntax error at or near "select"
  
  LINE 68:     select 
               ^
[0m18:55:39.239949 [info ] [MainThread]: 
[0m18:55:39.240095 [info ] [MainThread]:   compiled code at target/compiled/quest_kingdom/models/marts/core/dim_players.sql
[0m18:55:39.240225 [info ] [MainThread]: 
[0m18:55:39.240364 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m18:55:39.241887 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.79725176, "process_in_blocks": "0", "process_kernel_time": 0.203878, "process_mem_max_rss": "182779904", "process_out_blocks": "0", "process_user_time": 1.279305}
[0m18:55:39.242125 [debug] [MainThread]: Command `dbt run` failed at 18:55:39.242084 after 0.80 seconds
[0m18:55:39.242319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066b5a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066b4b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e1190>]}
[0m18:55:39.242484 [debug] [MainThread]: Flushing usage events
[0m18:55:39.386566 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:57:37.039945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b6a960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d5b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d57f0>]}


============================== 18:57:37.043193 | b9dcc5c9-21fa-49cc-b4eb-3462807069cd ==============================
[0m18:57:37.043193 [info ] [MainThread]: Running with dbt=1.11.4
[0m18:57:37.043510 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'profiles_dir': '/Users/hazeldonaldson/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'partial_parse': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'empty': 'False', 'printer_width': '80', 'quiet': 'False', 'static_parser': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run', 'log_path': '/Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/logs', 'warn_error': 'None'}
[0m18:57:37.207553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9dcc5c9-21fa-49cc-b4eb-3462807069cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064b6c30>]}
[0m18:57:37.236336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9dcc5c9-21fa-49cc-b4eb-3462807069cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e15b80>]}
[0m18:57:37.237677 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:57:37.288860 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m18:57:37.358404 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:57:37.358828 [debug] [MainThread]: Partial parsing: updated file: quest_kingdom://models/marts/core/dim_players.sql
[0m18:57:37.483722 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.marts
- models.question_kingdom
- models.core
- models.staging
- models.product
- models.retention
- models.monetization
[0m18:57:37.490593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9dcc5c9-21fa-49cc-b4eb-3462807069cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10790a3f0>]}
[0m18:57:37.536119 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/manifest.json
[0m18:57:37.537541 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/semantic_manifest.json
[0m18:57:37.552473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9dcc5c9-21fa-49cc-b4eb-3462807069cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a35e50>]}
[0m18:57:37.552761 [info ] [MainThread]: Found 7 models, 23 data tests, 5 sources, 472 macros
[0m18:57:37.552930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9dcc5c9-21fa-49cc-b4eb-3462807069cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055e0e90>]}
[0m18:57:37.554048 [info ] [MainThread]: 
[0m18:57:37.554231 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:57:37.554367 [info ] [MainThread]: 
[0m18:57:37.554599 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:57:37.556854 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_quest_kingdom'
[0m18:57:37.584314 [debug] [ThreadPool]: Using duckdb connection "list_quest_kingdom"
[0m18:57:37.584552 [debug] [ThreadPool]: On list_quest_kingdom: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "list_quest_kingdom"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"quest_kingdom"'
    
  
  
[0m18:57:37.584704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:37.602245 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m18:57:37.603027 [debug] [ThreadPool]: On list_quest_kingdom: Close
[0m18:57:37.603367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_quest_kingdom, now create_quest_kingdom_main)
[0m18:57:37.603586 [debug] [ThreadPool]: Creating schema "database: "quest_kingdom"
schema: "main"
"
[0m18:57:37.606842 [debug] [ThreadPool]: Using duckdb connection "create_quest_kingdom_main"
[0m18:57:37.607014 [debug] [ThreadPool]: On create_quest_kingdom_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "create_quest_kingdom_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='quest_kingdom'
        and type='sqlite'
    
  
[0m18:57:37.607147 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:57:37.607863 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:57:37.608618 [debug] [ThreadPool]: Using duckdb connection "create_quest_kingdom_main"
[0m18:57:37.608750 [debug] [ThreadPool]: On create_quest_kingdom_main: BEGIN
[0m18:57:37.608966 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:57:37.609089 [debug] [ThreadPool]: Using duckdb connection "create_quest_kingdom_main"
[0m18:57:37.609210 [debug] [ThreadPool]: On create_quest_kingdom_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "create_quest_kingdom_main"} */

    
    
        create schema if not exists "quest_kingdom"."main"
    
[0m18:57:37.609644 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:57:37.610232 [debug] [ThreadPool]: On create_quest_kingdom_main: COMMIT
[0m18:57:37.610393 [debug] [ThreadPool]: Using duckdb connection "create_quest_kingdom_main"
[0m18:57:37.610529 [debug] [ThreadPool]: On create_quest_kingdom_main: COMMIT
[0m18:57:37.610797 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:57:37.610931 [debug] [ThreadPool]: On create_quest_kingdom_main: Close
[0m18:57:37.611591 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_quest_kingdom_main, now list_quest_kingdom_main)
[0m18:57:37.614243 [debug] [ThreadPool]: Using duckdb connection "list_quest_kingdom_main"
[0m18:57:37.614398 [debug] [ThreadPool]: On list_quest_kingdom_main: BEGIN
[0m18:57:37.614519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:57:37.614761 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:57:37.614888 [debug] [ThreadPool]: Using duckdb connection "list_quest_kingdom_main"
[0m18:57:37.615022 [debug] [ThreadPool]: On list_quest_kingdom_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "list_quest_kingdom_main"} */
select
      'quest_kingdom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'quest_kingdom'
  
[0m18:57:37.625817 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:57:37.626563 [debug] [ThreadPool]: On list_quest_kingdom_main: ROLLBACK
[0m18:57:37.627549 [debug] [ThreadPool]: Failed to rollback 'list_quest_kingdom_main'
[0m18:57:37.628475 [debug] [ThreadPool]: On list_quest_kingdom_main: Close
[0m18:57:37.629555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9dcc5c9-21fa-49cc-b4eb-3462807069cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a0b5f0>]}
[0m18:57:37.629817 [debug] [MainThread]: Using duckdb connection "master"
[0m18:57:37.629962 [debug] [MainThread]: On master: BEGIN
[0m18:57:37.630088 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:57:37.630365 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:57:37.630497 [debug] [MainThread]: On master: COMMIT
[0m18:57:37.630618 [debug] [MainThread]: Using duckdb connection "master"
[0m18:57:37.630728 [debug] [MainThread]: On master: COMMIT
[0m18:57:37.630915 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:57:37.631038 [debug] [MainThread]: On master: Close
[0m18:57:37.632367 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_ad_impressions
[0m18:57:37.632609 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg_ad_impressions ............................ [RUN]
[0m18:57:37.632808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_quest_kingdom_main, now model.quest_kingdom.stg_ad_impressions)
[0m18:57:37.632968 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_ad_impressions
[0m18:57:37.668797 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_ad_impressions"
[0m18:57:37.669582 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_ad_impressions
[0m18:57:37.683529 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.stg_ad_impressions"
[0m18:57:37.683964 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_ad_impressions"
[0m18:57:37.684133 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: BEGIN
[0m18:57:37.684282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:37.684646 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:57:37.684802 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_ad_impressions"
[0m18:57:37.684967 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_ad_impressions"} */

  
  create view "quest_kingdom"."main"."stg_ad_impressions__dbt_tmp" as (
    select
    -- ids
    ad_id,
    player_id,
    session_id,
    
    -- timestamps
    ad_timestamp::timestamp as shown_at,
    
    -- dimensions
    lower(trim(ad_type)) as ad_type,
    lower(trim(ad_network)) as ad_network,
    
    -- booleans
    clicked,
    
    -- metrics
    revenue_usd,
    
    -- derived
    date_trunc('day', ad_timestamp::timestamp)::date as ad_date

from "quest_kingdom"."main"."ad_impressions"
  );

[0m18:57:37.685674 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:57:37.688603 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_ad_impressions"
[0m18:57:37.688788 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_ad_impressions"} */
alter view "quest_kingdom"."main"."stg_ad_impressions" rename to "stg_ad_impressions__dbt_backup"
[0m18:57:37.689613 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:57:37.691011 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_ad_impressions"
[0m18:57:37.691182 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_ad_impressions"} */
alter view "quest_kingdom"."main"."stg_ad_impressions__dbt_tmp" rename to "stg_ad_impressions"
[0m18:57:37.691553 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:57:37.765214 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: COMMIT
[0m18:57:37.765589 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_ad_impressions"
[0m18:57:37.765769 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: COMMIT
[0m18:57:37.767641 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:57:37.785810 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_ad_impressions"
[0m18:57:37.786165 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_ad_impressions"} */

      drop view if exists "quest_kingdom"."main"."stg_ad_impressions__dbt_backup" cascade
    
[0m18:57:37.790970 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:57:37.792292 [debug] [Thread-1 (]: On model.quest_kingdom.stg_ad_impressions: Close
[0m18:57:37.793304 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9dcc5c9-21fa-49cc-b4eb-3462807069cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e36b0>]}
[0m18:57:37.793629 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.stg_ad_impressions ....................... [[32mOK[0m in 0.16s]
[0m18:57:37.793946 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_ad_impressions
[0m18:57:37.794138 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_events
[0m18:57:37.794386 [info ] [Thread-1 (]: 2 of 7 START sql view model main.stg_events .................................... [RUN]
[0m18:57:37.794602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_ad_impressions, now model.quest_kingdom.stg_events)
[0m18:57:37.794766 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_events
[0m18:57:37.796294 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_events"
[0m18:57:37.796722 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_events
[0m18:57:37.798421 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.stg_events"
[0m18:57:37.798748 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_events"
[0m18:57:37.798974 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: BEGIN
[0m18:57:37.799132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:37.799546 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:57:37.799759 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_events"
[0m18:57:37.799949 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_events"} */

  
  create view "quest_kingdom"."main"."stg_events__dbt_tmp" as (
    select
    -- ids
    event_id,
    player_id,
    session_id,
    
    -- timestamps
    event_timestamp::timestamp as event_at,
    
    -- dimensions
    lower(trim(event_name)) as event_name,
    
    -- json properties
    event_properties

from "quest_kingdom"."main"."events"
  );

[0m18:57:37.800417 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:57:37.802369 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_events"
[0m18:57:37.802599 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_events"} */
alter view "quest_kingdom"."main"."stg_events" rename to "stg_events__dbt_backup"
[0m18:57:37.802991 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:57:37.805260 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_events"
[0m18:57:37.805436 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_events"} */
alter view "quest_kingdom"."main"."stg_events__dbt_tmp" rename to "stg_events"
[0m18:57:37.805720 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:57:37.806417 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: COMMIT
[0m18:57:37.806572 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_events"
[0m18:57:37.806711 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: COMMIT
[0m18:57:37.807078 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:57:37.808251 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_events"
[0m18:57:37.808413 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_events"} */

      drop view if exists "quest_kingdom"."main"."stg_events__dbt_backup" cascade
    
[0m18:57:37.808756 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:57:37.809358 [debug] [Thread-1 (]: On model.quest_kingdom.stg_events: Close
[0m18:57:37.809614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9dcc5c9-21fa-49cc-b4eb-3462807069cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077f69c0>]}
[0m18:57:37.809891 [info ] [Thread-1 (]: 2 of 7 OK created sql view model main.stg_events ............................... [[32mOK[0m in 0.02s]
[0m18:57:37.810138 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_events
[0m18:57:37.810316 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_iap_transactions
[0m18:57:37.810552 [info ] [Thread-1 (]: 3 of 7 START sql view model main.stg_iap_transactions .......................... [RUN]
[0m18:57:37.810795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_events, now model.quest_kingdom.stg_iap_transactions)
[0m18:57:37.810992 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_iap_transactions
[0m18:57:37.812432 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_iap_transactions"
[0m18:57:37.812814 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_iap_transactions
[0m18:57:37.814387 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.stg_iap_transactions"
[0m18:57:37.814704 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_iap_transactions"
[0m18:57:37.814864 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: BEGIN
[0m18:57:37.815012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:37.815414 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:57:37.815623 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_iap_transactions"
[0m18:57:37.815804 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_iap_transactions"} */

  
  create view "quest_kingdom"."main"."stg_iap_transactions__dbt_tmp" as (
    select
    -- ids
    transaction_id,
    player_id,
    session_id,
    
    -- timestamps
    transaction_timestamp::timestamp as purchased_at,
    
    -- dimensions
    lower(trim(sku)) as sku,
    lower(trim(platform)) as platform,
    
    -- metrics
    price_usd,
    gems_purchased,
    
    -- derived
    date_trunc('day', transaction_timestamp::timestamp)::date as purchase_date

from "quest_kingdom"."main"."iap_transactions"
  );

[0m18:57:37.816295 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:57:37.817807 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_iap_transactions"
[0m18:57:37.817983 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_iap_transactions"} */
alter view "quest_kingdom"."main"."stg_iap_transactions" rename to "stg_iap_transactions__dbt_backup"
[0m18:57:37.818281 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:57:37.819602 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_iap_transactions"
[0m18:57:37.819761 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_iap_transactions"} */
alter view "quest_kingdom"."main"."stg_iap_transactions__dbt_tmp" rename to "stg_iap_transactions"
[0m18:57:37.820032 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:57:37.820725 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: COMMIT
[0m18:57:37.820879 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_iap_transactions"
[0m18:57:37.821015 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: COMMIT
[0m18:57:37.821396 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:57:37.822505 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_iap_transactions"
[0m18:57:37.822665 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_iap_transactions"} */

      drop view if exists "quest_kingdom"."main"."stg_iap_transactions__dbt_backup" cascade
    
[0m18:57:37.823000 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:57:37.823581 [debug] [Thread-1 (]: On model.quest_kingdom.stg_iap_transactions: Close
[0m18:57:37.823820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9dcc5c9-21fa-49cc-b4eb-3462807069cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d86c60>]}
[0m18:57:37.824085 [info ] [Thread-1 (]: 3 of 7 OK created sql view model main.stg_iap_transactions ..................... [[32mOK[0m in 0.01s]
[0m18:57:37.824322 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_iap_transactions
[0m18:57:37.824492 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_players
[0m18:57:37.824703 [info ] [Thread-1 (]: 4 of 7 START sql view model main.stg_players ................................... [RUN]
[0m18:57:37.824881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_iap_transactions, now model.quest_kingdom.stg_players)
[0m18:57:37.825037 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_players
[0m18:57:37.826358 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_players"
[0m18:57:37.826865 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_players
[0m18:57:37.828555 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.stg_players"
[0m18:57:37.829001 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:57:37.829160 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: BEGIN
[0m18:57:37.829309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:37.829859 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:57:37.830056 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:57:37.830235 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_players"} */

  
  create view "quest_kingdom"."main"."stg_players__dbt_tmp" as (
    with source as (
    select * from "quest_kingdom"."main"."players"
),

renamed as (
    select
        player_id,
        install_date::date as installed_at,
        --dimensions
        lower(trim(attribution_channel)) as attribution_channel,
        lower(trim(country)) as country,
        lower(trim(device_type)) as device_type,
        lower(trim(player_segment)) as player_segment,
        lower(trim(experiment_variant)) as experiment_variant,
        --booleans
        tutorial_completed,
        --metrics
        lifetime_value as lifetime_value_usd
    from source 
)

select * from renamed
  );

[0m18:57:37.830851 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:57:37.832638 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:57:37.832808 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_players"} */
alter view "quest_kingdom"."main"."stg_players" rename to "stg_players__dbt_backup"
[0m18:57:37.833121 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:57:37.835385 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:57:37.835556 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_players"} */
alter view "quest_kingdom"."main"."stg_players__dbt_tmp" rename to "stg_players"
[0m18:57:37.835844 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:57:37.836543 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: COMMIT
[0m18:57:37.836700 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:57:37.836844 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: COMMIT
[0m18:57:37.837260 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:57:37.838361 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_players"
[0m18:57:37.838519 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_players"} */

      drop view if exists "quest_kingdom"."main"."stg_players__dbt_backup" cascade
    
[0m18:57:37.838856 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:57:37.839440 [debug] [Thread-1 (]: On model.quest_kingdom.stg_players: Close
[0m18:57:37.839683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9dcc5c9-21fa-49cc-b4eb-3462807069cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e6aba0>]}
[0m18:57:37.839952 [info ] [Thread-1 (]: 4 of 7 OK created sql view model main.stg_players .............................. [[32mOK[0m in 0.01s]
[0m18:57:37.840193 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_players
[0m18:57:37.840366 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_sessions
[0m18:57:37.840575 [info ] [Thread-1 (]: 5 of 7 START sql view model main.stg_sessions .................................. [RUN]
[0m18:57:37.840754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_players, now model.quest_kingdom.stg_sessions)
[0m18:57:37.840909 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_sessions
[0m18:57:37.842231 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_sessions"
[0m18:57:37.842596 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_sessions
[0m18:57:37.844173 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.stg_sessions"
[0m18:57:37.844532 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_sessions"
[0m18:57:37.844695 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: BEGIN
[0m18:57:37.844843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:37.845189 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:57:37.845340 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_sessions"
[0m18:57:37.845506 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_sessions"} */

  
  create view "quest_kingdom"."main"."stg_sessions__dbt_tmp" as (
    with source as (
    select * from "quest_kingdom"."main"."sessions"
),

renamed as (
    select 
        session_id,
        player_id,
        --timestamps
        session_start::timestamp as session_started_at,
        session_end::timestamp as session_ended_at,

        --metrics
        session_duration_minutes,
        starting_level,
        ending_level,
        levels_gained,

        --derived metrics
        extract(hour from session_start::timestamp) as session_hour,
        extract(dow from session_start::timestamp) as session_day_of_week,
        date_trunc('day', session_start::timestamp)::date as session_date 
    from source
)

select * from renamed
  );

[0m18:57:37.846634 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:57:37.848275 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_sessions"
[0m18:57:37.848446 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_sessions"} */
alter view "quest_kingdom"."main"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m18:57:37.848775 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:57:37.850086 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_sessions"
[0m18:57:37.850242 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_sessions"} */
alter view "quest_kingdom"."main"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m18:57:37.850530 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:57:37.851203 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: COMMIT
[0m18:57:37.851363 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_sessions"
[0m18:57:37.851505 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: COMMIT
[0m18:57:37.851949 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:57:37.853105 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.stg_sessions"
[0m18:57:37.853272 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.stg_sessions"} */

      drop view if exists "quest_kingdom"."main"."stg_sessions__dbt_backup" cascade
    
[0m18:57:37.853624 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:57:37.854219 [debug] [Thread-1 (]: On model.quest_kingdom.stg_sessions: Close
[0m18:57:37.854471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9dcc5c9-21fa-49cc-b4eb-3462807069cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e788f0>]}
[0m18:57:37.854752 [info ] [Thread-1 (]: 5 of 7 OK created sql view model main.stg_sessions ............................. [[32mOK[0m in 0.01s]
[0m18:57:37.855000 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_sessions
[0m18:57:37.855329 [debug] [Thread-1 (]: Began running node model.quest_kingdom.dim_players
[0m18:57:37.855576 [info ] [Thread-1 (]: 6 of 7 START sql table model main.dim_players .................................. [RUN]
[0m18:57:37.855794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_sessions, now model.quest_kingdom.dim_players)
[0m18:57:37.855956 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.dim_players
[0m18:57:37.858112 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.dim_players"
[0m18:57:37.858839 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.dim_players
[0m18:57:37.870827 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.dim_players"
[0m18:57:37.871629 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.dim_players"
[0m18:57:37.871828 [debug] [Thread-1 (]: On model.quest_kingdom.dim_players: BEGIN
[0m18:57:37.871987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:37.872426 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:57:37.872585 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.dim_players"
[0m18:57:37.872831 [debug] [Thread-1 (]: On model.quest_kingdom.dim_players: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.dim_players"} */

  
    
    

    create  table
      "quest_kingdom"."main"."dim_players__dbt_tmp"
  
    as (
      

with players as (

    select * from "quest_kingdom"."main"."stg_players"

),

sessions as (

    select * from "quest_kingdom"."main"."stg_sessions"

),

transactions as (

    select * from "quest_kingdom"."main"."stg_iap_transactions"

),

ads as (

    select * from "quest_kingdom"."main"."stg_ad_impressions"

),

-- Aggregate session metrics per player
player_sessions as (

    select
        player_id,
        count(*) as total_sessions,
        min(session_started_at) as first_session_at,
        max(session_started_at) as last_session_at,
        sum(session_duration_minutes) as total_play_time_minutes,
        avg(session_duration_minutes) as avg_session_duration_minutes,
        max(ending_level) as max_level_reached

    from sessions
    group by player_id

),

-- Aggregate IAP metrics per player
player_iap as (

    select
        player_id,
        count(*) as total_purchases,
        sum(price_usd) as total_iap_revenue,
        min(purchased_at) as first_purchase_at,
        avg(price_usd) as avg_purchase_value

    from transactions
    group by player_id

),

-- Aggregate ad metrics per player
player_ads as (

    select
        player_id,
        count(*) as total_ad_impressions,
        sum(revenue_usd) as total_ad_revenue,
        sum(case when clicked then 1 else 0 end) as total_ad_clicks

    from ads
    group by player_id

),

-- Combine everything
final as (

    select
        -- player attributes
        p.player_id,
        p.installed_at,
        p.attribution_channel,
        p.country,
        p.device_type,
        p.player_segment,
        p.experiment_variant,
        p.tutorial_completed,
        
        -- session metrics
        coalesce(ps.total_sessions, 0) as total_sessions,
        ps.first_session_at,
        ps.last_session_at,
        coalesce(ps.total_play_time_minutes, 0) as total_play_time_minutes,
        ps.avg_session_duration_minutes,
        coalesce(ps.max_level_reached, 0) as max_level_reached,
        
        -- monetization metrics
        coalesce(pi.total_purchases, 0) as total_purchases,
        coalesce(pi.total_iap_revenue, 0) as total_iap_revenue,
        pi.first_purchase_at,
        pi.avg_purchase_value,
        
        coalesce(pa.total_ad_impressions, 0) as total_ad_impressions,
        coalesce(pa.total_ad_revenue, 0) as total_ad_revenue,
        coalesce(pa.total_ad_clicks, 0) as total_ad_clicks,
        
        -- derived total revenue
        coalesce(pi.total_iap_revenue, 0) + coalesce(pa.total_ad_revenue, 0) as total_revenue,
        
        -- derived days metrics
        datediff('day', p.installed_at, current_date) as days_since_install,
        case 
            when ps.last_session_at is not null 
            then datediff('day', ps.last_session_at, current_date)
            else null
        end as days_since_last_session,
        case 
            when pi.first_purchase_at is not null 
            then datediff('day', p.installed_at, pi.first_purchase_at)
            else null
        end as days_to_first_purchase,
        
        -- derived flags
        coalesce(ps.total_sessions, 0) > 0 as is_activated,
        coalesce(pi.total_purchases, 0) > 0 as is_payer,
        coalesce(pa.total_ad_impressions, 0) > 0 as has_seen_ads

    from players p
    left join player_sessions ps on p.player_id = ps.player_id
    left join player_iap pi on p.player_id = pi.player_id
    left join player_ads pa on p.player_id = pa.player_id

)

select * from final
    );
  
  
[0m18:57:37.914854 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m18:57:37.920181 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.dim_players"
[0m18:57:37.920507 [debug] [Thread-1 (]: On model.quest_kingdom.dim_players: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.dim_players"} */
alter table "quest_kingdom"."main"."dim_players__dbt_tmp" rename to "dim_players"
[0m18:57:37.921107 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:57:37.923776 [debug] [Thread-1 (]: On model.quest_kingdom.dim_players: COMMIT
[0m18:57:37.923965 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.dim_players"
[0m18:57:37.924125 [debug] [Thread-1 (]: On model.quest_kingdom.dim_players: COMMIT
[0m18:57:37.928122 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:57:37.930446 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.dim_players"
[0m18:57:37.930620 [debug] [Thread-1 (]: On model.quest_kingdom.dim_players: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.dim_players"} */

      drop table if exists "quest_kingdom"."main"."dim_players__dbt_backup" cascade
    
[0m18:57:37.930929 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:57:37.931582 [debug] [Thread-1 (]: On model.quest_kingdom.dim_players: Close
[0m18:57:37.931845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9dcc5c9-21fa-49cc-b4eb-3462807069cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e9ce60>]}
[0m18:57:37.932137 [info ] [Thread-1 (]: 6 of 7 OK created sql table model main.dim_players ............................. [[32mOK[0m in 0.08s]
[0m18:57:37.932394 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.dim_players
[0m18:57:37.932574 [debug] [Thread-1 (]: Began running node model.quest_kingdom.fct_sessions
[0m18:57:37.932801 [info ] [Thread-1 (]: 7 of 7 START sql table model main.fct_sessions ................................. [RUN]
[0m18:57:37.932986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.dim_players, now model.quest_kingdom.fct_sessions)
[0m18:57:37.933142 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.fct_sessions
[0m18:57:37.934757 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.fct_sessions"
[0m18:57:37.935166 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.fct_sessions
[0m18:57:37.936677 [debug] [Thread-1 (]: Writing runtime sql for node "model.quest_kingdom.fct_sessions"
[0m18:57:37.936984 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.fct_sessions"
[0m18:57:37.937138 [debug] [Thread-1 (]: On model.quest_kingdom.fct_sessions: BEGIN
[0m18:57:37.937282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:37.937576 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:57:37.937728 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.fct_sessions"
[0m18:57:37.937919 [debug] [Thread-1 (]: On model.quest_kingdom.fct_sessions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.fct_sessions"} */

  
    
    

    create  table
      "quest_kingdom"."main"."fct_sessions__dbt_tmp"
  
    as (
      

with sessions as (
    select * from "quest_kingdom"."main"."stg_sessions"
),

players as (
    select * from "quest_kingdom"."main"."stg_players"
),

final as (
    select 
        s.session_id,
        s.player_id,
        s.session_started_at,
        s.session_ended_at,
        s.session_duration_minutes,
        s.starting_level,
        s.ending_level,
        s.levels_gained,
        s.session_hour,
        s.session_day_of_week,
        s.session_date,

        --player context
        p.installed_at,
        p.attribution_channel,
        p.country,
        p.device_type,
        p.player_segment,
        p.experiment_variant,
        p.tutorial_completed,

        --derived metrics
        datediff('day', p.installed_at, s.session_started_at) as days_since_install,
        --session quality flags
        s.session_duration_minutes >= 5 as is_quality_session,
        s.levels_gained > 0 as has_progression,

        --time of day flags
        case 
            when s.session_hour between 0 and 5 then 'night'
            when s.session_hour between 6 and 11 then 'morning'
            when s.session_hour between 12 and 17 then 'afternoon'
            when s.session_hour between 18 and 23 then 'evening'
        end as time_of_day,

        --weekend flag
        s.session_day_of_week in (0, 6) as is_weekend
    from sessions s 
    left join players p on s.player_id = p.player_id 
)

select * from final
    );
  
  
[0m18:57:37.982614 [debug] [Thread-1 (]: SQL status: OK in 0.044 seconds
[0m18:57:37.987407 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.fct_sessions"
[0m18:57:37.987648 [debug] [Thread-1 (]: On model.quest_kingdom.fct_sessions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.fct_sessions"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fct_sessions'
  
[0m18:57:37.988236 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:57:37.988922 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.fct_sessions"
[0m18:57:37.989099 [debug] [Thread-1 (]: On model.quest_kingdom.fct_sessions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.fct_sessions"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fct_sessions'
  
[0m18:57:37.990986 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:57:37.993362 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.fct_sessions"
[0m18:57:37.993560 [debug] [Thread-1 (]: On model.quest_kingdom.fct_sessions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.fct_sessions"} */
alter table "quest_kingdom"."main"."fct_sessions" rename to "fct_sessions__dbt_backup"
[0m18:57:37.994067 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:57:37.995700 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.fct_sessions"
[0m18:57:37.995893 [debug] [Thread-1 (]: On model.quest_kingdom.fct_sessions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.fct_sessions"} */
alter table "quest_kingdom"."main"."fct_sessions__dbt_tmp" rename to "fct_sessions"
[0m18:57:37.996230 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:57:37.997119 [debug] [Thread-1 (]: On model.quest_kingdom.fct_sessions: COMMIT
[0m18:57:37.997288 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.fct_sessions"
[0m18:57:37.997438 [debug] [Thread-1 (]: On model.quest_kingdom.fct_sessions: COMMIT
[0m18:57:38.016421 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m18:57:38.017856 [debug] [Thread-1 (]: Using duckdb connection "model.quest_kingdom.fct_sessions"
[0m18:57:38.018041 [debug] [Thread-1 (]: On model.quest_kingdom.fct_sessions: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "model.quest_kingdom.fct_sessions"} */

      drop table if exists "quest_kingdom"."main"."fct_sessions__dbt_backup" cascade
    
[0m18:57:38.018737 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:57:38.019484 [debug] [Thread-1 (]: On model.quest_kingdom.fct_sessions: Close
[0m18:57:38.019787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9dcc5c9-21fa-49cc-b4eb-3462807069cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d99400>]}
[0m18:57:38.020105 [info ] [Thread-1 (]: 7 of 7 OK created sql table model main.fct_sessions ............................ [[32mOK[0m in 0.09s]
[0m18:57:38.020371 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.fct_sessions
[0m18:57:38.021061 [debug] [MainThread]: Using duckdb connection "master"
[0m18:57:38.021252 [debug] [MainThread]: On master: BEGIN
[0m18:57:38.021403 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:57:38.021733 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:57:38.021876 [debug] [MainThread]: On master: COMMIT
[0m18:57:38.022009 [debug] [MainThread]: Using duckdb connection "master"
[0m18:57:38.022137 [debug] [MainThread]: On master: COMMIT
[0m18:57:38.022352 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:57:38.022480 [debug] [MainThread]: On master: Close
[0m18:57:38.022653 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:57:38.022775 [debug] [MainThread]: Connection 'model.quest_kingdom.fct_sessions' was properly closed.
[0m18:57:38.022959 [info ] [MainThread]: 
[0m18:57:38.023116 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m18:57:38.024511 [debug] [MainThread]: Command end result
[0m18:57:38.045489 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/manifest.json
[0m18:57:38.046585 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/semantic_manifest.json
[0m18:57:38.049818 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/run_results.json
[0m18:57:38.049995 [info ] [MainThread]: 
[0m18:57:38.050174 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:57:38.050316 [info ] [MainThread]: 
[0m18:57:38.050475 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m18:57:38.051905 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0558699, "process_in_blocks": "0", "process_kernel_time": 0.215149, "process_mem_max_rss": "204636160", "process_out_blocks": "0", "process_user_time": 1.451177}
[0m18:57:38.052120 [debug] [MainThread]: Command `dbt run` succeeded at 18:57:38.052081 after 1.06 seconds
[0m18:57:38.052299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a362d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d0ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10781a270>]}
[0m18:57:38.052463 [debug] [MainThread]: Flushing usage events
[0m18:57:38.188028 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:58:06.259453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a90620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108757e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109518140>]}


============================== 18:58:06.263372 | 4efc26f8-b44b-4c68-8077-27f19fb4a04b ==============================
[0m18:58:06.263372 [info ] [MainThread]: Running with dbt=1.11.4
[0m18:58:06.263724 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'no_print': 'None', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'partial_parse': 'True', 'quiet': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_path': '/Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/logs', 'invocation_command': 'dbt test', 'indirect_selection': 'eager', 'profiles_dir': '/Users/hazeldonaldson/.dbt', 'log_format': 'default', 'use_colors': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'target_path': 'None', 'log_cache_events': 'False', 'introspect': 'True'}
[0m18:58:06.451089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4efc26f8-b44b-4c68-8077-27f19fb4a04b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096e2630>]}
[0m18:58:06.479707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4efc26f8-b44b-4c68-8077-27f19fb4a04b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d72f0>]}
[0m18:58:06.480998 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:58:06.534149 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m18:58:06.606648 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:58:06.606906 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:58:06.607049 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:58:06.610279 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.retention
- models.monetization
- models.product
- models.core
- models.question_kingdom
- models.marts
- models.staging
[0m18:58:06.629772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4efc26f8-b44b-4c68-8077-27f19fb4a04b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109900980>]}
[0m18:58:06.671680 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/manifest.json
[0m18:58:06.673028 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/semantic_manifest.json
[0m18:58:06.689676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4efc26f8-b44b-4c68-8077-27f19fb4a04b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cd3e00>]}
[0m18:58:06.689977 [info ] [MainThread]: Found 7 models, 23 data tests, 5 sources, 472 macros
[0m18:58:06.690157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4efc26f8-b44b-4c68-8077-27f19fb4a04b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ca1c40>]}
[0m18:58:06.695079 [info ] [MainThread]: 
[0m18:58:06.695303 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:58:06.695497 [info ] [MainThread]: 
[0m18:58:06.695797 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:58:06.698692 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_quest_kingdom_main'
[0m18:58:06.726721 [debug] [ThreadPool]: Using duckdb connection "list_quest_kingdom_main"
[0m18:58:06.726956 [debug] [ThreadPool]: On list_quest_kingdom_main: BEGIN
[0m18:58:06.727099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:06.739813 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m18:58:06.740059 [debug] [ThreadPool]: Using duckdb connection "list_quest_kingdom_main"
[0m18:58:06.740215 [debug] [ThreadPool]: On list_quest_kingdom_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "list_quest_kingdom_main"} */
select
      'quest_kingdom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'quest_kingdom'
  
[0m18:58:06.754497 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m18:58:06.755444 [debug] [ThreadPool]: On list_quest_kingdom_main: ROLLBACK
[0m18:58:06.756396 [debug] [ThreadPool]: Failed to rollback 'list_quest_kingdom_main'
[0m18:58:06.756567 [debug] [ThreadPool]: On list_quest_kingdom_main: Close
[0m18:58:06.757718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4efc26f8-b44b-4c68-8077-27f19fb4a04b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109900b60>]}
[0m18:58:06.757959 [debug] [MainThread]: Using duckdb connection "master"
[0m18:58:06.758100 [debug] [MainThread]: On master: BEGIN
[0m18:58:06.758223 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:58:06.758504 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:58:06.758640 [debug] [MainThread]: On master: COMMIT
[0m18:58:06.758770 [debug] [MainThread]: Using duckdb connection "master"
[0m18:58:06.758893 [debug] [MainThread]: On master: COMMIT
[0m18:58:06.759096 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:58:06.759226 [debug] [MainThread]: On master: Close
[0m18:58:06.760759 [debug] [Thread-1 (]: Began running node test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36
[0m18:58:06.760952 [info ] [Thread-1 (]: 1 of 23 START test accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated  [RUN]
[0m18:58:06.761196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_quest_kingdom_main, now test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36)
[0m18:58:06.761387 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36
[0m18:58:06.769633 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36"
[0m18:58:06.770220 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36
[0m18:58:06.779208 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36"
[0m18:58:06.779911 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36"
[0m18:58:06.780121 [debug] [Thread-1 (]: On test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36: BEGIN
[0m18:58:06.780283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:06.780658 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:58:06.780826 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36"
[0m18:58:06.781004 [debug] [Thread-1 (]: On test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        event_name as value_field,
        count(*) as n_records

    from "quest_kingdom"."main"."stg_events"
    group by event_name

)

select *
from all_values
where value_field not in (
    'tutorial_completed','level_completed','boss_defeated'
)



  
  
      
    ) dbt_internal_test
[0m18:58:06.785728 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:58:06.787956 [debug] [Thread-1 (]: On test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36: ROLLBACK
[0m18:58:06.788437 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36'
[0m18:58:06.788605 [debug] [Thread-1 (]: On test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36: Close
[0m18:58:06.788884 [info ] [Thread-1 (]: 1 of 23 PASS accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated  [[32mPASS[0m in 0.03s]
[0m18:58:06.789140 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36
[0m18:58:06.789324 [debug] [Thread-1 (]: Began running node test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd
[0m18:58:06.789518 [info ] [Thread-1 (]: 2 of 23 START test accepted_values_stg_players_device_type__ios__android ....... [RUN]
[0m18:58:06.789710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36, now test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd)
[0m18:58:06.789869 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd
[0m18:58:06.792364 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd"
[0m18:58:06.792737 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd
[0m18:58:06.793872 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd"
[0m18:58:06.794336 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd"
[0m18:58:06.794519 [debug] [Thread-1 (]: On test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd: BEGIN
[0m18:58:06.794685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:06.795111 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:58:06.795270 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd"
[0m18:58:06.795433 [debug] [Thread-1 (]: On test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        device_type as value_field,
        count(*) as n_records

    from "quest_kingdom"."main"."stg_players"
    group by device_type

)

select *
from all_values
where value_field not in (
    'ios','android'
)



  
  
      
    ) dbt_internal_test
[0m18:58:06.796948 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:58:06.797809 [debug] [Thread-1 (]: On test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd: ROLLBACK
[0m18:58:06.798317 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd'
[0m18:58:06.798482 [debug] [Thread-1 (]: On test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd: Close
[0m18:58:06.798770 [info ] [Thread-1 (]: 2 of 23 PASS accepted_values_stg_players_device_type__ios__android ............. [[32mPASS[0m in 0.01s]
[0m18:58:06.799023 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd
[0m18:58:06.799205 [debug] [Thread-1 (]: Began running node test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a
[0m18:58:06.799397 [info ] [Thread-1 (]: 3 of 23 START test accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer  [RUN]
[0m18:58:06.799585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd, now test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a)
[0m18:58:06.799748 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a
[0m18:58:06.802882 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a"
[0m18:58:06.803299 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a
[0m18:58:06.805247 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a"
[0m18:58:06.805805 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a"
[0m18:58:06.805980 [debug] [Thread-1 (]: On test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a: BEGIN
[0m18:58:06.806138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:06.806536 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:58:06.806728 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a"
[0m18:58:06.806910 [debug] [Thread-1 (]: On test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        player_segment as value_field,
        count(*) as n_records

    from "quest_kingdom"."main"."stg_players"
    group by player_segment

)

select *
from all_values
where value_field not in (
    'whale','dolphin','minnow','non_payer'
)



  
  
      
    ) dbt_internal_test
[0m18:58:06.808317 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:58:06.809080 [debug] [Thread-1 (]: On test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a: ROLLBACK
[0m18:58:06.809539 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a'
[0m18:58:06.809697 [debug] [Thread-1 (]: On test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a: Close
[0m18:58:06.809983 [info ] [Thread-1 (]: 3 of 23 PASS accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer  [[32mPASS[0m in 0.01s]
[0m18:58:06.810239 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a
[0m18:58:06.810416 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c
[0m18:58:06.810598 [info ] [Thread-1 (]: 4 of 23 START test not_null_stg_ad_impressions_ad_id ........................... [RUN]
[0m18:58:06.810779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a, now test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c)
[0m18:58:06.810932 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c
[0m18:58:06.814990 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c"
[0m18:58:06.815618 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c
[0m18:58:06.817007 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c"
[0m18:58:06.817668 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c"
[0m18:58:06.817831 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c: BEGIN
[0m18:58:06.817975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:06.818327 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:58:06.818476 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c"
[0m18:58:06.818634 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ad_id
from "quest_kingdom"."main"."stg_ad_impressions"
where ad_id is null



  
  
      
    ) dbt_internal_test
[0m18:58:06.819282 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:58:06.820044 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c: ROLLBACK
[0m18:58:06.820512 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c'
[0m18:58:06.820661 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c: Close
[0m18:58:06.820914 [info ] [Thread-1 (]: 4 of 23 PASS not_null_stg_ad_impressions_ad_id ................................. [[32mPASS[0m in 0.01s]
[0m18:58:06.821154 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c
[0m18:58:06.821323 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19
[0m18:58:06.821503 [info ] [Thread-1 (]: 5 of 23 START test not_null_stg_ad_impressions_player_id ....................... [RUN]
[0m18:58:06.821685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c, now test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19)
[0m18:58:06.821840 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19
[0m18:58:06.823925 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19"
[0m18:58:06.824335 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19
[0m18:58:06.825460 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19"
[0m18:58:06.825777 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19"
[0m18:58:06.825943 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19: BEGIN
[0m18:58:06.826089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:06.826426 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:58:06.826571 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19"
[0m18:58:06.826724 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select player_id
from "quest_kingdom"."main"."stg_ad_impressions"
where player_id is null



  
  
      
    ) dbt_internal_test
[0m18:58:06.827464 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:58:06.828343 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19: ROLLBACK
[0m18:58:06.828839 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19'
[0m18:58:06.828998 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19: Close
[0m18:58:06.829287 [info ] [Thread-1 (]: 5 of 23 PASS not_null_stg_ad_impressions_player_id ............................. [[32mPASS[0m in 0.01s]
[0m18:58:06.829534 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19
[0m18:58:06.829833 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_events_event_id.715b3f7012
[0m18:58:06.830074 [info ] [Thread-1 (]: 6 of 23 START test not_null_stg_events_event_id ................................ [RUN]
[0m18:58:06.830404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19, now test.quest_kingdom.not_null_stg_events_event_id.715b3f7012)
[0m18:58:06.830633 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_events_event_id.715b3f7012
[0m18:58:06.832752 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_events_event_id.715b3f7012"
[0m18:58:06.833173 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_events_event_id.715b3f7012
[0m18:58:06.834325 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.not_null_stg_events_event_id.715b3f7012"
[0m18:58:06.834643 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_events_event_id.715b3f7012"
[0m18:58:06.834804 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_events_event_id.715b3f7012: BEGIN
[0m18:58:06.834945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:06.835293 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:58:06.835441 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_events_event_id.715b3f7012"
[0m18:58:06.835598 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_events_event_id.715b3f7012: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.not_null_stg_events_event_id.715b3f7012"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "quest_kingdom"."main"."stg_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m18:58:06.836192 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:58:06.836983 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_events_event_id.715b3f7012: ROLLBACK
[0m18:58:06.837454 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.not_null_stg_events_event_id.715b3f7012'
[0m18:58:06.837603 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_events_event_id.715b3f7012: Close
[0m18:58:06.837873 [info ] [Thread-1 (]: 6 of 23 PASS not_null_stg_events_event_id ...................................... [[32mPASS[0m in 0.01s]
[0m18:58:06.838115 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_events_event_id.715b3f7012
[0m18:58:06.838288 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3
[0m18:58:06.838472 [info ] [Thread-1 (]: 7 of 23 START test not_null_stg_events_event_name .............................. [RUN]
[0m18:58:06.838660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_events_event_id.715b3f7012, now test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3)
[0m18:58:06.838815 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3
[0m18:58:06.840807 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3"
[0m18:58:06.841184 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3
[0m18:58:06.842276 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3"
[0m18:58:06.842594 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3"
[0m18:58:06.842750 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3: BEGIN
[0m18:58:06.842890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:06.843234 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:58:06.843380 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3"
[0m18:58:06.843533 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_name
from "quest_kingdom"."main"."stg_events"
where event_name is null



  
  
      
    ) dbt_internal_test
[0m18:58:06.844723 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:58:06.845730 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3: ROLLBACK
[0m18:58:06.846217 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3'
[0m18:58:06.846378 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3: Close
[0m18:58:06.846690 [info ] [Thread-1 (]: 7 of 23 PASS not_null_stg_events_event_name .................................... [[32mPASS[0m in 0.01s]
[0m18:58:06.846944 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3
[0m18:58:06.847125 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5
[0m18:58:06.847334 [info ] [Thread-1 (]: 8 of 23 START test not_null_stg_events_player_id ............................... [RUN]
[0m18:58:06.847562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3, now test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5)
[0m18:58:06.847738 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5
[0m18:58:06.849776 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5"
[0m18:58:06.850154 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5
[0m18:58:06.851285 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5"
[0m18:58:06.851603 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5"
[0m18:58:06.851759 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5: BEGIN
[0m18:58:06.851902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:06.852256 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:58:06.852405 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5"
[0m18:58:06.852562 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select player_id
from "quest_kingdom"."main"."stg_events"
where player_id is null



  
  
      
    ) dbt_internal_test
[0m18:58:06.853206 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:58:06.854005 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5: ROLLBACK
[0m18:58:06.854507 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5'
[0m18:58:06.854663 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5: Close
[0m18:58:06.854925 [info ] [Thread-1 (]: 8 of 23 PASS not_null_stg_events_player_id ..................................... [[32mPASS[0m in 0.01s]
[0m18:58:06.855167 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5
[0m18:58:06.855345 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d
[0m18:58:06.855553 [info ] [Thread-1 (]: 9 of 23 START test not_null_stg_iap_transactions_player_id ..................... [RUN]
[0m18:58:06.855769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5, now test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d)
[0m18:58:06.855936 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d
[0m18:58:06.858783 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d"
[0m18:58:06.859295 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d
[0m18:58:06.893579 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d"
[0m18:58:06.896428 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d"
[0m18:58:06.896646 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d: BEGIN
[0m18:58:06.896811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:06.897165 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:58:06.897321 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d"
[0m18:58:06.897481 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select player_id
from "quest_kingdom"."main"."stg_iap_transactions"
where player_id is null



  
  
      
    ) dbt_internal_test
[0m18:58:06.898082 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:58:06.898825 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d: ROLLBACK
[0m18:58:06.899288 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d'
[0m18:58:06.899445 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d: Close
[0m18:58:06.899695 [info ] [Thread-1 (]: 9 of 23 PASS not_null_stg_iap_transactions_player_id ........................... [[32mPASS[0m in 0.04s]
[0m18:58:06.899927 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d
[0m18:58:06.900099 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079
[0m18:58:06.900276 [info ] [Thread-1 (]: 10 of 23 START test not_null_stg_iap_transactions_price_usd .................... [RUN]
[0m18:58:06.900449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d, now test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079)
[0m18:58:06.900601 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079
[0m18:58:06.902554 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079"
[0m18:58:06.902923 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079
[0m18:58:06.904007 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079"
[0m18:58:06.904313 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079"
[0m18:58:06.904469 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079: BEGIN
[0m18:58:06.904607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:06.904890 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:58:06.905036 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079"
[0m18:58:06.905189 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price_usd
from "quest_kingdom"."main"."stg_iap_transactions"
where price_usd is null



  
  
      
    ) dbt_internal_test
[0m18:58:06.905847 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:58:06.906753 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079: ROLLBACK
[0m18:58:06.907316 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079'
[0m18:58:06.907495 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079: Close
[0m18:58:06.907793 [info ] [Thread-1 (]: 10 of 23 PASS not_null_stg_iap_transactions_price_usd .......................... [[32mPASS[0m in 0.01s]
[0m18:58:06.908045 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079
[0m18:58:06.908224 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645
[0m18:58:06.908429 [info ] [Thread-1 (]: 11 of 23 START test not_null_stg_iap_transactions_transaction_id ............... [RUN]
[0m18:58:06.908653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079, now test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645)
[0m18:58:06.908822 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645
[0m18:58:06.910799 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645"
[0m18:58:06.911209 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645
[0m18:58:06.912341 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645"
[0m18:58:06.912665 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645"
[0m18:58:06.912821 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645: BEGIN
[0m18:58:06.912963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:06.913308 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:58:06.913455 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645"
[0m18:58:06.913613 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_id
from "quest_kingdom"."main"."stg_iap_transactions"
where transaction_id is null



  
  
      
    ) dbt_internal_test
[0m18:58:06.914326 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:58:06.915138 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645: ROLLBACK
[0m18:58:06.915620 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645'
[0m18:58:06.915783 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645: Close
[0m18:58:06.916042 [info ] [Thread-1 (]: 11 of 23 PASS not_null_stg_iap_transactions_transaction_id ..................... [[32mPASS[0m in 0.01s]
[0m18:58:06.916280 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645
[0m18:58:06.916453 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb
[0m18:58:06.916630 [info ] [Thread-1 (]: 12 of 23 START test not_null_stg_players_installed_at .......................... [RUN]
[0m18:58:06.916804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645, now test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb)
[0m18:58:06.916956 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb
[0m18:58:06.918991 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb"
[0m18:58:06.919405 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb
[0m18:58:06.920507 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb"
[0m18:58:06.920829 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb"
[0m18:58:06.920989 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb: BEGIN
[0m18:58:06.921134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:06.921505 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:58:06.921659 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb"
[0m18:58:06.921818 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select installed_at
from "quest_kingdom"."main"."stg_players"
where installed_at is null



  
  
      
    ) dbt_internal_test
[0m18:58:06.922732 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:58:06.923575 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb: ROLLBACK
[0m18:58:06.924065 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb'
[0m18:58:06.924220 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb: Close
[0m18:58:06.924487 [info ] [Thread-1 (]: 12 of 23 PASS not_null_stg_players_installed_at ................................ [[32mPASS[0m in 0.01s]
[0m18:58:06.924732 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb
[0m18:58:06.924909 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b
[0m18:58:06.925093 [info ] [Thread-1 (]: 13 of 23 START test not_null_stg_players_player_id ............................. [RUN]
[0m18:58:06.925272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb, now test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b)
[0m18:58:06.925429 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b
[0m18:58:06.927515 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b"
[0m18:58:06.929647 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b
[0m18:58:06.931040 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b"
[0m18:58:06.931495 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b"
[0m18:58:06.931686 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b: BEGIN
[0m18:58:06.931841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:06.932182 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:58:06.932336 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b"
[0m18:58:06.932496 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select player_id
from "quest_kingdom"."main"."stg_players"
where player_id is null



  
  
      
    ) dbt_internal_test
[0m18:58:06.933230 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:58:06.933995 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b: ROLLBACK
[0m18:58:06.934453 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b'
[0m18:58:06.934605 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b: Close
[0m18:58:06.934864 [info ] [Thread-1 (]: 13 of 23 PASS not_null_stg_players_player_id ................................... [[32mPASS[0m in 0.01s]
[0m18:58:06.935113 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b
[0m18:58:06.935299 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29
[0m18:58:06.935512 [info ] [Thread-1 (]: 14 of 23 START test not_null_stg_sessions_player_id ............................ [RUN]
[0m18:58:06.935761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b, now test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29)
[0m18:58:06.935940 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29
[0m18:58:06.938084 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29"
[0m18:58:06.938500 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29
[0m18:58:06.940617 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29"
[0m18:58:06.941020 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29"
[0m18:58:06.941204 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29: BEGIN
[0m18:58:06.941358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:06.941723 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:58:06.941875 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29"
[0m18:58:06.942030 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select player_id
from "quest_kingdom"."main"."stg_sessions"
where player_id is null



  
  
      
    ) dbt_internal_test
[0m18:58:06.942866 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:58:06.943685 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29: ROLLBACK
[0m18:58:06.944173 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29'
[0m18:58:06.944336 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29: Close
[0m18:58:06.944691 [info ] [Thread-1 (]: 14 of 23 PASS not_null_stg_sessions_player_id .................................. [[32mPASS[0m in 0.01s]
[0m18:58:06.944976 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29
[0m18:58:06.945181 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d
[0m18:58:06.945416 [info ] [Thread-1 (]: 15 of 23 START test not_null_stg_sessions_session_id ........................... [RUN]
[0m18:58:06.945976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29, now test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d)
[0m18:58:06.946167 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d
[0m18:58:06.948226 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d"
[0m18:58:06.948623 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d
[0m18:58:06.949800 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d"
[0m18:58:06.950110 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d"
[0m18:58:06.950266 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d: BEGIN
[0m18:58:06.950409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:06.950782 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:58:06.950933 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d"
[0m18:58:06.951092 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_id
from "quest_kingdom"."main"."stg_sessions"
where session_id is null



  
  
      
    ) dbt_internal_test
[0m18:58:06.951999 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:58:06.952836 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d: ROLLBACK
[0m18:58:06.953317 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d'
[0m18:58:06.953474 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d: Close
[0m18:58:06.953742 [info ] [Thread-1 (]: 15 of 23 PASS not_null_stg_sessions_session_id ................................. [[32mPASS[0m in 0.01s]
[0m18:58:06.953994 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d
[0m18:58:06.954175 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09
[0m18:58:06.954356 [info ] [Thread-1 (]: 16 of 23 START test not_null_stg_sessions_session_started_at ................... [RUN]
[0m18:58:06.954539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d, now test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09)
[0m18:58:06.954702 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09
[0m18:58:06.956704 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09"
[0m18:58:06.957087 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09
[0m18:58:06.958180 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09"
[0m18:58:06.958491 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09"
[0m18:58:06.958648 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09: BEGIN
[0m18:58:06.958791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:06.959108 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:58:06.959255 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09"
[0m18:58:06.959416 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select session_started_at
from "quest_kingdom"."main"."stg_sessions"
where session_started_at is null



  
  
      
    ) dbt_internal_test
[0m18:58:06.960306 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:58:06.961188 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09: ROLLBACK
[0m18:58:06.961746 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09'
[0m18:58:06.962035 [debug] [Thread-1 (]: On test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09: Close
[0m18:58:06.962368 [info ] [Thread-1 (]: 16 of 23 PASS not_null_stg_sessions_session_started_at ......................... [[32mPASS[0m in 0.01s]
[0m18:58:06.962623 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09
[0m18:58:06.962806 [debug] [Thread-1 (]: Began running node test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963
[0m18:58:06.962992 [info ] [Thread-1 (]: 17 of 23 START test relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_  [RUN]
[0m18:58:06.963175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09, now test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963)
[0m18:58:06.963337 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963
[0m18:58:06.967379 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963"
[0m18:58:06.967889 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963
[0m18:58:06.969178 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963"
[0m18:58:06.969714 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963"
[0m18:58:06.969899 [debug] [Thread-1 (]: On test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963: BEGIN
[0m18:58:06.970051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:06.970413 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:58:06.970568 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963"
[0m18:58:06.970738 [debug] [Thread-1 (]: On test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select player_id as from_field
    from "quest_kingdom"."main"."stg_iap_transactions"
    where player_id is not null
),

parent as (
    select player_id as to_field
    from "quest_kingdom"."main"."stg_players"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m18:58:06.976560 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m18:58:06.977831 [debug] [Thread-1 (]: On test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963: ROLLBACK
[0m18:58:06.978383 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963'
[0m18:58:06.978573 [debug] [Thread-1 (]: On test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963: Close
[0m18:58:06.978998 [info ] [Thread-1 (]: 17 of 23 PASS relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_  [[32mPASS[0m in 0.02s]
[0m18:58:06.979368 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963
[0m18:58:06.979585 [debug] [Thread-1 (]: Began running node test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee
[0m18:58:06.979817 [info ] [Thread-1 (]: 18 of 23 START test relationships_stg_sessions_player_id__player_id__ref_stg_players_  [RUN]
[0m18:58:06.980089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963, now test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee)
[0m18:58:06.980283 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee
[0m18:58:06.982935 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee"
[0m18:58:06.984902 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee
[0m18:58:06.986299 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee"
[0m18:58:06.986765 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee"
[0m18:58:06.986933 [debug] [Thread-1 (]: On test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee: BEGIN
[0m18:58:06.987080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:06.987466 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:58:06.987621 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee"
[0m18:58:06.987792 [debug] [Thread-1 (]: On test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select player_id as from_field
    from "quest_kingdom"."main"."stg_sessions"
    where player_id is not null
),

parent as (
    select player_id as to_field
    from "quest_kingdom"."main"."stg_players"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m18:58:06.990571 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:58:06.991454 [debug] [Thread-1 (]: On test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee: ROLLBACK
[0m18:58:06.991953 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee'
[0m18:58:06.992122 [debug] [Thread-1 (]: On test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee: Close
[0m18:58:06.992410 [info ] [Thread-1 (]: 18 of 23 PASS relationships_stg_sessions_player_id__player_id__ref_stg_players_  [[32mPASS[0m in 0.01s]
[0m18:58:06.992663 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee
[0m18:58:06.992841 [debug] [Thread-1 (]: Began running node test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef
[0m18:58:06.993027 [info ] [Thread-1 (]: 19 of 23 START test unique_stg_ad_impressions_ad_id ............................ [RUN]
[0m18:58:06.993214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee, now test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef)
[0m18:58:06.993374 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef
[0m18:58:06.996868 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef"
[0m18:58:06.997343 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef
[0m18:58:06.999667 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef"
[0m18:58:07.000081 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef"
[0m18:58:07.000246 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef: BEGIN
[0m18:58:07.000394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:07.000764 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:58:07.000920 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef"
[0m18:58:07.001080 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    ad_id as unique_field,
    count(*) as n_records

from "quest_kingdom"."main"."stg_ad_impressions"
where ad_id is not null
group by ad_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:58:07.006980 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m18:58:07.007896 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef: ROLLBACK
[0m18:58:07.008364 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef'
[0m18:58:07.008521 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef: Close
[0m18:58:07.008797 [info ] [Thread-1 (]: 19 of 23 PASS unique_stg_ad_impressions_ad_id .................................. [[32mPASS[0m in 0.02s]
[0m18:58:07.009046 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef
[0m18:58:07.009223 [debug] [Thread-1 (]: Began running node test.quest_kingdom.unique_stg_events_event_id.66ebb17438
[0m18:58:07.009419 [info ] [Thread-1 (]: 20 of 23 START test unique_stg_events_event_id ................................. [RUN]
[0m18:58:07.009643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef, now test.quest_kingdom.unique_stg_events_event_id.66ebb17438)
[0m18:58:07.009812 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.unique_stg_events_event_id.66ebb17438
[0m18:58:07.012006 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.unique_stg_events_event_id.66ebb17438"
[0m18:58:07.012597 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.unique_stg_events_event_id.66ebb17438
[0m18:58:07.013956 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.unique_stg_events_event_id.66ebb17438"
[0m18:58:07.014354 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.unique_stg_events_event_id.66ebb17438"
[0m18:58:07.014522 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_events_event_id.66ebb17438: BEGIN
[0m18:58:07.014678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:07.015115 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:58:07.015316 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.unique_stg_events_event_id.66ebb17438"
[0m18:58:07.015486 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_events_event_id.66ebb17438: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.unique_stg_events_event_id.66ebb17438"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "quest_kingdom"."main"."stg_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:58:07.018013 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:58:07.018900 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_events_event_id.66ebb17438: ROLLBACK
[0m18:58:07.019376 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.unique_stg_events_event_id.66ebb17438'
[0m18:58:07.019542 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_events_event_id.66ebb17438: Close
[0m18:58:07.019816 [info ] [Thread-1 (]: 20 of 23 PASS unique_stg_events_event_id ....................................... [[32mPASS[0m in 0.01s]
[0m18:58:07.020062 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.unique_stg_events_event_id.66ebb17438
[0m18:58:07.020240 [debug] [Thread-1 (]: Began running node test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069
[0m18:58:07.020426 [info ] [Thread-1 (]: 21 of 23 START test unique_stg_iap_transactions_transaction_id ................. [RUN]
[0m18:58:07.020613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.unique_stg_events_event_id.66ebb17438, now test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069)
[0m18:58:07.020771 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069
[0m18:58:07.022808 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069"
[0m18:58:07.023212 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069
[0m18:58:07.024346 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069"
[0m18:58:07.024657 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069"
[0m18:58:07.024816 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069: BEGIN
[0m18:58:07.024962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:07.025298 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:58:07.025445 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069"
[0m18:58:07.025599 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    transaction_id as unique_field,
    count(*) as n_records

from "quest_kingdom"."main"."stg_iap_transactions"
where transaction_id is not null
group by transaction_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:58:07.027146 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:58:07.028012 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069: ROLLBACK
[0m18:58:07.028513 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069'
[0m18:58:07.028895 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069: Close
[0m18:58:07.029286 [info ] [Thread-1 (]: 21 of 23 PASS unique_stg_iap_transactions_transaction_id ....................... [[32mPASS[0m in 0.01s]
[0m18:58:07.029561 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069
[0m18:58:07.029745 [debug] [Thread-1 (]: Began running node test.quest_kingdom.unique_stg_players_player_id.a3d551d71d
[0m18:58:07.029930 [info ] [Thread-1 (]: 22 of 23 START test unique_stg_players_player_id ............................... [RUN]
[0m18:58:07.030126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069, now test.quest_kingdom.unique_stg_players_player_id.a3d551d71d)
[0m18:58:07.030281 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.unique_stg_players_player_id.a3d551d71d
[0m18:58:07.032407 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.unique_stg_players_player_id.a3d551d71d"
[0m18:58:07.032838 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.unique_stg_players_player_id.a3d551d71d
[0m18:58:07.034027 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.unique_stg_players_player_id.a3d551d71d"
[0m18:58:07.034360 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.unique_stg_players_player_id.a3d551d71d"
[0m18:58:07.034519 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_players_player_id.a3d551d71d: BEGIN
[0m18:58:07.034664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:07.035027 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:58:07.035172 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.unique_stg_players_player_id.a3d551d71d"
[0m18:58:07.035330 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_players_player_id.a3d551d71d: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.unique_stg_players_player_id.a3d551d71d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    player_id as unique_field,
    count(*) as n_records

from "quest_kingdom"."main"."stg_players"
where player_id is not null
group by player_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:58:07.036962 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:58:07.037892 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_players_player_id.a3d551d71d: ROLLBACK
[0m18:58:07.038375 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.unique_stg_players_player_id.a3d551d71d'
[0m18:58:07.038528 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_players_player_id.a3d551d71d: Close
[0m18:58:07.038794 [info ] [Thread-1 (]: 22 of 23 PASS unique_stg_players_player_id ..................................... [[32mPASS[0m in 0.01s]
[0m18:58:07.039033 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.unique_stg_players_player_id.a3d551d71d
[0m18:58:07.039209 [debug] [Thread-1 (]: Began running node test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03
[0m18:58:07.039388 [info ] [Thread-1 (]: 23 of 23 START test unique_stg_sessions_session_id ............................. [RUN]
[0m18:58:07.039570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.unique_stg_players_player_id.a3d551d71d, now test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03)
[0m18:58:07.039730 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03
[0m18:58:07.041734 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03"
[0m18:58:07.042100 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03
[0m18:58:07.043203 [debug] [Thread-1 (]: Writing runtime sql for node "test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03"
[0m18:58:07.043505 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03"
[0m18:58:07.043664 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03: BEGIN
[0m18:58:07.043804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:07.044115 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:58:07.044270 [debug] [Thread-1 (]: Using duckdb connection "test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03"
[0m18:58:07.044428 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "node_id": "test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    session_id as unique_field,
    count(*) as n_records

from "quest_kingdom"."main"."stg_sessions"
where session_id is not null
group by session_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:58:07.049515 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:58:07.050429 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03: ROLLBACK
[0m18:58:07.050916 [debug] [Thread-1 (]: Failed to rollback 'test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03'
[0m18:58:07.051069 [debug] [Thread-1 (]: On test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03: Close
[0m18:58:07.051347 [info ] [Thread-1 (]: 23 of 23 PASS unique_stg_sessions_session_id ................................... [[32mPASS[0m in 0.01s]
[0m18:58:07.051592 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03
[0m18:58:07.052192 [debug] [MainThread]: Using duckdb connection "master"
[0m18:58:07.052373 [debug] [MainThread]: On master: BEGIN
[0m18:58:07.052509 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:58:07.052806 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:58:07.052950 [debug] [MainThread]: On master: COMMIT
[0m18:58:07.053084 [debug] [MainThread]: Using duckdb connection "master"
[0m18:58:07.053211 [debug] [MainThread]: On master: COMMIT
[0m18:58:07.053410 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:58:07.053541 [debug] [MainThread]: On master: Close
[0m18:58:07.053709 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:58:07.053830 [debug] [MainThread]: Connection 'test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03' was properly closed.
[0m18:58:07.053969 [info ] [MainThread]: 
[0m18:58:07.054109 [info ] [MainThread]: Finished running 23 data tests in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m18:58:07.055419 [debug] [MainThread]: Command end result
[0m18:58:07.069655 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/manifest.json
[0m18:58:07.070816 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/semantic_manifest.json
[0m18:58:07.074916 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/run_results.json
[0m18:58:07.075103 [info ] [MainThread]: 
[0m18:58:07.075287 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:58:07.075430 [info ] [MainThread]: 
[0m18:58:07.075581 [info ] [MainThread]: Done. PASS=23 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=23
[0m18:58:07.077012 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.85656697, "process_in_blocks": "0", "process_kernel_time": 0.207709, "process_mem_max_rss": "163643392", "process_out_blocks": "0", "process_user_time": 1.30049}
[0m18:58:07.077230 [debug] [MainThread]: Command `dbt test` succeeded at 18:58:07.077191 after 0.86 seconds
[0m18:58:07.077406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a90620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109164ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d4b90>]}
[0m18:58:07.077577 [debug] [MainThread]: Flushing usage events
[0m18:58:07.197452 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:58:15.817816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046ff2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054adc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054ada00>]}


============================== 18:58:15.821061 | d723f29b-97b1-4ba1-ab67-5d4e18a3099a ==============================
[0m18:58:15.821061 [info ] [MainThread]: Running with dbt=1.11.4
[0m18:58:15.821391 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'invocation_command': 'dbt docs generate', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/hazeldonaldson/.dbt', 'target_path': 'None', 'warn_error': 'None', 'partial_parse': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'no_print': 'None', 'log_format': 'default', 'log_path': '/Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/logs', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False'}
[0m18:58:15.941465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd723f29b-97b1-4ba1-ab67-5d4e18a3099a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047e1e80>]}
[0m18:58:15.972135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd723f29b-97b1-4ba1-ab67-5d4e18a3099a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055347a0>]}
[0m18:58:15.973591 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:58:16.025000 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m18:58:16.102480 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:58:16.102759 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:58:16.102904 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:58:16.106209 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.retention
- models.product
- models.question_kingdom
- models.staging
- models.marts
- models.core
- models.monetization
[0m18:58:16.127490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd723f29b-97b1-4ba1-ab67-5d4e18a3099a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10551bbf0>]}
[0m18:58:16.142049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd723f29b-97b1-4ba1-ab67-5d4e18a3099a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b47fb0>]}
[0m18:58:16.142366 [info ] [MainThread]: Found 7 models, 23 data tests, 5 sources, 472 macros
[0m18:58:16.142546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd723f29b-97b1-4ba1-ab67-5d4e18a3099a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b27e0>]}
[0m18:58:16.143984 [info ] [MainThread]: 
[0m18:58:16.144210 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:58:16.144359 [info ] [MainThread]: 
[0m18:58:16.144607 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:58:16.147064 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_quest_kingdom_main'
[0m18:58:16.174953 [debug] [ThreadPool]: Using duckdb connection "list_quest_kingdom_main"
[0m18:58:16.175196 [debug] [ThreadPool]: On list_quest_kingdom_main: BEGIN
[0m18:58:16.175344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:16.184754 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m18:58:16.185011 [debug] [ThreadPool]: Using duckdb connection "list_quest_kingdom_main"
[0m18:58:16.185170 [debug] [ThreadPool]: On list_quest_kingdom_main: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "list_quest_kingdom_main"} */
select
      'quest_kingdom' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'quest_kingdom'
  
[0m18:58:16.192871 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:58:16.193787 [debug] [ThreadPool]: On list_quest_kingdom_main: ROLLBACK
[0m18:58:16.194884 [debug] [ThreadPool]: Failed to rollback 'list_quest_kingdom_main'
[0m18:58:16.195038 [debug] [ThreadPool]: On list_quest_kingdom_main: Close
[0m18:58:16.196098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd723f29b-97b1-4ba1-ab67-5d4e18a3099a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b136b0>]}
[0m18:58:16.198179 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_ad_impressions
[0m18:58:16.198509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_quest_kingdom_main, now model.quest_kingdom.stg_ad_impressions)
[0m18:58:16.198708 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_ad_impressions
[0m18:58:16.202877 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_ad_impressions"
[0m18:58:16.203597 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_ad_impressions
[0m18:58:16.203961 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_ad_impressions
[0m18:58:16.204152 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_events
[0m18:58:16.204361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_ad_impressions, now model.quest_kingdom.stg_events)
[0m18:58:16.204546 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_events
[0m18:58:16.206605 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_events"
[0m18:58:16.206995 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_events
[0m18:58:16.207299 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_events
[0m18:58:16.207473 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_iap_transactions
[0m18:58:16.207664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_events, now model.quest_kingdom.stg_iap_transactions)
[0m18:58:16.207848 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_iap_transactions
[0m18:58:16.209125 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_iap_transactions"
[0m18:58:16.209430 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_iap_transactions
[0m18:58:16.209707 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_iap_transactions
[0m18:58:16.209872 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_players
[0m18:58:16.210047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_iap_transactions, now model.quest_kingdom.stg_players)
[0m18:58:16.210220 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_players
[0m18:58:16.211515 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_players"
[0m18:58:16.211816 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_players
[0m18:58:16.212087 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_players
[0m18:58:16.212252 [debug] [Thread-1 (]: Began running node model.quest_kingdom.stg_sessions
[0m18:58:16.212423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_players, now model.quest_kingdom.stg_sessions)
[0m18:58:16.212598 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.stg_sessions
[0m18:58:16.213872 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.stg_sessions"
[0m18:58:16.214150 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.stg_sessions
[0m18:58:16.214414 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.stg_sessions
[0m18:58:16.214579 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c
[0m18:58:16.214753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.stg_sessions, now test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c)
[0m18:58:16.214936 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c
[0m18:58:16.220449 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c"
[0m18:58:16.221035 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c
[0m18:58:16.221351 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c
[0m18:58:16.221522 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19
[0m18:58:16.221703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c, now test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19)
[0m18:58:16.221857 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19
[0m18:58:16.223709 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19"
[0m18:58:16.224010 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19
[0m18:58:16.224287 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19
[0m18:58:16.224451 [debug] [Thread-1 (]: Began running node test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef
[0m18:58:16.224614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19, now test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef)
[0m18:58:16.224761 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef
[0m18:58:16.227533 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef"
[0m18:58:16.227887 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef
[0m18:58:16.228212 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef
[0m18:58:16.228398 [debug] [Thread-1 (]: Began running node test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36
[0m18:58:16.228588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef, now test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36)
[0m18:58:16.228751 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36
[0m18:58:16.233557 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36"
[0m18:58:16.234075 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36
[0m18:58:16.234461 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36
[0m18:58:16.234838 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_events_event_id.715b3f7012
[0m18:58:16.235065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36, now test.quest_kingdom.not_null_stg_events_event_id.715b3f7012)
[0m18:58:16.235234 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_events_event_id.715b3f7012
[0m18:58:16.237291 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_events_event_id.715b3f7012"
[0m18:58:16.238934 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_events_event_id.715b3f7012
[0m18:58:16.239289 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_events_event_id.715b3f7012
[0m18:58:16.239482 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3
[0m18:58:16.239673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_events_event_id.715b3f7012, now test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3)
[0m18:58:16.239833 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3
[0m18:58:16.241733 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3"
[0m18:58:16.242095 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3
[0m18:58:16.242378 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3
[0m18:58:16.242546 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5
[0m18:58:16.242715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3, now test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5)
[0m18:58:16.242868 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5
[0m18:58:16.245588 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5"
[0m18:58:16.245939 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5
[0m18:58:16.246234 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5
[0m18:58:16.246407 [debug] [Thread-1 (]: Began running node test.quest_kingdom.unique_stg_events_event_id.66ebb17438
[0m18:58:16.246591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5, now test.quest_kingdom.unique_stg_events_event_id.66ebb17438)
[0m18:58:16.246765 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.unique_stg_events_event_id.66ebb17438
[0m18:58:16.248522 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.unique_stg_events_event_id.66ebb17438"
[0m18:58:16.248827 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.unique_stg_events_event_id.66ebb17438
[0m18:58:16.249102 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.unique_stg_events_event_id.66ebb17438
[0m18:58:16.249267 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d
[0m18:58:16.249434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.unique_stg_events_event_id.66ebb17438, now test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d)
[0m18:58:16.249589 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d
[0m18:58:16.251349 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d"
[0m18:58:16.251675 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d
[0m18:58:16.251958 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d
[0m18:58:16.252129 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079
[0m18:58:16.252298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d, now test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079)
[0m18:58:16.252452 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079
[0m18:58:16.254218 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079"
[0m18:58:16.254502 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079
[0m18:58:16.254777 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079
[0m18:58:16.254944 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645
[0m18:58:16.255109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079, now test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645)
[0m18:58:16.255259 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645
[0m18:58:16.257136 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645"
[0m18:58:16.257475 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645
[0m18:58:16.257763 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645
[0m18:58:16.257933 [debug] [Thread-1 (]: Began running node test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069
[0m18:58:16.258105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645, now test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069)
[0m18:58:16.258257 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069
[0m18:58:16.260018 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069"
[0m18:58:16.260328 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069
[0m18:58:16.260602 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069
[0m18:58:16.260768 [debug] [Thread-1 (]: Began running node test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd
[0m18:58:16.260932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069, now test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd)
[0m18:58:16.261084 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd
[0m18:58:16.263564 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd"
[0m18:58:16.263911 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd
[0m18:58:16.264192 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd
[0m18:58:16.264359 [debug] [Thread-1 (]: Began running node test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a
[0m18:58:16.264531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd, now test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a)
[0m18:58:16.264686 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a
[0m18:58:16.267540 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a"
[0m18:58:16.267862 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a
[0m18:58:16.268142 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a
[0m18:58:16.268309 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb
[0m18:58:16.268492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a, now test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb)
[0m18:58:16.268685 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb
[0m18:58:16.270462 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb"
[0m18:58:16.271382 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb
[0m18:58:16.271671 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb
[0m18:58:16.271840 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b
[0m18:58:16.272020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb, now test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b)
[0m18:58:16.272174 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b
[0m18:58:16.273989 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b"
[0m18:58:16.274373 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b
[0m18:58:16.274658 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b
[0m18:58:16.274834 [debug] [Thread-1 (]: Began running node test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963
[0m18:58:16.275012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b, now test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963)
[0m18:58:16.275169 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963
[0m18:58:16.280306 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963"
[0m18:58:16.280782 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963
[0m18:58:16.281098 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963
[0m18:58:16.281274 [debug] [Thread-1 (]: Began running node test.quest_kingdom.unique_stg_players_player_id.a3d551d71d
[0m18:58:16.281455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963, now test.quest_kingdom.unique_stg_players_player_id.a3d551d71d)
[0m18:58:16.281609 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.unique_stg_players_player_id.a3d551d71d
[0m18:58:16.283481 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.unique_stg_players_player_id.a3d551d71d"
[0m18:58:16.283842 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.unique_stg_players_player_id.a3d551d71d
[0m18:58:16.284131 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.unique_stg_players_player_id.a3d551d71d
[0m18:58:16.284312 [debug] [Thread-1 (]: Began running node model.quest_kingdom.dim_players
[0m18:58:16.284482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.unique_stg_players_player_id.a3d551d71d, now model.quest_kingdom.dim_players)
[0m18:58:16.284637 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.dim_players
[0m18:58:16.286533 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.dim_players"
[0m18:58:16.286870 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.dim_players
[0m18:58:16.287156 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.dim_players
[0m18:58:16.287329 [debug] [Thread-1 (]: Began running node model.quest_kingdom.fct_sessions
[0m18:58:16.287518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.dim_players, now model.quest_kingdom.fct_sessions)
[0m18:58:16.287720 [debug] [Thread-1 (]: Began compiling node model.quest_kingdom.fct_sessions
[0m18:58:16.289266 [debug] [Thread-1 (]: Writing injected SQL for node "model.quest_kingdom.fct_sessions"
[0m18:58:16.289600 [debug] [Thread-1 (]: Began executing node model.quest_kingdom.fct_sessions
[0m18:58:16.289889 [debug] [Thread-1 (]: Finished running node model.quest_kingdom.fct_sessions
[0m18:58:16.290057 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29
[0m18:58:16.290231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.quest_kingdom.fct_sessions, now test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29)
[0m18:58:16.290380 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29
[0m18:58:16.292229 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29"
[0m18:58:16.292574 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29
[0m18:58:16.292846 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29
[0m18:58:16.293011 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d
[0m18:58:16.293186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29, now test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d)
[0m18:58:16.293339 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d
[0m18:58:16.295154 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d"
[0m18:58:16.295610 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d
[0m18:58:16.297492 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d
[0m18:58:16.297921 [debug] [Thread-1 (]: Began running node test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09
[0m18:58:16.298246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d, now test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09)
[0m18:58:16.298445 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09
[0m18:58:16.300610 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09"
[0m18:58:16.301032 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09
[0m18:58:16.301348 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09
[0m18:58:16.301539 [debug] [Thread-1 (]: Began running node test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee
[0m18:58:16.301743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09, now test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee)
[0m18:58:16.301932 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee
[0m18:58:16.304428 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee"
[0m18:58:16.304822 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee
[0m18:58:16.305134 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee
[0m18:58:16.305311 [debug] [Thread-1 (]: Began running node test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03
[0m18:58:16.305496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee, now test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03)
[0m18:58:16.305651 [debug] [Thread-1 (]: Began compiling node test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03
[0m18:58:16.307630 [debug] [Thread-1 (]: Writing injected SQL for node "test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03"
[0m18:58:16.307993 [debug] [Thread-1 (]: Began executing node test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03
[0m18:58:16.308282 [debug] [Thread-1 (]: Finished running node test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03
[0m18:58:16.308988 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:58:16.309160 [debug] [MainThread]: Connection 'test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03' was properly closed.
[0m18:58:16.310780 [debug] [MainThread]: Command end result
[0m18:58:16.390086 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/manifest.json
[0m18:58:16.391238 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/semantic_manifest.json
[0m18:58:16.395536 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/run_results.json
[0m18:58:16.397684 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m18:58:16.397840 [info ] [MainThread]: Building catalog
[0m18:58:16.402705 [debug] [ThreadPool]: Acquiring new duckdb connection 'quest_kingdom.information_schema'
[0m18:58:16.406049 [debug] [ThreadPool]: Using duckdb connection "quest_kingdom.information_schema"
[0m18:58:16.406261 [debug] [ThreadPool]: On quest_kingdom.information_schema: BEGIN
[0m18:58:16.406400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:16.406807 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:58:16.406948 [debug] [ThreadPool]: Using duckdb connection "quest_kingdom.information_schema"
[0m18:58:16.407106 [debug] [ThreadPool]: On quest_kingdom.information_schema: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "quest_kingdom", "target_name": "dev", "connection_name": "quest_kingdom.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'quest_kingdom'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'quest_kingdom'
    )
    select
        'quest_kingdom' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        NULL as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m18:58:16.415557 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:58:16.419431 [debug] [ThreadPool]: On quest_kingdom.information_schema: ROLLBACK
[0m18:58:16.419970 [debug] [ThreadPool]: Failed to rollback 'quest_kingdom.information_schema'
[0m18:58:16.420123 [debug] [ThreadPool]: On quest_kingdom.information_schema: Close
[0m18:58:16.429205 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/catalog.json
[0m18:58:16.448584 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/manifest.json
[0m18:58:16.450239 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/semantic_manifest.json
[0m18:58:16.450441 [info ] [MainThread]: Catalog written to /Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/target/catalog.json
[0m18:58:16.452502 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.67292494, "process_in_blocks": "0", "process_kernel_time": 0.192246, "process_mem_max_rss": "147456000", "process_out_blocks": "0", "process_user_time": 1.256574}
[0m18:58:16.452802 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:58:16.452756 after 0.67 seconds
[0m18:58:16.452969 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:58:16.453098 [debug] [MainThread]: Connection 'quest_kingdom.information_schema' was properly closed.
[0m18:58:16.453264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104756ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aaca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054ada30>]}
[0m18:58:16.453449 [debug] [MainThread]: Flushing usage events
[0m18:58:16.555789 [debug] [MainThread]: An error was encountered while trying to flush usage events
