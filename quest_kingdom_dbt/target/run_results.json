{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.4", "generated_at": "2026-02-24T23:58:16.309297Z", "invocation_id": "d723f29b-97b1-4ba1-ab67-5d4e18a3099a", "invocation_started_at": "2026-02-24T23:58:15.806315Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-24T23:58:16.198829Z", "completed_at": "2026-02-24T23:58:16.203527Z"}, {"name": "execute", "started_at": "2026-02-24T23:58:16.203739Z", "completed_at": "2026-02-24T23:58:16.203748Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005408048629760742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.quest_kingdom.stg_ad_impressions", "compiled": true, "compiled_code": "select\n    -- ids\n    ad_id,\n    player_id,\n    session_id,\n    \n    -- timestamps\n    ad_timestamp::timestamp as shown_at,\n    \n    -- dimensions\n    lower(trim(ad_type)) as ad_type,\n    lower(trim(ad_network)) as ad_network,\n    \n    -- booleans\n    clicked,\n    \n    -- metrics\n    revenue_usd,\n    \n    -- derived\n    date_trunc('day', ad_timestamp::timestamp)::date as ad_date\n\nfrom \"quest_kingdom\".\"main\".\"ad_impressions\"", "relation_name": "\"quest_kingdom\".\"main\".\"stg_ad_impressions\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-24T23:58:16.204651Z", "completed_at": "2026-02-24T23:58:16.206940Z"}, {"name": "execute", "started_at": "2026-02-24T23:58:16.207116Z", "completed_at": "2026-02-24T23:58:16.207121Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0028760433197021484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.quest_kingdom.stg_events", "compiled": true, "compiled_code": "select\n    -- ids\n    event_id,\n    player_id,\n    session_id,\n    \n    -- timestamps\n    event_timestamp::timestamp as event_at,\n    \n    -- dimensions\n    lower(trim(event_name)) as event_name,\n    \n    -- json properties\n    event_properties\n\nfrom \"quest_kingdom\".\"main\".\"events\"", "relation_name": "\"quest_kingdom\".\"main\".\"stg_events\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-24T23:58:16.207955Z", "completed_at": "2026-02-24T23:58:16.209380Z"}, {"name": "execute", "started_at": "2026-02-24T23:58:16.209539Z", "completed_at": "2026-02-24T23:58:16.209542Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001981973648071289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.quest_kingdom.stg_iap_transactions", "compiled": true, "compiled_code": "select\n    -- ids\n    transaction_id,\n    player_id,\n    session_id,\n    \n    -- timestamps\n    transaction_timestamp::timestamp as purchased_at,\n    \n    -- dimensions\n    lower(trim(sku)) as sku,\n    lower(trim(platform)) as platform,\n    \n    -- metrics\n    price_usd,\n    gems_purchased,\n    \n    -- derived\n    date_trunc('day', transaction_timestamp::timestamp)::date as purchase_date\n\nfrom \"quest_kingdom\".\"main\".\"iap_transactions\"", "relation_name": "\"quest_kingdom\".\"main\".\"stg_iap_transactions\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-24T23:58:16.210324Z", "completed_at": "2026-02-24T23:58:16.211770Z"}, {"name": "execute", "started_at": "2026-02-24T23:58:16.211923Z", "completed_at": "2026-02-24T23:58:16.211926Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0019750595092773438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.quest_kingdom.stg_players", "compiled": true, "compiled_code": "with source as (\n    select * from \"quest_kingdom\".\"main\".\"players\"\n),\n\nrenamed as (\n    select\n        player_id,\n        install_date::date as installed_at,\n        --dimensions\n        lower(trim(attribution_channel)) as attribution_channel,\n        lower(trim(country)) as country,\n        lower(trim(device_type)) as device_type,\n        lower(trim(player_segment)) as player_segment,\n        lower(trim(experiment_variant)) as experiment_variant,\n        --booleans\n        tutorial_completed,\n        --metrics\n        lifetime_value as lifetime_value_usd\n    from source \n)\n\nselect * from renamed", "relation_name": "\"quest_kingdom\".\"main\".\"stg_players\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-24T23:58:16.212706Z", "completed_at": "2026-02-24T23:58:16.214103Z"}, {"name": "execute", "started_at": "2026-02-24T23:58:16.214258Z", "completed_at": "2026-02-24T23:58:16.214261Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0019309520721435547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.quest_kingdom.stg_sessions", "compiled": true, "compiled_code": "with source as (\n    select * from \"quest_kingdom\".\"main\".\"sessions\"\n),\n\nrenamed as (\n    select \n        session_id,\n        player_id,\n        --timestamps\n        session_start::timestamp as session_started_at,\n        session_end::timestamp as session_ended_at,\n\n        --metrics\n        session_duration_minutes,\n        starting_level,\n        ending_level,\n        levels_gained,\n\n        --derived metrics\n        extract(hour from session_start::timestamp) as session_hour,\n        extract(dow from session_start::timestamp) as session_day_of_week,\n        date_trunc('day', session_start::timestamp)::date as session_date \n    from source\n)\n\nselect * from renamed", "relation_name": "\"quest_kingdom\".\"main\".\"stg_sessions\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-24T23:58:16.215041Z", "completed_at": "2026-02-24T23:58:16.220977Z"}, {"name": "execute", "started_at": "2026-02-24T23:58:16.221164Z", "completed_at": "2026-02-24T23:58:16.221168Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006521701812744141, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.quest_kingdom.not_null_stg_ad_impressions_ad_id.34d3bb542c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_id\nfrom \"quest_kingdom\".\"main\".\"stg_ad_impressions\"\nwhere ad_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-24T23:58:16.221962Z", "completed_at": "2026-02-24T23:58:16.223960Z"}, {"name": "execute", "started_at": "2026-02-24T23:58:16.224123Z", "completed_at": "2026-02-24T23:58:16.224127Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0025229454040527344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.quest_kingdom.not_null_stg_ad_impressions_player_id.72385a5e19", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect player_id\nfrom \"quest_kingdom\".\"main\".\"stg_ad_impressions\"\nwhere player_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-24T23:58:16.224866Z", "completed_at": "2026-02-24T23:58:16.227826Z"}, {"name": "execute", "started_at": "2026-02-24T23:58:16.228028Z", "completed_at": "2026-02-24T23:58:16.228031Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003522157669067383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.quest_kingdom.unique_stg_ad_impressions_ad_id.618068e7ef", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    ad_id as unique_field,\n    count(*) as n_records\n\nfrom \"quest_kingdom\".\"main\".\"stg_ad_impressions\"\nwhere ad_id is not null\ngroup by ad_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-24T23:58:16.228858Z", "completed_at": "2026-02-24T23:58:16.234005Z"}, {"name": "execute", "started_at": "2026-02-24T23:58:16.234242Z", "completed_at": "2026-02-24T23:58:16.234248Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005792140960693359, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.quest_kingdom.accepted_values_stg_events_event_name__tutorial_completed__level_completed__boss_defeated.4ed70dcb36", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        event_name as value_field,\n        count(*) as n_records\n\n    from \"quest_kingdom\".\"main\".\"stg_events\"\n    group by event_name\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'tutorial_completed','level_completed','boss_defeated'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-24T23:58:16.235346Z", "completed_at": "2026-02-24T23:58:16.238871Z"}, {"name": "execute", "started_at": "2026-02-24T23:58:16.239080Z", "completed_at": "2026-02-24T23:58:16.239086Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004143714904785156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.quest_kingdom.not_null_stg_events_event_id.715b3f7012", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"quest_kingdom\".\"main\".\"stg_events\"\nwhere event_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-24T23:58:16.239937Z", "completed_at": "2026-02-24T23:58:16.242044Z"}, {"name": "execute", "started_at": "2026-02-24T23:58:16.242212Z", "completed_at": "2026-02-24T23:58:16.242215Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0026493072509765625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.quest_kingdom.not_null_stg_events_event_name.682bd9eda3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_name\nfrom \"quest_kingdom\".\"main\".\"stg_events\"\nwhere event_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-24T23:58:16.242973Z", "completed_at": "2026-02-24T23:58:16.245886Z"}, {"name": "execute", "started_at": "2026-02-24T23:58:16.246063Z", "completed_at": "2026-02-24T23:58:16.246067Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0034530162811279297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.quest_kingdom.not_null_stg_events_player_id.588c4cb5e5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect player_id\nfrom \"quest_kingdom\".\"main\".\"stg_events\"\nwhere player_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-24T23:58:16.246876Z", "completed_at": "2026-02-24T23:58:16.248776Z"}, {"name": "execute", "started_at": "2026-02-24T23:58:16.248944Z", "completed_at": "2026-02-24T23:58:16.248947Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0024566650390625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.quest_kingdom.unique_stg_events_event_id.66ebb17438", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"quest_kingdom\".\"main\".\"stg_events\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-24T23:58:16.249694Z", "completed_at": "2026-02-24T23:58:16.251622Z"}, {"name": "execute", "started_at": "2026-02-24T23:58:16.251792Z", "completed_at": "2026-02-24T23:58:16.251796Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002458333969116211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.quest_kingdom.not_null_stg_iap_transactions_player_id.256115ad9d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect player_id\nfrom \"quest_kingdom\".\"main\".\"stg_iap_transactions\"\nwhere player_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-24T23:58:16.252557Z", "completed_at": "2026-02-24T23:58:16.254453Z"}, {"name": "execute", "started_at": "2026-02-24T23:58:16.254616Z", "completed_at": "2026-02-24T23:58:16.254620Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0024161338806152344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.quest_kingdom.not_null_stg_iap_transactions_price_usd.613bc29079", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect price_usd\nfrom \"quest_kingdom\".\"main\".\"stg_iap_transactions\"\nwhere price_usd is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-24T23:58:16.255360Z", "completed_at": "2026-02-24T23:58:16.257421Z"}, {"name": "execute", "started_at": "2026-02-24T23:58:16.257593Z", "completed_at": "2026-02-24T23:58:16.257597Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0025861263275146484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.quest_kingdom.not_null_stg_iap_transactions_transaction_id.bc4fc23645", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect transaction_id\nfrom \"quest_kingdom\".\"main\".\"stg_iap_transactions\"\nwhere transaction_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-24T23:58:16.258360Z", "completed_at": "2026-02-24T23:58:16.260279Z"}, {"name": "execute", "started_at": "2026-02-24T23:58:16.260440Z", "completed_at": "2026-02-24T23:58:16.260444Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002432107925415039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.quest_kingdom.unique_stg_iap_transactions_transaction_id.3bff016069", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    transaction_id as unique_field,\n    count(*) as n_records\n\nfrom \"quest_kingdom\".\"main\".\"stg_iap_transactions\"\nwhere transaction_id is not null\ngroup by transaction_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-24T23:58:16.261187Z", "completed_at": "2026-02-24T23:58:16.263860Z"}, {"name": "execute", "started_at": "2026-02-24T23:58:16.264025Z", "completed_at": "2026-02-24T23:58:16.264029Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0031943321228027344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.quest_kingdom.accepted_values_stg_players_device_type__ios__android.14cabc59fd", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        device_type as value_field,\n        count(*) as n_records\n\n    from \"quest_kingdom\".\"main\".\"stg_players\"\n    group by device_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'ios','android'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-24T23:58:16.264788Z", "completed_at": "2026-02-24T23:58:16.267810Z"}, {"name": "execute", "started_at": "2026-02-24T23:58:16.267976Z", "completed_at": "2026-02-24T23:58:16.267979Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003545999526977539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.quest_kingdom.accepted_values_stg_players_player_segment__whale__dolphin__minnow__non_payer.2fd01d0b8a", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        player_segment as value_field,\n        count(*) as n_records\n\n    from \"quest_kingdom\".\"main\".\"stg_players\"\n    group by player_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'whale','dolphin','minnow','non_payer'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-24T23:58:16.268803Z", "completed_at": "2026-02-24T23:58:16.271331Z"}, {"name": "execute", "started_at": "2026-02-24T23:58:16.271504Z", "completed_at": "2026-02-24T23:58:16.271507Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0031249523162841797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.quest_kingdom.not_null_stg_players_installed_at.60c4ce69cb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect installed_at\nfrom \"quest_kingdom\".\"main\".\"stg_players\"\nwhere installed_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-24T23:58:16.272280Z", "completed_at": "2026-02-24T23:58:16.274322Z"}, {"name": "execute", "started_at": "2026-02-24T23:58:16.274494Z", "completed_at": "2026-02-24T23:58:16.274498Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002576112747192383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.quest_kingdom.not_null_stg_players_player_id.702d1d8c7b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect player_id\nfrom \"quest_kingdom\".\"main\".\"stg_players\"\nwhere player_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-24T23:58:16.275275Z", "completed_at": "2026-02-24T23:58:16.280717Z"}, {"name": "execute", "started_at": "2026-02-24T23:58:16.280915Z", "completed_at": "2026-02-24T23:58:16.280920Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006014823913574219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.quest_kingdom.relationships_stg_iap_transactions_player_id__player_id__ref_stg_players_.ec3ff36963", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select player_id as from_field\n    from \"quest_kingdom\".\"main\".\"stg_iap_transactions\"\n    where player_id is not null\n),\n\nparent as (\n    select player_id as to_field\n    from \"quest_kingdom\".\"main\".\"stg_players\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-24T23:58:16.281714Z", "completed_at": "2026-02-24T23:58:16.283791Z"}, {"name": "execute", "started_at": "2026-02-24T23:58:16.283962Z", "completed_at": "2026-02-24T23:58:16.283966Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0026149749755859375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.quest_kingdom.unique_stg_players_player_id.a3d551d71d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    player_id as unique_field,\n    count(*) as n_records\n\nfrom \"quest_kingdom\".\"main\".\"stg_players\"\nwhere player_id is not null\ngroup by player_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-24T23:58:16.284744Z", "completed_at": "2026-02-24T23:58:16.286820Z"}, {"name": "execute", "started_at": "2026-02-24T23:58:16.286986Z", "completed_at": "2026-02-24T23:58:16.286990Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0026099681854248047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.quest_kingdom.dim_players", "compiled": true, "compiled_code": "\n\nwith players as (\n\n    select * from \"quest_kingdom\".\"main\".\"stg_players\"\n\n),\n\nsessions as (\n\n    select * from \"quest_kingdom\".\"main\".\"stg_sessions\"\n\n),\n\ntransactions as (\n\n    select * from \"quest_kingdom\".\"main\".\"stg_iap_transactions\"\n\n),\n\nads as (\n\n    select * from \"quest_kingdom\".\"main\".\"stg_ad_impressions\"\n\n),\n\n-- Aggregate session metrics per player\nplayer_sessions as (\n\n    select\n        player_id,\n        count(*) as total_sessions,\n        min(session_started_at) as first_session_at,\n        max(session_started_at) as last_session_at,\n        sum(session_duration_minutes) as total_play_time_minutes,\n        avg(session_duration_minutes) as avg_session_duration_minutes,\n        max(ending_level) as max_level_reached\n\n    from sessions\n    group by player_id\n\n),\n\n-- Aggregate IAP metrics per player\nplayer_iap as (\n\n    select\n        player_id,\n        count(*) as total_purchases,\n        sum(price_usd) as total_iap_revenue,\n        min(purchased_at) as first_purchase_at,\n        avg(price_usd) as avg_purchase_value\n\n    from transactions\n    group by player_id\n\n),\n\n-- Aggregate ad metrics per player\nplayer_ads as (\n\n    select\n        player_id,\n        count(*) as total_ad_impressions,\n        sum(revenue_usd) as total_ad_revenue,\n        sum(case when clicked then 1 else 0 end) as total_ad_clicks\n\n    from ads\n    group by player_id\n\n),\n\n-- Combine everything\nfinal as (\n\n    select\n        -- player attributes\n        p.player_id,\n        p.installed_at,\n        p.attribution_channel,\n        p.country,\n        p.device_type,\n        p.player_segment,\n        p.experiment_variant,\n        p.tutorial_completed,\n        \n        -- session metrics\n        coalesce(ps.total_sessions, 0) as total_sessions,\n        ps.first_session_at,\n        ps.last_session_at,\n        coalesce(ps.total_play_time_minutes, 0) as total_play_time_minutes,\n        ps.avg_session_duration_minutes,\n        coalesce(ps.max_level_reached, 0) as max_level_reached,\n        \n        -- monetization metrics\n        coalesce(pi.total_purchases, 0) as total_purchases,\n        coalesce(pi.total_iap_revenue, 0) as total_iap_revenue,\n        pi.first_purchase_at,\n        pi.avg_purchase_value,\n        \n        coalesce(pa.total_ad_impressions, 0) as total_ad_impressions,\n        coalesce(pa.total_ad_revenue, 0) as total_ad_revenue,\n        coalesce(pa.total_ad_clicks, 0) as total_ad_clicks,\n        \n        -- derived total revenue\n        coalesce(pi.total_iap_revenue, 0) + coalesce(pa.total_ad_revenue, 0) as total_revenue,\n        \n        -- derived days metrics\n        datediff('day', p.installed_at, current_date) as days_since_install,\n        case \n            when ps.last_session_at is not null \n            then datediff('day', ps.last_session_at, current_date)\n            else null\n        end as days_since_last_session,\n        case \n            when pi.first_purchase_at is not null \n            then datediff('day', p.installed_at, pi.first_purchase_at)\n            else null\n        end as days_to_first_purchase,\n        \n        -- derived flags\n        coalesce(ps.total_sessions, 0) > 0 as is_activated,\n        coalesce(pi.total_purchases, 0) > 0 as is_payer,\n        coalesce(pa.total_ad_impressions, 0) > 0 as has_seen_ads\n\n    from players p\n    left join player_sessions ps on p.player_id = ps.player_id\n    left join player_iap pi on p.player_id = pi.player_id\n    left join player_ads pa on p.player_id = pa.player_id\n\n)\n\nselect * from final", "relation_name": "\"quest_kingdom\".\"main\".\"dim_players\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-24T23:58:16.287837Z", "completed_at": "2026-02-24T23:58:16.289548Z"}, {"name": "execute", "started_at": "2026-02-24T23:58:16.289716Z", "completed_at": "2026-02-24T23:58:16.289720Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002317190170288086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.quest_kingdom.fct_sessions", "compiled": true, "compiled_code": "\n\nwith sessions as (\n    select * from \"quest_kingdom\".\"main\".\"stg_sessions\"\n),\n\nplayers as (\n    select * from \"quest_kingdom\".\"main\".\"stg_players\"\n),\n\nfinal as (\n    select \n        s.session_id,\n        s.player_id,\n        s.session_started_at,\n        s.session_ended_at,\n        s.session_duration_minutes,\n        s.starting_level,\n        s.ending_level,\n        s.levels_gained,\n        s.session_hour,\n        s.session_day_of_week,\n        s.session_date,\n\n        --player context\n        p.installed_at,\n        p.attribution_channel,\n        p.country,\n        p.device_type,\n        p.player_segment,\n        p.experiment_variant,\n        p.tutorial_completed,\n\n        --derived metrics\n        datediff('day', p.installed_at, s.session_started_at) as days_since_install,\n        --session quality flags\n        s.session_duration_minutes >= 5 as is_quality_session,\n        s.levels_gained > 0 as has_progression,\n\n        --time of day flags\n        case \n            when s.session_hour between 0 and 5 then 'night'\n            when s.session_hour between 6 and 11 then 'morning'\n            when s.session_hour between 12 and 17 then 'afternoon'\n            when s.session_hour between 18 and 23 then 'evening'\n        end as time_of_day,\n\n        --weekend flag\n        s.session_day_of_week in (0, 6) as is_weekend\n    from sessions s \n    left join players p on s.player_id = p.player_id \n)\n\nselect * from final", "relation_name": "\"quest_kingdom\".\"main\".\"fct_sessions\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-24T23:58:16.290483Z", "completed_at": "2026-02-24T23:58:16.292524Z"}, {"name": "execute", "started_at": "2026-02-24T23:58:16.292688Z", "completed_at": "2026-02-24T23:58:16.292691Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0025577545166015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.quest_kingdom.not_null_stg_sessions_player_id.fa13833b29", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect player_id\nfrom \"quest_kingdom\".\"main\".\"stg_sessions\"\nwhere player_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-24T23:58:16.293440Z", "completed_at": "2026-02-24T23:58:16.295505Z"}, {"name": "execute", "started_at": "2026-02-24T23:58:16.296042Z", "completed_at": "2026-02-24T23:58:16.296154Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0033049583435058594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.quest_kingdom.not_null_stg_sessions_session_id.2e872a126d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_id\nfrom \"quest_kingdom\".\"main\".\"stg_sessions\"\nwhere session_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-24T23:58:16.298569Z", "completed_at": "2026-02-24T23:58:16.300973Z"}, {"name": "execute", "started_at": "2026-02-24T23:58:16.301163Z", "completed_at": "2026-02-24T23:58:16.301167Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0030660629272460938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.quest_kingdom.not_null_stg_sessions_session_started_at.039a312a09", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect session_started_at\nfrom \"quest_kingdom\".\"main\".\"stg_sessions\"\nwhere session_started_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-24T23:58:16.302053Z", "completed_at": "2026-02-24T23:58:16.304766Z"}, {"name": "execute", "started_at": "2026-02-24T23:58:16.304949Z", "completed_at": "2026-02-24T23:58:16.304953Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003329038619995117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.quest_kingdom.relationships_stg_sessions_player_id__player_id__ref_stg_players_.6b4c9276ee", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select player_id as from_field\n    from \"quest_kingdom\".\"main\".\"stg_sessions\"\n    where player_id is not null\n),\n\nparent as (\n    select player_id as to_field\n    from \"quest_kingdom\".\"main\".\"stg_players\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-24T23:58:16.305757Z", "completed_at": "2026-02-24T23:58:16.307942Z"}, {"name": "execute", "started_at": "2026-02-24T23:58:16.308111Z", "completed_at": "2026-02-24T23:58:16.308114Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0027229785919189453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.quest_kingdom.unique_stg_sessions_session_id.ce45726d03", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    session_id as unique_field,\n    count(*) as n_records\n\nfrom \"quest_kingdom\".\"main\".\"stg_sessions\"\nwhere session_id is not null\ngroup by session_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 0.16481924057006836, "args": {"show_resource_report": false, "which": "generate", "partial_parse": true, "write_json": true, "state_modified_compare_vars": false, "exclude": [], "require_yaml_configuration_for_mf_time_spines": false, "print": true, "version_check": true, "require_generic_test_arguments_property": true, "printer_width": 80, "profiles_dir": "/Users/hazeldonaldson/.dbt", "log_level_file": "debug", "require_batched_execution_for_custom_microbatch_strategy": false, "skip_nodes_if_on_run_start_fails": false, "log_format_file": "debug", "require_resource_names_without_spaces": true, "state_modified_compare_more_unrendered_values": false, "static_parser": true, "use_fast_test_edges": false, "log_path": "/Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt/logs", "source_freshness_run_project_hooks": true, "introspect": true, "log_file_max_bytes": 10485760, "empty_catalog": false, "compile": true, "defer": false, "partial_parse_file_diff": true, "require_unique_project_resource_names": false, "upload_to_artifacts_ingest_api": false, "require_ref_searches_node_package_before_root": false, "validate_macro_args": false, "vars": {}, "favor_state": false, "log_format": "default", "use_colors": true, "invocation_command": "dbt docs generate", "cache_selected_only": false, "quiet": false, "require_explicit_package_overrides_for_builtin_materializations": true, "strict_mode": false, "use_colors_file": true, "log_level": "info", "macro_debugging": false, "select": [], "send_anonymous_usage_stats": true, "require_nested_cumulative_type_params": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "indirect_selection": "eager", "project_dir": "/Users/hazeldonaldson/Documents/quest_kingdom_analytics_platform/quest_kingdom_dbt", "populate_cache": true, "show_all_deprecations": false, "require_all_warnings_handled_by_warn_error": false, "static": false}}